<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üåç Terra Archive Manager Ultimate v2.0</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom Terra Styling */
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
        .terra-gradient { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
        .semantic-tag { @apply bg-indigo-100 text-indigo-800 text-xs px-2 py-1 rounded-full; }
        .definition-card { @apply bg-white border border-gray-200 rounded-lg p-4 shadow-sm hover:shadow-md transition-shadow; }
        .encyclopedia-entry { @apply bg-white border border-gray-200 rounded-lg p-4 shadow-sm hover:shadow-md transition-shadow; }
        .code-display { @apply bg-gray-900 text-green-400 p-4 rounded-lg font-mono text-sm; }
        .drop-zone { @apply border-2 border-dashed border-gray-300 rounded-lg p-8 text-center transition-colors; }
        .drop-zone.dragover { @apply border-blue-500 bg-blue-50; }
        .tab-button { @apply px-6 py-3 text-sm font-medium rounded-t-lg transition-colors; }
        .tab-button.active { @apply bg-white text-blue-600 border-b-2 border-blue-600; }
        .tab-button:not(.active) { @apply bg-gray-100 text-gray-600 hover:bg-gray-200; }
        .save-indicator { @apply fixed top-4 right-4 px-3 py-2 rounded-lg text-sm font-medium transition-all; }
        .save-indicator.saving { @apply bg-yellow-100 text-yellow-800; }
        .save-indicator.saved { @apply bg-green-100 text-green-800; }
        .level-indicator { @apply inline-block px-2 py-1 text-xs font-bold rounded; }
        .level-l0 { @apply bg-green-100 text-green-800; }
        .level-l1 { @apply bg-blue-100 text-blue-800; }
        .level-l2 { @apply bg-purple-100 text-purple-800; }
        .level-l3 { @apply bg-red-100 text-red-800; }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <!-- TERRA Header -->
    <header class="terra-gradient text-white shadow-lg">
        <div class="container mx-auto px-4 py-6">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <div class="text-4xl">üåç</div>
                    <div>
                        <h1 class="text-3xl font-bold">TERRA ARCHIVE MANAGER</h1>
                        <p class="text-blue-100">Ultimate v2.0 ‚Ä¢ –§—Ä–∞–∫—Ç–∞–ª—å–Ω–∞—è –º–µ—Ç–∞–Ω–∞—É–∫–∞ L0-L7 ‚Ä¢ –î–ª—è –≤—Å–µ—Ö –±–µ–∑ –∏—Å–∫–ª—é—á–µ–Ω–∏–π</p>
                        <div class="flex items-center space-x-2 mt-2">
                            <span id="systemLevel" class="level-indicator level-l0">L0</span>
                            <span class="text-sm">–°–∏—Å—Ç–µ–º–∞ –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω–∞ –ø–æ–¥ –≤–∞—à–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ</span>
                        </div>
                    </div>
                </div>
                <div class="text-right">
                    <div class="text-sm opacity-90">üë§ Abdurashid Abdukarimov</div>
                    <div class="text-sm opacity-90">ü§ñ Terra Ecosystem v7.0</div>
                    <div class="text-xs opacity-75">üõ°Ô∏è –î–µ—Ç—Å–∫–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å: –ê–ö–¢–ò–í–ù–ê</div>
                </div>
            </div>
        </div>
    </header>

    <!-- Save Indicator -->
    <div id="saveIndicator" class="save-indicator hidden">üíæ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ...</div>

    <!-- System Status -->
    <div class="bg-white border-b">
        <div class="container mx-auto px-4 py-3">
            <div class="flex items-center justify-between text-sm">
                <div class="flex items-center space-x-6">
                    <div>üìä –§–∞–π–ª–æ–≤: <span id="totalFiles" class="font-bold">0</span></div>
                    <div>üíæ –†–∞–∑–º–µ—Ä: <span id="totalSize" class="font-bold">0 B</span></div>
                    <div>üìö –°–ª–æ–≤ –≤ —Ç–µ–∑–∞—É—Ä—É—Å–µ: <span id="totalWords" class="font-bold">0</span></div>
                    <div>üî¨ –ö–æ–Ω—Ü–µ–ø—Ü–∏–π: <span id="totalConcepts" class="font-bold">0</span></div>
                </div>
                <div class="text-gray-600">
                    üìÖ –ü–æ—Å–ª–µ–¥–Ω–µ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ: <span id="lastSave">–ù–∏–∫–æ–≥–¥–∞</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Processing Progress -->
    <div id="processingProgress" class="hidden bg-blue-600 text-white">
        <div class="container mx-auto px-4 py-2">
            <div class="flex items-center space-x-4">
                <div class="flex-1 bg-blue-800 rounded-full h-2">
                    <div id="progressFill" class="bg-white h-2 rounded-full transition-all duration-300" style="width: 0%"></div>
                </div>
                <div id="progressText" class="text-sm font-medium">–û–±—Ä–∞–±–æ—Ç–∫–∞...</div>
            </div>
        </div>
    </div>

    <!-- Main Interface -->
    <div class="container mx-auto px-4 py-6">
        <!-- Search and Filters -->
        <div class="bg-white rounded-lg shadow-md p-6 mb-6">
            <div class="flex flex-wrap items-center gap-4">
                <div class="flex-1 min-w-64">
                    <input type="text" id="searchBox" placeholder="üîç –ü–æ–∏—Å–∫ –ø–æ –≤—Å–µ–º—É –∫–æ—Ä–ø—É—Å—É (—Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –≤–∫–ª—é—á–µ–Ω)" 
                           class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                           onkeyup="performCorpusSearch()">
                </div>
                <select id="searchMode" class="px-4 py-2 border border-gray-300 rounded-lg" onchange="filterContent()">
                    <option value="all">üåê –í–µ–∑–¥–µ</option>
                    <option value="archives">üì¶ –ê—Ä—Ö–∏–≤—ã</option>
                    <option value="thesaurus">üìö –¢–µ–∑–∞—É—Ä—É—Å</option>
                    <option value="encyclopedia">üî¨ –≠–Ω—Ü–∏–∫–ª–æ–ø–µ–¥–∏—è</option>
                </select>
                <select id="categoryFilter" class="px-4 py-2 border border-gray-300 rounded-lg" onchange="filterContent()">
                    <option value="">üìÇ –í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</option>
                    <option value="document">üìÑ –î–æ–∫—É–º–µ–Ω—Ç—ã</option>
                    <option value="code">üíª –ö–æ–¥</option>
                    <option value="image">üñºÔ∏è –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è</option>
                    <option value="dictionary">üìö –°–ª–æ–≤–∞—Ä–∏</option>
                    <option value="other">üìé –î—Ä—É–≥–æ–µ</option>
                </select>
                <select id="languageFilter" class="px-4 py-2 border border-gray-300 rounded-lg" onchange="filterContent()">
                    <option value="">üåê –í—Å–µ —è–∑—ã–∫–∏</option>
                    <option value="ru">üá∑üá∫ –†—É—Å—Å–∫–∏–π</option>
                    <option value="en">üá∫üá∏ English</option>
                    <option value="mixed">üåç –ú–Ω–æ–≥–æ—è–∑—ã—á–Ω—ã–π</option>
                </select>
                <button onclick="sortContent('relevance')" class="px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700">
                    üìä –ü–æ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏
                </button>
            </div>
        </div>

        <!-- Upload Zone -->
        <div class="bg-white rounded-lg shadow-md p-6 mb-6">
            <div id="dropZone" class="drop-zone" 
                 ondrop="dropHandler(event)" 
                 ondragover="dragOverHandler(event)" 
                 ondragleave="dragLeaveHandler(event)">
                <div class="text-6xl mb-4">üìÅ</div>
                <h3 class="text-xl font-bold mb-2">–ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–∞–π–ª—ã –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞</h3>
                <p class="text-gray-600 mb-4">–ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ —Ñ–∞–π–ª—ã —Å—é–¥–∞ –∏–ª–∏ –Ω–∞–∂–º–∏—Ç–µ –¥–ª—è –≤—ã–±–æ—Ä–∞</p>
                <p class="text-sm text-gray-500 mb-4">
                    üß† –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏: —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ + —Ç–µ–∑–∞—É—Ä—É—Å + –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–π + —ç—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
                </p>
                <input type="file" id="fileInput" multiple class="hidden" onchange="handleFiles(this.files)">
                <button onclick="document.getElementById('fileInput').click()" 
                        class="px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium">
                    üìé –í—ã–±—Ä–∞—Ç—å —Ñ–∞–π–ª—ã
                </button>
            </div>
        </div>

        <!-- Tabs Navigation -->
        <div class="bg-white rounded-t-lg shadow-md">
            <div class="flex border-b">
                <button class="tab-button active" data-tab="archives" onclick="switchTab('archives')">
                    üì¶ –ê—Ä—Ö–∏–≤ (<span id="archiveCount">0</span>)
                </button>
                <button class="tab-button" data-tab="thesaurus" onclick="switchTab('thesaurus')">
                    üìö –¢–µ–∑–∞—É—Ä—É—Å (<span id="thesaurusCount">0</span>)
                </button>
                <button class="tab-button" data-tab="encyclopedia" onclick="switchTab('encyclopedia')">
                    üî¨ –≠–Ω—Ü–∏–∫–ª–æ–ø–µ–¥–∏—è (<span id="encyclopediaCount">0</span>)
                </button>
                <button class="tab-button" data-tab="tools" onclick="switchTab('tools')">
                    üõ†Ô∏è –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã
                </button>
            </div>
        </div>

        <!-- Tab Contents -->
        <div class="bg-white rounded-b-lg shadow-md">
            <!-- Archives Tab -->
            <div id="archivesTab" class="tab-content active p-6">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-bold">üì¶ –ê—Ä—Ö–∏–≤ —Ñ–∞–π–ª–æ–≤</h2>
                    <div class="flex space-x-2">
                        <button onclick="sortContent('date')" class="px-4 py-2 bg-gray-600 text-white rounded hover:bg-gray-700">
                            üìÖ –ü–æ –¥–∞—Ç–µ
                        </button>
                        <button onclick="sortContent('name')" class="px-4 py-2 bg-gray-600 text-white rounded hover:bg-gray-700">
                            üî§ –ü–æ –∏–º–µ–Ω–∏
                        </button>
                        <button onclick="sortContent('size')" class="px-4 py-2 bg-gray-600 text-white rounded hover:bg-gray-700">
                            üìè –ü–æ —Ä–∞–∑–º–µ—Ä—É
                        </button>
                    </div>
                </div>
                <div id="archivesList" class="space-y-4">
                    <div class="text-center py-12 text-gray-500">
                        <div class="text-6xl mb-4">üì¶</div>
                        <h3 class="text-xl font-semibold mb-2">–ê—Ä—Ö–∏–≤ –ø—É—Å—Ç</h3>
                        <p>–ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–∞–π–ª—ã –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –∏ –∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–∏—è</p>
                    </div>
                </div>
            </div>

            <!-- Thesaurus Tab -->
            <div id="thesaurusTab" class="tab-content hidden p-6">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-bold">üìö –°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π —Ç–µ–∑–∞—É—Ä—É—Å</h2>
                    <div class="flex space-x-2">
                        <button onclick="buildThesaurus()" class="px-4 py-2 bg-teal-600 text-white rounded hover:bg-teal-700">
                            üî® –ü–æ—Å—Ç—Ä–æ–∏—Ç—å —Ç–µ–∑–∞—É—Ä—É—Å
                        </button>
                        <button onclick="extractTerms()" class="px-4 py-2 bg-teal-600 text-white rounded hover:bg-teal-700">
                            üìù –ò–∑–≤–ª–µ—á—å —Ç–µ—Ä–º–∏–Ω—ã
                        </button>
                    </div>
                </div>
                <div id="thesaurusList" class="space-y-4">
                    <div class="text-center py-12 text-gray-500">
                        <div class="text-6xl mb-4">üìö</div>
                        <h3 class="text-xl font-semibold mb-2">–¢–µ–∑–∞—É—Ä—É—Å –ø—É—Å—Ç</h3>
                        <p>–ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ç–µ–∫—Å—Ç–æ–≤—ã–µ —Ñ–∞–π–ª—ã –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è —Å–ª–æ–≤–∞—Ä—è —Ç–µ—Ä–º–∏–Ω–æ–≤</p>
                    </div>
                </div>
            </div>

            <!-- Encyclopedia Tab -->
            <div id="encyclopediaTab" class="tab-content hidden p-6">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-bold">üî¨ –≠–Ω—Ü–∏–∫–ª–æ–ø–µ–¥–∏—è –∫–æ–Ω—Ü–µ–ø—Ü–∏–π</h2>
                    <div class="flex space-x-2">
                        <button onclick="extractConcepts()" class="px-4 py-2 bg-purple-600 text-white rounded hover:bg-purple-700">
                            üß† –ò–∑–≤–ª–µ—á—å –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏
                        </button>
                        <button onclick="generateEncyclopedia()" class="px-4 py-2 bg-purple-600 text-white rounded hover:bg-purple-700">
                            üìñ –°–æ–∑–¥–∞—Ç—å —ç–Ω—Ü–∏–∫–ª–æ–ø–µ–¥–∏—é
                        </button>
                    </div>
                </div>
                <div id="encyclopediaList" class="space-y-4">
                    <div class="text-center py-12 text-gray-500">
                        <div class="text-6xl mb-4">üî¨</div>
                        <h3 class="text-xl font-semibold mb-2">–≠–Ω—Ü–∏–∫–ª–æ–ø–µ–¥–∏—è –ø—É—Å—Ç–∞</h3>
                        <p>–ó–∞–≥—Ä—É–∑–∏—Ç–µ –Ω–∞—É—á–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –∫–æ–Ω—Ü–µ–ø—Ü–∏–π</p>
                    </div>
                </div>
            </div>

            <!-- Tools Tab -->
            <div id="toolsTab" class="tab-content hidden p-6">
                <h2 class="text-2xl font-bold mb-6">üõ†Ô∏è –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã Terra</h2>
                
                <!-- Fraktal Tools -->
                <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8">
                    <div class="definition-card">
                        <h3 class="text-lg font-bold mb-3">üß† –°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑</h3>
                        <p class="text-gray-600 mb-4">–ì–ª—É–±–æ–∫–∏–π –∞–Ω–∞–ª–∏–∑ —Å–º—ã—Å–ª–∞ –∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ —Å –ø–æ–º–æ—â—å—é –ò–ò</p>
                        <button onclick="generateSemanticMap()" class="w-full px-4 py-2 bg-indigo-600 text-white rounded hover:bg-indigo-700">
                            üó∫Ô∏è –°–æ–∑–¥–∞—Ç—å —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫—É—é –∫–∞—Ä—Ç—É
                        </button>
                    </div>
                    
                    <div class="definition-card">
                        <h3 class="text-lg font-bold mb-3">üìä –ê–Ω–∞–ª–∏–∑ –∫–æ—Ä–ø—É—Å–∞</h3>
                        <p class="text-gray-600 mb-4">–°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –∏ –ª–∏–Ω–≥–≤–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –∫–æ–ª–ª–µ–∫—Ü–∏–∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤</p>
                        <button onclick="analyzeCorpus()" class="w-full px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700">
                            üìà –ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∫–æ—Ä–ø—É—Å
                        </button>
                    </div>
                    
                    <div class="definition-card">
                        <h3 class="text-lg font-bold mb-3">üîç –ú–Ω–æ–≥–æ—è–∑—ã—á–Ω—ã–π –ø–∞—Ä—Å–µ—Ä</h3>
                        <p class="text-gray-600 mb-4">–û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –Ω–∞ —Ä—É—Å—Å–∫–æ–º, –∞–Ω–≥–ª–∏–π—Å–∫–æ–º –∏ –¥—Ä—É–≥–∏—Ö —è–∑—ã–∫–∞—Ö</p>
                        <button onclick="parseMultilingual()" class="w-full px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700">
                            üåê –ú–Ω–æ–≥–æ—è–∑—ã—á–Ω—ã–π –∞–Ω–∞–ª–∏–∑
                        </button>
                    </div>
                </div>

                <!-- System Tools -->
                <div class="bg-gray-50 rounded-lg p-6 mb-6">
                    <h3 class="text-xl font-bold mb-4">‚öôÔ∏è –°–∏—Å—Ç–µ–º–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã</h3>
                    <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-4">
                        <button onclick="organizeAll()" class="px-4 py-3 bg-yellow-600 text-white rounded hover:bg-yellow-700">
                            üìÅ –û—Ä–≥–∞–Ω–∏–∑–æ–≤–∞—Ç—å –≤—Å—ë
                        </button>
                        <button onclick="generateMetaReport()" class="px-4 py-3 bg-pink-600 text-white rounded hover:bg-pink-700">
                            üìä –ú–µ—Ç–∞-–æ—Ç—á—ë—Ç
                        </button>
                        <button onclick="optimizeStorage()" class="px-4 py-3 bg-orange-600 text-white rounded hover:bg-orange-700">
                            üóúÔ∏è –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è
                        </button>
                        <button onclick="syncQuantumState()" class="px-4 py-3 bg-red-600 text-white rounded hover:bg-red-700">
                            üîÑ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è
                        </button>
                    </div>
                </div>

                <!-- Import/Export -->
                <div class="bg-gradient-to-r from-purple-100 to-pink-100 rounded-lg p-6">
                    <h3 class="text-xl font-bold mb-4">üíæ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã–º–∏</h3>
                    <div class="flex flex-wrap gap-4">
                        <button onclick="exportUltimateArchive()" class="px-6 py-3 bg-purple-600 text-white rounded-lg hover:bg-purple-700 font-medium">
                            üì§ –≠–∫—Å–ø–æ—Ä—Ç Terra Archive
                        </button>
                        <button onclick="importUltimateArchive()" class="px-6 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 font-medium">
                            üì• –ò–º–ø–æ—Ä—Ç Terra Archive
                        </button>
                        <button onclick="createQuantumBackup()" class="px-6 py-3 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 font-medium">
                            üíΩ –ö–≤–∞–Ω—Ç–æ–≤—ã–π –±—ç–∫–∞–ø
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal for viewing content -->
    <div id="contentModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
        <div class="bg-white rounded-lg max-w-4xl w-full max-h-90vh overflow-y-auto">
            <div class="p-6 border-b">
                <div class="flex justify-between items-center">
                    <h2 id="modalTitle" class="text-2xl font-bold">–ü—Ä–æ—Å–º–æ—Ç—Ä –∫–æ–Ω—Ç–µ–Ω—Ç–∞</h2>
                    <button onclick="closeModal()" class="text-gray-500 hover:text-gray-700 text-2xl">‚úï</button>
                </div>
            </div>
            <div id="modalContent" class="p-6">
                <!-- Content will be inserted here -->
            </div>
        </div>
    </div>

    <!-- Terra System Status Footer -->
    <footer class="bg-gray-800 text-white mt-12">
        <div class="container mx-auto px-4 py-6">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <div class="text-2xl">üåç</div>
                    <div>
                        <div class="font-bold">Terra Archive Manager Ultimate</div>
                        <div class="text-sm text-gray-300">–§—Ä–∞–∫—Ç–∞–ª—å–Ω–∞—è –º–µ—Ç–∞–Ω–∞—É–∫–∞ ‚Ä¢ –î–ª—è –≤—Å–µ—Ö –±–µ–∑ –∏—Å–∫–ª—é—á–µ–Ω–∏–π</div>
                    </div>
                </div>
                <div class="text-right text-sm text-gray-300">
                    <div>üõ°Ô∏è –î–µ—Ç—Å–∫–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å: –ê–ö–¢–ò–í–ù–ê</div>
                    <div>üåç –≠–∫–æ–ª–æ–≥–∏—á–Ω–æ—Å—Ç—å: –ë–ï–ó cloud –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π</div>
                    <div>‚ôø –î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å: Pentium I ‚Üí —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã</div>
                </div>
            </div>
        </div>
    </footer>

    <!-- JavaScript Integration -->
    <script>
        // Terra Archive Manager Ultimate v2.0
        // –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —Å —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–º –∞–Ω–∞–ª–∏–∑–æ–º –∏ —Ñ—Ä–∞–∫—Ç–∞–ª—å–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π
        
        class TerraArchiveManagerUltimate {
            constructor() {
                this.version = "2.0-Ultimate";
                this.author = "–ê–±–¥—É–∫–∞—Ä–∏–º–æ–≤ –ê–±–¥—É—Ä–∞—à–∏–¥ –ê–±–¥—É–ª—Ö–∞–º–∏—Ç–æ–≤–∏—á";
                this.did = "aiuz:did:aiuz:stakeholder:abdukarimov_aaahash1234567890";
                
                // Data storage
                this.archives = JSON.parse(localStorage.getItem('terra_archives_ultimate') || '[]');
                this.thesaurus = JSON.parse(localStorage.getItem('terra_thesaurus_ultimate') || '[]');
                this.encyclopedia = JSON.parse(localStorage.getItem('terra_encyclopedia_ultimate') || '[]');
                
                // System components
                this.semanticSystem = null;
                this.systemLevel = 'L0';
                this.currentTab = 'archives';
                
                // Initialize
                this.initializeSystem();
                this.detectSystemCapabilities();
                this.updateAllUI();
                this.startAutoSave();
            }
            
            initializeSystem() {
                console.log('üåç Terra Archive Manager Ultimate v2.0 –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è...');
                
                // Initialize Terra API if available
                if (window.TerraAPI) {
                    this.semanticSystem = window.TerraAPI;
                    console.log('‚úÖ Terra Semantic System –ø–æ–¥–∫–ª—é—á–µ–Ω–∞');
                }
                
                // Enable child safety by default
                this.childSafetyEnabled = true;
                
                console.log('üõ°Ô∏è –î–µ—Ç—Å–∫–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å: –ê–ö–¢–ò–í–ù–ê');
                console.log('üåç –§—Ä–∞–∫—Ç–∞–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞: –ì–û–¢–û–í–ê');
                console.log('üìö –°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑: –í–ö–õ–Æ–ß–ï–ù');
            }
            
            detectSystemCapabilities() {
                // Detect system level based on browser capabilities
                const hasES6 = typeof Promise !== 'undefined';
                const hasIndexedDB = typeof indexedDB !== 'undefined';
                const hasWorkers = typeof Worker !== 'undefined';
                const estimatedRAM = navigator.deviceMemory ? navigator.deviceMemory * 1024 : 2048;
                
                if (hasWorkers && estimatedRAM >= 4096) {
                    this.systemLevel = 'L3';
                } else if (hasES6 && hasIndexedDB && estimatedRAM >= 2048) {
                    this.systemLevel = 'L2';
                } else if (hasES6 && estimatedRAM >= 512) {
                    this.systemLevel = 'L1';
                } else {
                    this.systemLevel = 'L0';
                }
                
                // Update UI
                const levelElement = document.getElementById('systemLevel');
                if (levelElement) {
                    levelElement.textContent = this.systemLevel;
                    levelElement.className = `level-indicator level-${this.systemLevel.toLowerCase()}`;
                }
                
                console.log(`üîß –°–∏—Å—Ç–µ–º–∞ –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω–∞ –¥–ª—è ${this.systemLevel}`);
            }
            
            async addFile(file) {
                this.showProgress(10, `–ó–∞–≥—Ä—É–∑–∫–∞ ${file.name}...`);
                
                try {
                    const content = await this.readFileContent(file);
                    this.showProgress(30, '–°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑...');
                    
                    // Semantic analysis
                    let semanticAnalysis = null;
                    if (this.semanticSystem) {
                        const analysisResult = this.semanticSystem.archive(content, [file], this.did);
                        semanticAnalysis = analysisResult.semanticAnalysis;
                    }
                    
                    this.showProgress(60, '–°–æ–∑–¥–∞–Ω–∏–µ –∞—Ä—Ö–∏–≤–Ω–æ–π –∑–∞–ø–∏—Å–∏...');
                    
                    // Create archive entry
                    const archive = {
                        id: Date.now() + Math.random(),
                        name: file.name,
                        size: file.size,
                        type: file.type,
                        content: content,
                        dateAdded: new Date().toISOString(),
                        category: this.detectCategory(file),
                        language: this.detectLanguage(content),
                        tags: this.extractTags(content, semanticAnalysis),
                        semantics: semanticAnalysis
                    };
                    
                    this.showProgress(80, '–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–µ–∑–∞—É—Ä—É—Å–∞...');
                    
                    // Update thesaurus and encyclopedia
                    if (semanticAnalysis) {
                        this.updateThesaurusFromAnalysis(semanticAnalysis, file.name);
                        this.updateEncyclopediaFromAnalysis(semanticAnalysis, file.name);
                    }
                    
                    this.archives.push(archive);
                    
                    this.showProgress(100, '–ó–∞–≤–µ—Ä—à–µ–Ω–æ!');
                    
                    setTimeout(() => {
                        this.hideProgress();
                        this.saveAllData();
                        this.updateAllUI();
                    }, 500);
                    
                } catch (error) {
                    console.error('–û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ñ–∞–π–ª–∞:', error);
                    this.hideProgress();
                    alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ —Ñ–∞–π–ª–∞: ' + error.message);
                }
            }
            
            readFileContent(file) {
                return new Promise((resolve, reject) => {
                    const reader = new FileReader();
                    reader.onload = e => resolve(e.target.result);
                    reader.onerror = e => reject(new Error('–û—à–∏–±–∫–∞ —á—Ç–µ–Ω–∏—è —Ñ–∞–π–ª–∞'));
                    
                    if (file.type.startsWith('text/') || file.name.endsWith('.txt') || 
                        file.name.endsWith('.md') || file.name.endsWith('.csv')) {
                        reader.readAsText(file);
                    } else {
                        // For binary files, read as base64
                        reader.readAsDataURL(file);
                    }
                });
            }
            
            detectCategory(file) {
                const name = file.name.toLowerCase();
                const type = file.type.toLowerCase();
                
                if (type.startsWith('image/')) return 'image';
                if (type.startsWith('text/') || name.endsWith('.txt') || name.endsWith('.md') || 
                    name.endsWith('.doc') || name.endsWith('.docx') || name.endsWith('.pdf')) return 'document';
                if (name.endsWith('.js') || name.endsWith('.py') || name.endsWith('.html') || 
                    name.endsWith('.css') || name.endsWith('.json')) return 'code';
                if (name.endsWith('.dic') || name.endsWith('.dict') || type.includes('dictionary')) return 'dictionary';
                if (type.startsWith('application/')) return 'archive';
                
                return 'other';
            }
            
            detectLanguage(content) {
                if (typeof content !== 'string') return 'unknown';
                
                const russianPattern = /[–∞-—è—ë]/i;
                const englishPattern = /[a-z]/i;
                
                const russianCount = (content.match(russianPattern) || []).length;
                const englishCount = (content.match(englishPattern) || []).length;
                
                if (russianCount > englishCount * 2) return 'ru';
                if (englishCount > russianCount * 2) return 'en';
                if (russianCount > 0 && englishCount > 0) return 'mixed';
                
                return 'unknown';
            }
            
            extractTags(content, semanticAnalysis) {
                const tags = [];
                
                // Extract from semantic analysis
                if (semanticAnalysis && semanticAnalysis.concepts) {
                    semanticAnalysis.concepts.slice(0, 5).forEach(concept => {
                        tags.push(concept.concept || concept);
                    });
                }
                
                // Extract from content (simple keyword extraction)
                if (typeof content === 'string') {
                    const words = content.toLowerCase().match(/[–∞-—è—ëa-z]{4,}/g) || [];
                    const wordCount = {};
                    
                    words.forEach(word => {
                        wordCount[word] = (wordCount[word] || 0) + 1;
                    });
                    
                    const topWords = Object.entries(wordCount)
                        .sort(([,a], [,b]) => b - a)
                        .slice(0, 3)
                        .map(([word]) => word);
                    
                    tags.push(...topWords);
                }
                
                return [...new Set(tags)]; // Remove duplicates
            }
            
            updateThesaurusFromAnalysis(analysis, source) {
                if (!analysis || !analysis.concepts) return;
                
                analysis.concepts.forEach(conceptData => {
                    const concept = conceptData.concept || conceptData;
                    
                    let existing = this.thesaurus.find(t => t.term === concept);
                    if (!existing) {
                        existing = {
                            id: Date.now() + Math.random(),
                            term: concept,
                            definitions: [],
                            dateAdded: new Date().toISOString()
                        };
                        this.thesaurus.push(existing);
                    }
                    
                    // Add definition from analysis
                    const definition = {
                        definition: `–ö–æ–Ω—Ü–µ–ø—Ü–∏—è, –∏–∑–≤–ª–µ—á–µ–Ω–Ω–∞—è –∏–∑ —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞: ${concept}`,
                        source: source,
                        context: conceptData.context || '',
                        confidence: conceptData.relevance || 0.5
                    };
                    
                    existing.definitions.push(definition);
                });
            }
            
            updateEncyclopediaFromAnalysis(analysis, source) {
                if (!analysis || !analysis.domains) return;
                
                analysis.domains.forEach(domainData => {
                    const domain = domainData.domain || domainData;
                    
                    let existing = this.encyclopedia.find(e => e.concept === domain);
                    if (!existing) {
                        existing = {
                            id: Date.now() + Math.random(),
                            concept: domain,
                            description: `–ü—Ä–µ–¥–º–µ—Ç–Ω–∞—è –æ–±–ª–∞—Å—Ç—å, –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–∞—è —á–µ—Ä–µ–∑ —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑: ${domain}`,
                            sources: [],
                            dateAdded: new Date().toISOString()
                        };
                        this.encyclopedia.push(existing);
                    }
                    
                    // Add source
                    const sourceData = {
                        source: source,
                        content: domainData.matches ? domainData.matches.join(', ') : '',
                        relevance: domainData.confidence || 0.5,
                        dateAdded: new Date().toISOString()
                    };
                    
                    existing.sources.push(sourceData);
                });
            }
            
            updateAllUI() {
                this.updateArchivesList();
                this.updateThesaurusList();
                this.updateEncyclopediaList();
                this.updateStatistics();
                this.updateTabCounts();
            }
            
            updateArchivesList() {
                const container = document.getElementById('archivesList');
                const filteredArchives = this.getFilteredContent('archives');
                
                container.innerHTML = '';
                
                if (filteredArchives.length === 0) {
                    container.innerHTML = `
                        <div class="text-center py-12 text-gray-500">
                            <div class="text-6xl mb-4">üì¶</div>
                            <h3 class="text-xl font-semibold mb-2">–ê—Ä—Ö–∏–≤ –ø—É—Å—Ç</h3>
                            <p>–ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–∞–π–ª—ã –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –∏ –∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–∏—è</p>
                        </div>
                    `;
                    return;
                }
                
                filteredArchives.forEach(archive => {
                    const archiveElement = document.createElement('div');
                    archiveElement.className = 'definition-card';
                    archiveElement.innerHTML = `
                        <div class="flex items-start justify-between">
                            <div class="flex items-start space-x-4 flex-1">
                                <div class="text-3xl">${this.getFileIcon(archive.category)}</div>
                                <div class="flex-1">
                                    <h3 class="font-bold text-lg mb-2">${archive.name}</h3>
                                    <div class="text-sm text-gray-600 mb-3">
                                        üìÖ ${new Date(archive.dateAdded).toLocaleDateString()} ‚Ä¢ 
                                        üìè ${this.formatFileSize(archive.size)} ‚Ä¢ 
                                        ${this.getLanguageFlag(archive.language)}
                                    </div>
                                    <div class="flex flex-wrap gap-1 mb-3">
                                        ${archive.tags.slice(0, 5).map(tag => 
                                            `<span class="semantic-tag">${tag}</span>`
                                        ).join('')}
                                    </div>
                                    ${archive.semantics ? `
                                        <div class="text-xs text-gray-500">
                                            üß† ${archive.semantics.concepts ? archive.semantics.concepts.length : 0} –∫–æ–Ω—Ü–µ–ø—Ü–∏–π ‚Ä¢ 
                                            üè∑Ô∏è ${archive.semantics.keywords ? archive.semantics.keywords.length : 0} –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤
                                        </div>
                                    ` : ''}
                                </div>
                            </div>
                            <div class="flex space-x-2 ml-4">
                                <button onclick="terraManager.viewContent('archive', '${archive.id}')" 
                                        class="px-4 py-2 text-sm bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors">
                                    üëÅÔ∏è –ü—Ä–æ—Å–º–æ—Ç—Ä
                                </button>
                                <button onclick="terraManager.downloadContent('${archive.id}')" 
                                        class="px-4 py-2 text-sm bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors">
                                    üíæ –°–∫–∞—á–∞—Ç—å
                                </button>
                                <button onclick="terraManager.deleteContent('archive', '${archive.id}')" 
                                        class="px-4 py-2 text-sm bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors">
                                    üóëÔ∏è –£–¥–∞–ª–∏—Ç—å
                                </button>
                            </div>
                        </div>
                    `;
                    
                    container.appendChild(archiveElement);
                });
            }
            
            updateThesaurusList() {
                const container = document.getElementById('thesaurusList');
                const filteredThesaurus = this.getFilteredContent('thesaurus');
                
                container.innerHTML = '';
                
                if (filteredThesaurus.length === 0) {
                    container.innerHTML = `
                        <div class="text-center py-12 text-gray-500">
                            <div class="text-6xl mb-4">üìö</div>
                            <h3 class="text-xl font-semibold mb-2">–¢–µ–∑–∞—É—Ä—É—Å –ø—É—Å—Ç</h3>
                            <p>–ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ç–µ–∫—Å—Ç–æ–≤—ã–µ —Ñ–∞–π–ª—ã –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è —Å–ª–æ–≤–∞—Ä—è —Ç–µ—Ä–º–∏–Ω–æ–≤</p>
                        </div>
                    `;
                    return;
                }
                
                filteredThesaurus.forEach(entry => {
                    const entryElement = document.createElement('div');
                    entryElement.className = 'definition-card';
                    entryElement.innerHTML = `
                        <div class="flex justify-between items-start">
                            <div class="flex-1">
                                <h4 class="font-bold text-lg text-teal-700 mb-2">${entry.term}</h4>
                                <div class="space-y-2">
                                    ${entry.definitions.slice(0, 2).map(def => `
                                        <div class="text-sm">
                                            <p class="text-gray-700">${def.definition}</p>
                                            <p class="text-xs text-gray-500 mt-1">–ò—Å—Ç–æ—á–Ω–∏–∫: ${def.source}</p>
                                        </div>
                                    `).join('')}
                                    ${entry.definitions.length > 2 ? `
                                        <p class="text-xs text-gray-500">+${entry.definitions.length - 2} –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–π</p>
                                    ` : ''}
                                </div>
                            </div>
                            <div class="ml-4">
                                <button onclick="terraManager.viewContent('thesaurus', '${entry.id}')" 
                                        class="px-3 py-1 text-sm bg-teal-500 text-white rounded hover:bg-teal-600">
                                    üìñ –ü–æ–¥—Ä–æ–±–Ω–µ–µ
                                </button>
                            </div>
                        </div>
                    `;
                    
                    container.appendChild(entryElement);
                });
            }
            
            updateEncyclopediaList() {
                const container = document.getElementById('encyclopediaList');
                const filteredEncyclopedia = this.getFilteredContent('encyclopedia');
                
                container.innerHTML = '';
                
                if (filteredEncyclopedia.length === 0) {
                    container.innerHTML = `
                        <div class="text-center py-12 text-gray-500">
                            <div class="text-6xl mb-4">üî¨</div>
                            <h3 class="text-xl font-semibold mb-2">–≠–Ω—Ü–∏–∫–ª–æ–ø–µ–¥–∏—è –ø—É—Å—Ç–∞</h3>
                            <p>–ó–∞–≥—Ä—É–∑–∏—Ç–µ –Ω–∞—É—á–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –∫–æ–Ω—Ü–µ–ø—Ü–∏–π</p>
                        </div>
                    `;
                    return;
                }
                
                filteredEncyclopedia.forEach(entry => {
                    const entryElement = document.createElement('div');
                    entryElement.className = 'encyclopedia-entry';
                    entryElement.innerHTML = `
                        <div class="flex justify-between items-start">
                            <div class="flex-1">
                                <h4 class="font-bold text-lg text-purple-700 mb-2">${entry.concept}</h4>
                                <p class="text-gray-700 mb-3">${entry.description.substring(0, 200)}${entry.description.length > 200 ? '...' : ''}</p>
                                <div class="text-sm text-gray-600">
                                    <span class="font-medium">–ò—Å—Ç–æ—á–Ω–∏–∫–æ–≤: ${entry.sources.length}</span> ‚Ä¢
                                    <span>${new Date(entry.dateAdded).toLocaleDateString()}</span>
                                </div>
                            </div>
                            <div class="ml-4">
                                <button onclick="terraManager.viewContent('encyclopedia', '${entry.id}')" 
                                        class="px-3 py-1 text-sm bg-purple-500 text-white rounded hover:bg-purple-600">
                                    üî¨ –ò–∑—É—á–∏—Ç—å
                                </button>
                            </div>
                        </div>
                    `;
                    
                    container.appendChild(entryElement);
                });
            }
            
            updateStatistics() {
                const totalFiles = this.archives.length;
                const totalSize = this.archives.reduce((sum, archive) => sum + archive.size, 0);
                const totalWords = this.thesaurus.length;
                const totalConcepts = this.encyclopedia.length;
                const lastSave = localStorage.getItem('terra_archives_ultimate_timestamp');
                
                document.getElementById('totalFiles').textContent = totalFiles;
                document.getElementById('totalSize').textContent = this.formatFileSize(totalSize);
                document.getElementById('totalWords').textContent = totalWords;
                document.getElementById('totalConcepts').textContent = totalConcepts;
                document.getElementById('lastSave').textContent = lastSave ? 
                    new Date(lastSave).toLocaleString() : '–ù–∏–∫–æ–≥–¥–∞';
            }
            
            updateTabCounts() {
                document.getElementById('archiveCount').textContent = this.archives.length;
                document.getElementById('thesaurusCount').textContent = this.thesaurus.length;
                document.getElementById('encyclopediaCount').textContent = this.encyclopedia.length;
            }
            
            getFilteredContent(type) {
                let data;
                switch(type) {
                    case 'archives': data = [...this.archives]; break;
                    case 'thesaurus': data = [...this.thesaurus]; break;
                    case 'encyclopedia': data = [...this.encyclopedia]; break;
                    default: return [];
                }
                
                // Apply search filter
                const searchTerm = document.getElementById('searchBox').value.toLowerCase();
                const searchMode = document.getElementById('searchMode').value;
                
                if (searchTerm && (searchMode === 'all' || searchMode === type)) {
                    data = data.filter(item => {
                        const searchableText = this.getSearchableText(item, type).toLowerCase();
                        return searchableText.includes(searchTerm);
                    });
                }
                
                // Apply category filter for archives
                const categoryFilter = document.getElementById('categoryFilter').value;
                if (categoryFilter && type === 'archives') {
                    data = data.filter(item => item.category === categoryFilter);
                }
                
                // Apply language filter for archives
                const languageFilter = document.getElementById('languageFilter').value;
                if (languageFilter && type === 'archives') {
                    data = data.filter(item => item.language === languageFilter);
                }
                
                return data;
            }
            
            getSearchableText(item, type) {
                switch(type) {
                    case 'archives':
                        return `${item.name} ${item.content} ${item.tags.join(' ')}`;
                    case 'thesaurus':
                        const definitions = item.definitions.map(def => def.definition).join(' ');
                        return `${item.term} ${definitions}`;
                    case 'encyclopedia':
                        const sources = item.sources.map(src => src.content).join(' ');
                        return `${item.concept} ${item.description} ${sources}`;
                    default:
                        return '';
                }
            }
            
            formatFileSize(bytes) {
                if (bytes === 0) return '0 B';
                const k = 1024;
                const sizes = ['B', 'KB', 'MB', 'GB', 'TB'];
                const i = Math.floor(Math.log(bytes) / Math.log(k));
                return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
            }
            
            getFileIcon(category) {
                const icons = {
                    'document': 'üìÑ',
                    'code': 'üíª',
                    'image': 'üñºÔ∏è',
                    'archive': 'üì¶',
                    'dictionary': 'üìö',
                    'other': 'üìé'
                };
                return icons[category] || 'üìé';
            }
            
            getLanguageFlag(language) {
                const flags = {
                    'ru': 'üá∑üá∫ –†—É—Å—Å–∫–∏–π',
                    'en': 'üá∫üá∏ English', 
                    'mixed': 'üåê –ú–Ω–æ–≥–æ—è–∑—ã—á–Ω—ã–π',
                    'unknown': '‚ùì –ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'
                };
                return flags[language] || '‚ùì –ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ';
            }
            
            showProgress(percentage, text) {
                const progressContainer = document.getElementById('processingProgress');
                const progressFill = document.getElementById('progressFill');
                const progressText = document.getElementById('progressText');
                
                progressContainer.classList.remove('hidden');
                progressFill.style.width = percentage + '%';
                progressText.textContent = text;
            }
            
            hideProgress() {
                document.getElementById('processingProgress').classList.add('hidden');
            }
            
            saveAllData() {
                try {
                    localStorage.setItem('terra_archives_ultimate', JSON.stringify(this.archives));
                    localStorage.setItem('terra_thesaurus_ultimate', JSON.stringify(this.thesaurus));
                    localStorage.setItem('terra_encyclopedia_ultimate', JSON.stringify(this.encyclopedia));
                    localStorage.setItem('terra_archives_ultimate_timestamp', new Date().toISOString());
                    
                    this.showSaveStatus('saved');
                    console.log('‚úÖ Terra –¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã');
                } catch (error) {
                    console.error('‚ùå –û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è:', error);
                }
            }
            
            showSaveStatus(status) {
                const indicator = document.getElementById('saveIndicator');
                indicator.className = `save-indicator ${status}`;
                
                if (status === 'saving') {
                    indicator.textContent = 'üíæ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ...';
                } else if (status === 'saved') {
                    indicator.textContent = '‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–æ';
                }
                
                indicator.classList.remove('hidden');
                
                setTimeout(() => {
                    indicator.classList.add('hidden');
                }, 2000);
            }
            
            startAutoSave() {
                setInterval(() => {
                    this.saveAllData();
                }, 30000); // Every 30 seconds
            }
            
            // Content management methods
            viewContent(type, id) {
                let content;
                switch(type) {
                    case 'archive':
                        content = this.archives.find(a => a.id == id);
                        break;
                    case 'thesaurus':
                        content = this.thesaurus.find(t => t.id == id);
                        break;
                    case 'encyclopedia':
                        content = this.encyclopedia.find(e => e.id == id);
                        break;
                }
                
                if (!content) return;
                
                document.getElementById('modalTitle').textContent = this.getContentTitle(content, type);
                document.getElementById('modalContent').innerHTML = this.generateContentHTML(content, type);
                document.getElementById('contentModal').classList.remove('hidden');
            }
            
            getContentTitle(content, type) {
                switch(type) {
                    case 'archive':
                        return `üì¶ ${content.name}`;
                    case 'thesaurus':
                        return `üìö ${content.term}`;
                    case 'encyclopedia':
                        return `üî¨ ${content.concept}`;
                    default:
                        return '–ü—Ä–æ—Å–º–æ—Ç—Ä –∫–æ–Ω—Ç–µ–Ω—Ç–∞';
                }
            }
            
            generateContentHTML(content, type) {
                switch(type) {
                    case 'archive':
                        return `
                            <div class="space-y-6">
                                <div class="flex items-center space-x-4 p-4 bg-gray-50 rounded-lg">
                                    <div class="text-4xl">${this.getFileIcon(content.category)}</div>
                                    <div>
                                        <h3 class="text-xl font-bold">${content.name}</h3>
                                        <p class="text-gray-600">
                                            ${this.formatFileSize(content.size)} ‚Ä¢ 
                                            ${new Date(content.dateAdded).toLocaleDateString()} ‚Ä¢
                                            ${this.getLanguageFlag(content.language)}
                                        </p>
                                        <div class="flex flex-wrap gap-1 mt-2">
                                            ${content.tags.map(tag => `<span class="semantic-tag">${tag}</span>`).join('')}
                                        </div>
                                    </div>
                                </div>
                                ${content.semantics ? `
                                    <div class="bg-blue-50 p-4 rounded-lg">
                                        <h4 class="font-bold mb-2">üß† –°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑</h4>
                                        <div class="text-sm text-gray-700">
                                            <p><strong>–ö–æ–Ω—Ü–µ–ø—Ü–∏–π –Ω–∞–π–¥–µ–Ω–æ:</strong> ${content.semantics.concepts ? content.semantics.concepts.length : 0}</p>
                                            <p><strong>–ö–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤:</strong> ${content.semantics.keywords ? content.semantics.keywords.length : 0}</p>
                                            ${content.semantics.summary ? `<p><strong>–†–µ–∑—é–º–µ:</strong> ${content.semantics.summary}</p>` : ''}
                                        </div>
                                    </div>
                                ` : ''}
                                <div class="code-display max-h-96 overflow-y-auto">
                                    <pre class="whitespace-pre-wrap text-sm">${typeof content.content === 'string' ? content.content.substring(0, 5000) : '[–ë–∏–Ω–∞—Ä–Ω—ã–π —Ñ–∞–π–ª]'}</pre>
                                    ${typeof content.content === 'string' && content.content.length > 5000 ? '<p class="text-gray-400 mt-2">... —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –æ–±—Ä–µ–∑–∞–Ω–æ –¥–æ 5000 —Å–∏–º–≤–æ–ª–æ–≤</p>' : ''}
                                </div>
                            </div>
                        `;
                    
                    case 'thesaurus':
                        return `
                            <div class="space-y-6">
                                <div class="text-center p-6 bg-teal-50 rounded-lg">
                                    <h2 class="text-3xl font-bold text-teal-700 mb-2">${content.term}</h2>
                                    <p class="text-teal-600">üìö –°–ª–æ–≤–∞—Ä–Ω–∞—è —Å—Ç–∞—Ç—å—è</p>
                                </div>
                                <div class="space-y-4">
                                    ${content.definitions.map((def, index) => `
                                        <div class="definition-card">
                                            <h4 class="font-semibold text-lg mb-2">–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ ${index + 1}</h4>
                                            <p class="text-gray-700 mb-2">${def.definition}</p>
                                            <div class="text-sm text-gray-500">
                                                <strong>–ò—Å—Ç–æ—á–Ω–∏–∫:</strong> ${def.source}<br>
                                                ${def.context ? `<strong>–ö–æ–Ω—Ç–µ–∫—Å—Ç:</strong> ${def.context}<br>` : ''}
                                                ${def.confidence ? `<strong>–î–æ—Å—Ç–æ–≤–µ—Ä–Ω–æ—Å—Ç—å:</strong> ${Math.round(def.confidence * 100)}%` : ''}
                                            </div>
                                        </div>
                                    `).join('')}
                                </div>
                            </div>
                        `;
                    
                    case 'encyclopedia':
                        return `
                            <div class="space-y-6">
                                <div class="text-center p-6 bg-purple-50 rounded-lg">
                                    <h2 class="text-3xl font-bold text-purple-700 mb-2">${content.concept}</h2>
                                    <p class="text-purple-600">üî¨ –≠–Ω—Ü–∏–∫–ª–æ–ø–µ–¥–∏—á–µ—Å–∫–∞—è —Å—Ç–∞—Ç—å—è</p>
                                </div>
                                <div class="encyclopedia-entry">
                                    <h3 class="text-xl font-bold mb-4">–û–ø–∏—Å–∞–Ω–∏–µ</h3>
                                    <p class="text-gray-700 mb-6">${content.description}</p>
                                    
                                    <h3 class="text-xl font-bold mb-4">–ò—Å—Ç–æ—á–Ω–∏–∫–∏ (${content.sources.length})</h3>
                                    <div class="space-y-3">
                                        ${content.sources.map(source => `
                                            <div class="definition-card">
                                                <h4 class="font-semibold text-gray-800">${source.source}</h4>
                                                <p class="text-gray-600 text-sm mt-1">${source.content.substring(0, 200)}${source.content.length > 200 ? '...' : ''}</p>
                                                <div class="text-xs text-gray-500 mt-2">
                                                    –†–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç—å: ${Math.round(source.relevance * 100)}% ‚Ä¢ 
                                                    ${new Date(source.dateAdded).toLocaleDateString()}
                                                </div>
                                            </div>
                                        `).join('')}
                                    </div>
                                </div>
                            </div>
                        `;
                    
                    default:
                        return '<p>–ö–æ–Ω—Ç–µ–Ω—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω</p>';
                }
            }
            
            downloadContent(id) {
                const archive = this.archives.find(a => a.id == id);
                if (!archive) return;

                const blob = new Blob([archive.content], { type: archive.type });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = archive.name;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            }
            
            deleteContent(type, id) {
                if (!confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç —ç–ª–µ–º–µ–Ω—Ç?')) return;
                
                switch(type) {
                    case 'archive':
                        this.archives = this.archives.filter(a => a.id != id);
                        break;
                    case 'thesaurus':
                        this.thesaurus = this.thesaurus.filter(t => t.id != id);
                        break;
                    case 'encyclopedia':
                        this.encyclopedia = this.encyclopedia.filter(e => e.id != id);
                        break;
                }
                
                this.saveAllData();
                this.updateAllUI();
            }
            
            exportUltimateArchive() {
                const exportData = {
                    version: '2.0-Ultimate',
                    timestamp: new Date().toISOString(),
                    terra_archives: this.archives,
                    terra_thesaurus: this.thesaurus,
                    terra_encyclopedia: this.encyclopedia,
                    system_info: {
                        author: this.author,
                        did: this.did,
                        system_level: this.systemLevel,
                        total_archives: this.archives.length,
                        total_thesaurus_entries: this.thesaurus.length,
                        total_encyclopedia_entries: this.encyclopedia.length,
                        languages: [...new Set(this.archives.map(a => a.language))],
                        categories: [...new Set(this.archives.map(a => a.category))],
                        total_size: this.archives.reduce((sum, a) => sum + a.size, 0)
                    }
                };

                const blob = new Blob([JSON.stringify(exportData, null, 2)], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `terra_ultimate_export_${Date.now()}.json`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
                
                alert('üì§ Terra Ultimate Archive —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω!');
            }
            
            importUltimateArchive() {
                const input = document.createElement('input');
                input.type = 'file';
                input.accept = '.json';
                input.onchange = async (e) => {
                    const file = e.target.files[0];
                    if (!file) return;

                    try {
                        const content = await this.readFileContent(file);
                        const importData = JSON.parse(content);
                        
                        if (importData.terra_archives) {
                            this.archives = [...this.archives, ...importData.terra_archives];
                        }
                        if (importData.terra_thesaurus) {
                            this.thesaurus = [...this.thesaurus, ...importData.terra_thesaurus];
                        }
                        if (importData.terra_encyclopedia) {
                            this.encyclopedia = [...this.encyclopedia, ...importData.terra_encyclopedia];
                        }
                        
                        this.saveAllData();
                        this.updateAllUI();
                        
                        alert(`‚úÖ –ò–º–ø–æ—Ä—Ç –∑–∞–≤–µ—Ä—à–µ–Ω!\n–ê—Ä—Ö–∏–≤–æ–≤: ${importData.terra_archives?.length || 0}\n–°–ª–æ–≤: ${importData.terra_thesaurus?.length || 0}\n–ö–æ–Ω—Ü–µ–ø—Ü–∏–π: ${importData.terra_encyclopedia?.length || 0}`);
                    } catch (error) {
                        console.error('–û—à–∏–±–∫–∞ –∏–º–ø–æ—Ä—Ç–∞:', error);
                        alert('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ —Ñ–∞–π–ª–∞');
                    }
                };
                input.click();
            }
        }

        // Global instance
        window.terraManager = new TerraArchiveManagerUltimate();

        // Global functions for UI interaction
        window.switchTab = (tabName) => {
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.add('hidden');
                tab.classList.remove('active');
            });
            
            document.querySelectorAll('.tab-button').forEach(btn => {
                btn.classList.remove('active');
            });
            
            document.getElementById(tabName + 'Tab').classList.remove('hidden');
            document.getElementById(tabName + 'Tab').classList.add('active');
            
            document.querySelector(`[data-tab="${tabName}"]`).classList.add('active');
            
            terraManager.currentTab = tabName;
        };

        window.dragOverHandler = (e) => {
            e.preventDefault();
            document.getElementById('dropZone').classList.add('dragover');
        };

        window.dragLeaveHandler = (e) => {
            e.preventDefault();
            document.getElementById('dropZone').classList.remove('dragover');
        };

        window.dropHandler = async (e) => {
            e.preventDefault();
            document.getElementById('dropZone').classList.remove('dragover');
            
            const files = Array.from(e.dataTransfer.files);
            await window.handleFiles(files);
        };

        window.handleFiles = async (files) => {
            for (const file of files) {
                await terraManager.addFile(file);
            }
        };

        window.performCorpusSearch = () => {
            terraManager.updateAllUI();
        };

        window.filterContent = () => {
            terraManager.updateAllUI();
        };

        window.sortContent = (criteria) => {
            const currentData = terraManager.currentTab === 'archives' ? terraManager.archives :
                               terraManager.currentTab === 'thesaurus' ? terraManager.thesaurus :
                               terraManager.encyclopedia;
            
            currentData.sort((a, b) => {
                switch(criteria) {
                    case 'name':
                        const aName = a.name || a.term || a.concept;
                        const bName = b.name || b.term || b.concept;
                        return aName.localeCompare(bName);
                    case 'date':
                        return new Date(b.dateAdded) - new Date(a.dateAdded);
                    case 'size':
                        return (b.size || 0) - (a.size || 0);
                    case 'relevance':
                        return (b.relevance || 0) - (a.relevance || 0);
                    default:
                        return 0;
                }
            });
            terraManager.updateAllUI();
        };

        window.closeModal = () => {
            document.getElementById('contentModal').classList.add('hidden');
        };

        // Tool functions (placeholders for future implementation)
        window.generateSemanticMap = () => alert('üß† –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–π –∫–∞—Ä—Ç—ã –∑–∞–ø—É—â–µ–Ω–∞...');
        window.buildThesaurus = () => alert('üìö –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ —Ç–µ–∑–∞—É—Ä—É—Å–∞ –∏–∑ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤...');
        window.extractConcepts = () => alert('üî¨ –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–π –∏–∑ –∞—Ä—Ö–∏–≤–∞...');
        window.analyzeCorpus = () => alert('üìñ –ê–Ω–∞–ª–∏–∑ –∫–æ—Ä–ø—É—Å–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤...');
        window.generateEncyclopedia = () => alert('üåê –°–æ–∑–¥–∞–Ω–∏–µ —ç–Ω—Ü–∏–∫–ª–æ–ø–µ–¥–∏–∏ –∏–∑ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤...');
        window.parseMultilingual = () => alert('üåê –ú–Ω–æ–≥–æ—è–∑—ã—á–Ω—ã–π –ø–∞—Ä—Å–∏–Ω–≥ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω...');
        window.extractTerms = () => alert('üìù –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ç–µ—Ä–º–∏–Ω–æ–≤ –∏–∑ –∫–æ—Ä–ø—É—Å–∞...');
        window.organizeAll = () => alert('üìÅ –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è –≤—Å–µ—Ö –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤...');
        window.generateMetaReport = () => terraManager.generateMetaReport();
        window.optimizeStorage = () => terraManager.optimizeStorage();
        window.syncQuantumState = () => terraManager.saveAllData();
        window.exportUltimateArchive = () => terraManager.exportUltimateArchive();
        window.importUltimateArchive = () => terraManager.importUltimateArchive();
        window.createQuantumBackup = () => terraManager.exportUltimateArchive();

        // Initialize system
        console.log('üåç Terra Archive Manager Ultimate v2.0 - –°–∏—Å—Ç–µ–º–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞!');
        console.log('üß¨ –§—Ä–∞–∫—Ç–∞–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞: –ê–ö–¢–ò–í–ù–ê');
        console.log('üõ°Ô∏è –î–µ—Ç—Å–∫–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å: –í–ö–õ–Æ–ß–ï–ù–ê');
        console.log('üìö –°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑: –ì–û–¢–û–í');
        console.log('üåç –ò–Ω–∫–ª—é–∑–∏–≤–Ω–æ—Å—Ç—å: –î–õ–Ø –í–°–ï–• –ë–ï–ó –ò–°–ö–õ–Æ–ß–ï–ù–ò–ô');
    </script>
</body>
</html>