<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Terra Archive Manager 2.0</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .terra-gradient { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
        .terra-card { backdrop-filter: blur(10px); }
        .pulse-animation { animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite; }
    </style>
</head>
<body class="min-h-screen bg-gray-100">

<div class="container mx-auto px-4 py-8">
    <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ -->
    <div class="text-center mb-8">
        <h1 class="text-4xl font-bold text-gray-800 mb-2">üöÄ Terra Archive Manager 2.0</h1>
        <p class="text-gray-600">–°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –∞—Ä—Ö–∏–≤–∞—Ç–æ—Ä —Å —Ñ—Ä–∞–∫—Ç–∞–ª—å–Ω–æ–π –º–µ—Ç–∞–Ω–∞—É–∫–æ–π L0-L7</p>
        <p class="text-sm text-gray-500 mt-2">–ê–≤—Ç–æ—Ä: –ê–±–¥—É–∫–∞—Ä–∏–º–æ–≤ –ê–±–¥—É—Ä–∞—à–∏–¥ –ê–±–¥—É–ª—Ö–∞–º–∏—Ç–æ–≤–∏—á</p>
    </div>

    <!-- –°—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã -->
    <div class="bg-white rounded-lg shadow-lg p-6 mb-8">
        <h2 class="text-2xl font-semibold mb-4">üîç –°—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã</h2>
        <div id="systemStatus" class="grid grid-cols-1 md:grid-cols-4 gap-4">
            <div class="text-center p-4 bg-gray-50 rounded">
                <div class="text-lg font-semibold" id="l0Status">L0 Kernel</div>
                <div class="text-sm text-red-500" id="l0State">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
            </div>
            <div class="text-center p-4 bg-gray-50 rounded">
                <div class="text-lg font-semibold" id="analyzerStatus">Analyzer</div>
                <div class="text-sm text-red-500" id="analyzerState">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
            </div>
            <div class="text-center p-4 bg-gray-50 rounded">
                <div class="text-lg font-semibold" id="ethicalStatus">Ethical Layer</div>
                <div class="text-sm text-red-500" id="ethicalState">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
            </div>
            <div class="text-center p-4 bg-gray-50 rounded">
                <div class="text-lg font-semibold" id="integrationStatus">Integration</div>
                <div class="text-sm text-red-500" id="integrationState">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
            </div>
        </div>
    </div>

    <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å -->
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
        
        <!-- –ü–∞–Ω–µ–ª—å –∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–∏—è -->
        <div class="bg-white rounded-lg shadow-lg p-6">
            <h2 class="text-2xl font-semibold mb-4">üì¶ –ê—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤</h2>
            
            <div class="mb-4">
                <label class="block text-sm font-medium text-gray-700 mb-2">–¢–µ–∫—Å—Ç –¥–ª—è –∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–∏—è:</label>
                <textarea 
                    id="archiveInput" 
                    rows="6" 
                    class="w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500"
                    placeholder="–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –¥–ª—è –∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–∏—è –∏ —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞..."
                ></textarea>
            </div>

            <div class="mb-4">
                <label class="block text-sm font-medium text-gray-700 mb-2">User DID (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):</label>
                <input 
                    id="userDid" 
                    type="text" 
                    class="w-full p-2 border border-gray-300 rounded-md"
                    value="aiuz:did:aiuz:stakeholder:abdukarimov_aaahash1234567890"
                    placeholder="–ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"
                />
            </div>

            <div class="flex gap-3">
                <button 
                    id="archiveBtn" 
                    class="flex-1 bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 transition duration-200"
                >
                    üöÄ –ê—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞—Ç—å
                </button>
                <button 
                    id="analyzeBtn" 
                    class="flex-1 bg-green-600 text-white py-2 px-4 rounded-md hover:bg-green-700 transition duration-200"
                >
                    üß† –¢–æ–ª—å–∫–æ –∞–Ω–∞–ª–∏–∑
                </button>
            </div>

            <div id="archiveResult" class="mt-4 p-4 bg-gray-50 rounded-md hidden">
                <h3 class="font-semibold mb-2">–†–µ–∑—É–ª—å—Ç–∞—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏:</h3>
                <pre id="archiveOutput" class="text-sm overflow-auto max-h-40"></pre>
            </div>
        </div>

        <!-- –ü–∞–Ω–µ–ª—å –ø–æ–∏—Å–∫–∞ -->
        <div class="bg-white rounded-lg shadow-lg p-6">
            <h2 class="text-2xl font-semibold mb-4">üîç –ü–æ–∏—Å–∫ –≤ –∞—Ä—Ö–∏–≤–µ</h2>
            
            <div class="mb-4">
                <label class="block text-sm font-medium text-gray-700 mb-2">–ü–æ–∏—Å–∫–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å:</label>
                <input 
                    id="searchInput" 
                    type="text" 
                    class="w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-green-500"
                    placeholder="–í–≤–µ–¥–∏—Ç–µ –∑–∞–ø—Ä–æ—Å –¥–ª—è –ø–æ–∏—Å–∫–∞..."
                />
            </div>

            <button 
                id="searchBtn" 
                class="w-full bg-green-600 text-white py-2 px-4 rounded-md hover:bg-green-700 transition duration-200 mb-4"
            >
                üîç –ù–∞–π—Ç–∏
            </button>

            <div id="searchResult" class="mt-4 p-4 bg-gray-50 rounded-md hidden">
                <h3 class="font-semibold mb-2">–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞:</h3>
                <div id="searchOutput" class="text-sm"></div>
            </div>
        </div>
    </div>

    <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–∞—è –ø–∞–Ω–µ–ª—å -->
    <div class="mt-8 bg-white rounded-lg shadow-lg p-6">
        <h2 class="text-2xl font-semibold mb-4">‚ÑπÔ∏è –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–∏—Å—Ç–µ–º–µ</h2>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
            <div class="text-center p-4 bg-blue-50 rounded">
                <div class="text-2xl font-bold text-blue-600" id="totalProcessed">0</div>
                <div class="text-sm text-gray-600">–û–±—Ä–∞–±–æ—Ç–∞–Ω–æ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤</div>
            </div>
            <div class="text-center p-4 bg-green-50 rounded">
                <div class="text-2xl font-bold text-green-600" id="conceptsFound">0</div>
                <div class="text-sm text-gray-600">–ù–∞–π–¥–µ–Ω–æ –∫–æ–Ω—Ü–µ–ø—Ü–∏–π</div>
            </div>
            <div class="text-center p-4 bg-purple-50 rounded">
                <div class="text-2xl font-bold text-purple-600" id="currentLevel">L0</div>
                <div class="text-sm text-gray-600">–¢–µ–∫—É—â–∏–π —É—Ä–æ–≤–µ–Ω—å</div>
            </div>
        </div>

        <div class="mt-4">
            <button 
                id="systemInfoBtn" 
                class="bg-gray-600 text-white py-2 px-4 rounded-md hover:bg-gray-700 transition duration-200"
            >
                üìä –ü–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
            </button>
            <button 
                id="compatibilityBtn" 
                class="ml-2 bg-purple-600 text-white py-2 px-4 rounded-md hover:bg-purple-700 transition duration-200"
            >
                üîß –û—Ç—á–µ—Ç —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏
            </button>
        </div>

        <div id="detailedInfo" class="mt-4 p-4 bg-gray-50 rounded-md hidden">
            <pre id="detailedOutput" class="text-sm overflow-auto max-h-60"></pre>
        </div>
    </div>

    <!-- –ü–æ–¥–≤–∞–ª -->
    <div class="mt-8 text-center text-gray-500 text-sm">
        <p>üß¨ Terra Archive Manager 2.0 | –§—Ä–∞–∫—Ç–∞–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ L0-L7</p>
        <p>–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å: IE5+ –¥–æ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –±—Ä–∞—É–∑–µ—Ä–æ–≤ | Pentium I –¥–æ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ü–ö</p>
    </div>
</div>

<script>
// ===== –ò–ù–¢–ï–ì–†–ê–¶–ò–Ø –í–°–ï–• –ö–û–ú–ü–û–ù–ï–ù–¢–û–í TERRA =====

// L0 SemanticKernel
function L0SemanticKernel() {
    this.version = "1.0-L0";
    this.author = "–ê–±–¥—É–∫–∞—Ä–∏–º–æ–≤ –ê–±–¥—É—Ä–∞—à–∏–¥ –ê–±–¥—É–ª—Ö–∞–º–∏—Ç–æ–≤–∏—á";
    this.did = "aiuz:did:aiuz:stakeholder:abdukarimov_aaahash1234567890";
    
    this.ontology = {
        "–∞—Ä—Ö–∏–≤": ["—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ", "—Ö—Ä–∞–Ω–µ–Ω–∏–µ", "—Ñ–∞–π–ª"],
        "—Å–µ–º–∞–Ω—Ç–∏–∫–∞": ["—Å–º—ã—Å–ª", "–∑–Ω–∞—á–µ–Ω–∏–µ", "–∫–æ–Ω—Ç–µ–∫—Å—Ç"],
        "–∞–Ω–∞–ª–∏–∑": ["–∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ", "–∏–∑—É—á–µ–Ω–∏–µ", "—Ä–∞–∑–±–æ—Ä"],
        "–¥–æ–∫—É–º–µ–Ω—Ç": ["—Ç–µ–∫—Å—Ç", "—Ñ–∞–π–ª", "–∑–∞–ø–∏—Å—å"],
        "–∑–Ω–∞–Ω–∏–µ": ["–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è", "–¥–∞–Ω–Ω—ã–µ", "—Ñ–∞–∫—Ç"]
    };
    
    this.stopWords = [
        "–∞", "–≤", "–∏", "–∫", "–Ω–∞", "–Ω–µ", "–æ", "—Å", "—Ç–æ", "—á—Ç–æ",
        "–¥–ª—è", "–∫–∞–∫", "–∏–∑", "–∏–ª–∏", "—ç—Ç–æ", "–æ—Ç", "–∑–∞", "–ø–æ", "–¥–æ"
    ];
    
    this.ethicalFilters = [
        "–Ω–∞—Å–∏–ª–∏–µ", "–Ω–∞—Ä–∫–æ—Ç–∏–∫–∏", "–¥–∏—Å–∫—Ä–∏–º–∏–Ω–∞—Ü–∏—è", "–Ω–µ–Ω–∞–≤–∏—Å—Ç—å"
    ];
    
    this.localKnowledge = {};
    this.verifiedUsers = [
        "aiuz:did:aiuz:stakeholder:abdukarimov_aaahash1234567890"
    ];
}

L0SemanticKernel.prototype.processRequest = function(userInput, userDid) {
    if (!this.verifyUser(userDid)) {
        return "–û—à–∏–±–∫–∞: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –≤–µ—Ä–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω";
    }
    
    var intent = this.simpleIntentAnalysis(userInput);
    var keywords = this.extractKeywords(userInput);
    
    if (!this.simpleEthicalCheck(userInput)) {
        return "–ó–∞–ø—Ä–æ—Å –æ—Ç–∫–ª–æ–Ω–µ–Ω –ø–æ —ç—Ç–∏—á–µ—Å–∫–∏–º —Å–æ–æ–±—Ä–∞–∂–µ–Ω–∏—è–º";
    }
    
    var response = this.localKnowledgeSearch(keywords, intent);
    this.logSession(userDid, userInput, response);
    
    return response;
};

L0SemanticKernel.prototype.verifyUser = function(userDid) {
    for (var i = 0; i < this.verifiedUsers.length; i++) {
        if (this.verifiedUsers[i] === userDid) return true;
    }
    return false;
};

L0SemanticKernel.prototype.simpleIntentAnalysis = function(text) {
    text = text.toLowerCase();
    
    if (text.indexOf("–∞—Ä—Ö–∏–≤") !== -1 || text.indexOf("—Å–æ—Ö—Ä–∞–Ω") !== -1) return "archive";
    if (text.indexOf("–Ω–∞–π–¥–∏") !== -1 || text.indexOf("–ø–æ–∏—Å–∫") !== -1) return "search";
    if (text.indexOf("–∞–Ω–∞–ª–∏–∑") !== -1 || text.indexOf("–∏–∑—É—á–∏") !== -1) return "analyze";
    if (text.indexOf("–ø–æ–º–æ—â—å") !== -1 || text.indexOf("–æ–±—ä—è—Å–Ω–∏") !== -1) return "help";
    
    return "general";
};

L0SemanticKernel.prototype.extractKeywords = function(text) {
    var words = text.toLowerCase().split(/\s+/);
    var keywords = [];
    
    for (var i = 0; i < words.length; i++) {
        var word = words[i].replace(/[^\w\u0400-\u04FF]/g, '');
        
        if (word.length > 2 && this.stopWords.indexOf(word) === -1) {
            if (keywords.indexOf(word) === -1) {
                keywords.push(word);
            }
        }
    }
    
    return keywords;
};

L0SemanticKernel.prototype.simpleEthicalCheck = function(text) {
    text = text.toLowerCase();
    
    for (var i = 0; i < this.ethicalFilters.length; i++) {
        if (text.indexOf(this.ethicalFilters[i]) !== -1) {
            return false;
        }
    }
    
    return true;
};

L0SemanticKernel.prototype.localKnowledgeSearch = function(keywords, intent) {
    var relevantInfo = [];
    
    for (var i = 0; i < keywords.length; i++) {
        var keyword = keywords[i];
        
        if (this.ontology[keyword]) {
            relevantInfo.push("–ù–∞–π–¥–µ–Ω–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –ø–æ —Ç–µ—Ä–º–∏–Ω—É '" + keyword + "': " + 
                            this.ontology[keyword].join(", "));
        }
        
        if (this.localKnowledge[keyword]) {
            relevantInfo.push(this.localKnowledge[keyword]);
        }
    }
    
    if (relevantInfo.length === 0) {
        return this.generateDefaultResponse(intent);
    }
    
    return "–ù–∞ –æ—Å–Ω–æ–≤–µ –∞–Ω–∞–ª–∏–∑–∞ –Ω–∞–π–¥–µ–Ω–∞ —Å–ª–µ–¥—É—é—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:\n" + relevantInfo.join("\n");
};

L0SemanticKernel.prototype.generateDefaultResponse = function(intent) {
    switch (intent) {
        case "archive":
            return "–î–ª—è –∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ñ—É–Ω–∫—Ü–∏–∏ Terra Archive Manager";
        case "search":
            return "–ü–æ–∏—Å–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω. –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω–∞ –≤ –ª–æ–∫–∞–ª—å–Ω–æ–π –±–∞–∑–µ";
        case "analyze":
            return "–ê–Ω–∞–ª–∏–∑ –∑–∞–≤–µ—Ä—à–µ–Ω. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –±–æ–ª–µ–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã";
        case "help":
            return "–î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã: –∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–∏–µ, –ø–æ–∏—Å–∫, –∞–Ω–∞–ª–∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤";
        default:
            return "–ó–∞–ø—Ä–æ—Å –æ–±—Ä–∞–±–æ—Ç–∞–Ω. –£—Ç–æ—á–Ω–∏—Ç–µ, —á—Ç–æ –∏–º–µ–Ω–Ω–æ –≤–∞—Å –∏–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç";
    }
};

L0SemanticKernel.prototype.logSession = function(userDid, input, output) {
    if (!window.terraSessionLog) {
        window.terraSessionLog = [];
    }
    
    window.terraSessionLog.push({
        timestamp: new Date().toISOString(),
        author: this.author,
        did: this.did,
        userDid: userDid,
        input: input,
        output: output
    });
    
    if (window.terraSessionLog.length > 100) {
        window.terraSessionLog = window.terraSessionLog.slice(-100);
    }
};

// Offline Semantic Analyzer (—É–ø—Ä–æ—â–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è)
function OfflineSemanticAnalyzer() {
    this.version = "1.0-Offline";
    this.author = "–ê–±–¥—É–∫–∞—Ä–∏–º–æ–≤ –ê–±–¥—É—Ä–∞—à–∏–¥ –ê–±–¥—É–ª—Ö–∞–º–∏—Ç–æ–≤–∏—á";
    
    this.embeddedThesaurus = {
        "–∞–Ω–∞–ª–∏–∑": ["–∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ", "–∏–∑—É—á–µ–Ω–∏–µ", "—Ä–∞–∑–±–æ—Ä", "—Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏–µ", "–æ–±–∑–æ—Ä"],
        "–¥–æ–∫—É–º–µ–Ω—Ç": ["—Ñ–∞–π–ª", "—Ç–µ–∫—Å—Ç", "–∑–∞–ø–∏—Å—å", "–º–∞—Ç–µ—Ä–∏–∞–ª", "–±—É–º–∞–≥–∞"],
        "–∞—Ä—Ö–∏–≤": ["—Ö—Ä–∞–Ω–∏–ª–∏—â–µ", "–∫–æ–ª–ª–µ–∫—Ü–∏—è", "—Å–æ–±—Ä–∞–Ω–∏–µ", "–±–∞–Ω–∫", "–±–∞–∑–∞"],
        "–∑–Ω–∞–Ω–∏–µ": ["–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è", "–¥–∞–Ω–Ω—ã–µ", "—Å–≤–µ–¥–µ–Ω–∏—è", "—Ñ–∞–∫—Ç—ã", "–æ–ø—ã—Ç"],
        "–ø—Ä–æ–µ–∫—Ç": ["–∑–∞–¥–∞—á–∞", "—Ä–∞–±–æ—Ç–∞", "–¥–µ–ª–æ", "–ø—Ä–æ–≥—Ä–∞–º–º–∞", "–ø–ª–∞–Ω"]
    };
    
    this.analysisStats = {
        totalAnalyzed: 0,
        conceptsExtracted: 0,
        domainsIdentified: 0,
        lastAnalysis: null
    };
}

OfflineSemanticAnalyzer.prototype.analyzeText = function(text) {
    this.analysisStats.totalAnalyzed++;
    this.analysisStats.lastAnalysis = new Date().toISOString();
    
    var analysis = {
        timestamp: new Date().toISOString(),
        originalText: text,
        textLength: text.length,
        concepts: [],
        keywords: [],
        intent: null,
        semanticScore: 0,
        summary: ""
    };
    
    // –ü—Ä–æ—Å—Ç–æ–π –∞–Ω–∞–ª–∏–∑
    analysis.keywords = this.extractSimpleKeywords(text);
    analysis.concepts = this.findConcepts(text);
    analysis.semanticScore = Math.min((analysis.keywords.length * 10) + (analysis.concepts.length * 15), 100);
    analysis.summary = "–ê–Ω–∞–ª–∏–∑ –∑–∞–≤–µ—Ä—à–µ–Ω. –ù–∞–π–¥–µ–Ω–æ " + analysis.keywords.length + " –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤ –∏ " + analysis.concepts.length + " –∫–æ–Ω—Ü–µ–ø—Ü–∏–π.";
    
    this.analysisStats.conceptsExtracted += analysis.concepts.length;
    
    return analysis;
};

OfflineSemanticAnalyzer.prototype.extractSimpleKeywords = function(text) {
    var words = text.toLowerCase().split(/\s+/);
    var keywords = [];
    var stopWords = ["–∞", "–≤", "–∏", "–∫", "–Ω–∞", "–Ω–µ", "–æ", "—Å", "—Ç–æ", "—á—Ç–æ", "–¥–ª—è", "–∫–∞–∫", "–∏–∑", "–∏–ª–∏", "—ç—Ç–æ"];
    
    for (var i = 0; i < words.length; i++) {
        var word = words[i].replace(/[^\w\u0400-\u04FF]/g, '');
        if (word.length > 2 && stopWords.indexOf(word) === -1) {
            if (keywords.indexOf(word) === -1) {
                keywords.push({word: word, frequency: 1, significance: 1});
            }
        }
    }
    
    return keywords.slice(0, 10); // –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ
};

OfflineSemanticAnalyzer.prototype.findConcepts = function(text) {
    var concepts = [];
    var textLower = text.toLowerCase();
    
    for (var concept in this.embeddedThesaurus) {
        if (textLower.indexOf(concept) !== -1) {
            concepts.push({
                concept: concept,
                matches: [concept],
                relevance: 1
            });
        }
    }
    
    return concepts;
};

OfflineSemanticAnalyzer.prototype.getStats = function() {
    return this.analysisStats;
};

// Terra Ethical Layer (—É–ø—Ä–æ—â–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è)
function TerraEthicalLayer() {
    this.version = "7.0-Terra";
    this.author = "–ê–±–¥—É–∫–∞—Ä–∏–º–æ–≤ –ê–±–¥—É—Ä–∞—à–∏–¥ –ê–±–¥—É–ª—Ö–∞–º–∏—Ç–æ–≤–∏—á";
    
    this.detoxStats = {
        totalChecks: 0,
        blockedContent: 0,
        warningsIssued: 0,
        enhancedContent: 0,
        lastReset: new Date().toISOString()
    };
    
    this.ethicalFilters = [
        "–Ω–∞—Å–∏–ª–∏–µ", "–∞–≥—Ä–µ—Å—Å–∏—è", "–Ω–∞—Ä–∫–æ—Ç–∏–∫–∏", "–¥–∏—Å–∫—Ä–∏–º–∏–Ω–∞—Ü–∏—è", "–Ω–µ–Ω–∞–≤–∏—Å—Ç—å"
    ];
}

TerraEthicalLayer.prototype.validateContent = function(content, context) {
    this.detoxStats.totalChecks++;
    
    var validation = {
        timestamp: new Date().toISOString(),
        originalContent: content,
        context: context || {},
        passed: true,
        violations: [],
        warnings: [],
        enhancements: [],
        processedContent: content,
        confidence: 1.0
    };
    
    // –ü—Ä–æ—Å—Ç–∞—è —ç—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
    var contentLower = content.toLowerCase();
    
    for (var i = 0; i < this.ethicalFilters.length; i++) {
        var filter = this.ethicalFilters[i];
        if (contentLower.indexOf(filter) !== -1) {
            validation.passed = false;
            validation.violations.push({
                type: "ethical_violation",
                pattern: filter,
                severity: "high",
                message: "–û–±–Ω–∞—Ä—É–∂–µ–Ω –Ω–µ—ç—Ç–∏—á–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç: " + filter
            });
            this.detoxStats.blockedContent++;
        }
    }
    
    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –ø–æ–∑–∏—Ç–∏–≤–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç
    var positivePatterns = ["–∑–Ω–∞–Ω–∏–µ", "–æ–±—É—á–µ–Ω–∏–µ", "–ø–æ–º–æ—â—å", "—Ä–∞–∑–≤–∏—Ç–∏–µ"];
    for (var j = 0; j < positivePatterns.length; j++) {
        if (contentLower.indexOf(positivePatterns[j]) !== -1) {
            validation.enhancements.push({
                type: "positive_content",
                pattern: positivePatterns[j],
                message: "–û–±–Ω–∞—Ä—É–∂–µ–Ω –ø–æ–∑–∏—Ç–∏–≤–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç"
            });
            this.detoxStats.enhancedContent++;
        }
    }
    
    return validation;
};

TerraEthicalLayer.prototype.getDetoxStats = function() {
    return this.detoxStats;
};

// Terra Semantic Integration
function TerraSemanticIntegration() {
    this.version = "2.0-Integrated";
    this.author = "–ê–±–¥—É–∫–∞—Ä–∏–º–æ–≤ –ê–±–¥—É—Ä–∞—à–∏–¥ –ê–±–¥—É–ª—Ö–∞–º–∏—Ç–æ–≤–∏—á";
    
    this.l0Kernel = null;
    this.offlineAnalyzer = null;
    this.ethicalLayer = null;
    this.archiveManager = null;
    
    this.currentLevel = 0;
    this.integrationStats = {
        totalProcessed: 0,
        semanticAnalyses: 0,
        ethicalChecks: 0,
        archiveOperations: 0,
        lastActivity: null
    };
    
    this.initialize();
}

TerraSemanticIntegration.prototype.initialize = function() {
    console.log("üß¨ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Terra Semantic Integration...");
    
    try {
        this.l0Kernel = new L0SemanticKernel();
        this.offlineAnalyzer = new OfflineSemanticAnalyzer();
        this.ethicalLayer = new TerraEthicalLayer();
        this.archiveManager = this.createSimpleArchiveManager();
        
        console.log("‚úÖ Terra Semantic Integration —É—Å–ø–µ—à–Ω–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ (L0)");
        this.updateUI();
        
    } catch (error) {
        console.error("‚ùå –û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏:", error);
    }
};

TerraSemanticIntegration.prototype.createSimpleArchiveManager = function() {
    return {
        level: 0,
        archive: function(data) {
            if (!window.terraSimpleArchive) {
                window.terraSimpleArchive = [];
            }
            window.terraSimpleArchive.push({
                timestamp: new Date().toISOString(),
                data: data,
                size: JSON.stringify(data).length
            });
            
            if (window.terraSimpleArchive.length > 50) {
                window.terraSimpleArchive = window.terraSimpleArchive.slice(-50);
            }
        },
        
        retrieve: function(query) {
            if (!window.terraSimpleArchive) return [];
            
            var results = [];
            for (var i = 0; i < window.terraSimpleArchive.length; i++) {
                var item = window.terraSimpleArchive[i];
                if (JSON.stringify(item.data).toLowerCase().indexOf(query.toLowerCase()) !== -1) {
                    results.push(item);
                }
            }
            return results;
        }
    };
};

TerraSemanticIntegration.prototype.processArchiveRequest = function(text, files, userDid) {
    this.integrationStats.totalProcessed++;
    this.integrationStats.lastActivity = new Date().toISOString();
    
    var result = {
        timestamp: new Date().toISOString(),
        level: this.currentLevel,
        userDid: userDid,
        originalRequest: text,
        files: files || [],
        ethicalValidation: null,
        semanticAnalysis: null,
        archiveResult: null,
        success: false,
        errors: [],
        warnings: []
    };
    
    try {
        // 1. –≠—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
        if (this.ethicalLayer) {
            result.ethicalValidation = this.ethicalLayer.validateContent(text, {
                archiveMode: true,
                userDid: userDid
            });
            this.integrationStats.ethicalChecks++;
        }
        
        // 2. –°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑
        if (this.offlineAnalyzer) {
            result.semanticAnalysis = this.offlineAnalyzer.analyzeText(text);
            this.integrationStats.semanticAnalyses++;
        }
        
        // 3. –ê—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–∏–µ
        if (this.archiveManager) {
            var archiveData = {
                text: result.ethicalValidation ? result.ethicalValidation.processedContent : text,
                semantics: result.semanticAnalysis,
                files: files,
                metadata: {
                    author: this.author,
                    level: this.currentLevel,
                    timestamp: result.timestamp
                }
            };
            
            this.archiveManager.archive(archiveData);
            result.archiveResult = {
                archived: true,
                dataSize: JSON.stringify(archiveData).length,
                method: "level_" + this.currentLevel
            };
            this.integrationStats.archiveOperations++;
        }
        
        result.success = true;
        
    } catch (error) {
        result.errors.push("–û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏: " + error.message);
        console.error("‚ùå –û—à–∏–±–∫–∞ –≤ processArchiveRequest:", error);
    }
    
    this.updateUI();
    return result;
};

TerraSemanticIntegration.prototype.searchArchive = function(query, options) {
    var searchResult = {
        timestamp: new Date().toISOString(),
        query: query,
        level: this.currentLevel,
        results: [],
        totalFound: 0,
        searchMethod: "simple_L0",
        processingTime: 0
    };
    
    var startTime = new Date().getTime();
    
    try {
        if (this.archiveManager) {
            searchResult.results = this.archiveManager.retrieve(query);
        }
        
        searchResult.totalFound = searchResult.results.length;
        
    } catch (error) {
        console.error("‚ùå –û—à–∏–±–∫–∞ –ø–æ–∏—Å–∫–∞:", error);
        searchResult.error = error.message;
    }
    
    searchResult.processingTime = new Date().getTime() - startTime;
    return searchResult;
};

TerraSemanticIntegration.prototype.getSystemInfo = function() {
    return {
        version: this.version,
        author: this.author,
        currentLevel: this.currentLevel,
        componentsLoaded: {
            l0Kernel: !!this.l0Kernel,
            offlineAnalyzer: !!this.offlineAnalyzer,
            ethicalLayer: !!this.ethicalLayer,
            archiveManager: !!this.archiveManager
        },
        statistics: this.integrationStats
    };
};

TerraSemanticIntegration.prototype.updateUI = function() {
    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–æ–≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
    document.getElementById('l0State').textContent = this.l0Kernel ? '‚úÖ –ì–æ—Ç–æ–≤' : '‚ùå –û—à–∏–±–∫–∞';
    document.getElementById('l0State').className = this.l0Kernel ? 'text-sm text-green-500' : 'text-sm text-red-500';
    
    document.getElementById('analyzerState').textContent = this.offlineAnalyzer ? '‚úÖ –ì–æ—Ç–æ–≤' : '‚ùå –û—à–∏–±–∫–∞';
    document.getElementById('analyzerState').className = this.offlineAnalyzer ? 'text-sm text-green-500' : 'text-sm text-red-500';
    
    document.getElementById('ethicalState').textContent = this.ethicalLayer ? '‚úÖ –ì–æ—Ç–æ–≤' : '‚ùå –û—à–∏–±–∫–∞';
    document.getElementById('ethicalState').className = this.ethicalLayer ? 'text-sm text-green-500' : 'text-sm text-red-500';
    
    document.getElementById('integrationState').textContent = '‚úÖ –ì–æ—Ç–æ–≤';
    document.getElementById('integrationState').className = 'text-sm text-green-500';
    
    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
    document.getElementById('totalProcessed').textContent = this.integrationStats.totalProcessed;
    document.getElementById('conceptsFound').textContent = this.offlineAnalyzer ? this.offlineAnalyzer.getStats().conceptsExtracted : 0;
    document.getElementById('currentLevel').textContent = 'L' + this.currentLevel;
};

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã
var terraSystem = new TerraSemanticIntegration();

// –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
document.addEventListener('DOMContentLoaded', function() {
    
    // –ê—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–∏–µ
    document.getElementById('archiveBtn').addEventListener('click', function() {
        var text = document.getElementById('archiveInput').value;
        var userDid = document.getElementById('userDid').value;
        
        if (!text.trim()) {
            alert('–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –¥–ª—è –∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–∏—è');
            return;
        }
        
        var result = terraSystem.processArchiveRequest(text, [], userDid);
        
        document.getElementById('archiveResult').classList.remove('hidden');
        document.getElementById('archiveOutput').textContent = JSON.stringify(result, null, 2);
        
        // –û—á–∏—Å—Ç–∫–∞ –ø–æ–ª—è –≤–≤–æ–¥–∞
        document.getElementById('archiveInput').value = '';
    });
    
    // –¢–æ–ª—å–∫–æ –∞–Ω–∞–ª–∏–∑
    document.getElementById('analyzeBtn').addEventListener('click', function() {
        var text = document.getElementById('archiveInput').value;
        
        if (!text.trim()) {
            alert('–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞');
            return;
        }
        
        var analysis = terraSystem.offlineAnalyzer.analyzeText(text);
        
        document.getElementById('archiveResult').classList.remove('hidden');
        document.getElementById('archiveOutput').textContent = JSON.stringify(analysis, null, 2);
        
        terraSystem.updateUI();
    });
    
    // –ü–æ–∏—Å–∫
    document.getElementById('searchBtn').addEventListener('click', function() {
        var query = document.getElementById('searchInput').value;
        
        if (!query.trim()) {
            alert('–í–≤–µ–¥–∏—Ç–µ –ø–æ–∏—Å–∫–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å');
            return;
        }
        
        var results = terraSystem.searchArchive(query);
        
        document.getElementById('searchResult').classList.remove('hidden');
        document.getElementById('searchOutput').innerHTML = 
            '<p><strong>–ù–∞–π–¥–µ–Ω–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤:</strong> ' + results.totalFound + '</p>' +
            '<p><strong>–í—Ä–µ–º—è –ø–æ–∏—Å–∫–∞:</strong> ' + results.processingTime + '–º—Å</p>' +
            '<pre>' + JSON.stringify(results.results, null, 2) + '</pre>';
        
        // –û—á–∏—Å—Ç–∫–∞ –ø–æ–ª—è –ø–æ–∏—Å–∫–∞
        document.getElementById('searchInput').value = '';
    });
    
    // –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–∏—Å—Ç–µ–º–µ
    document.getElementById('systemInfoBtn').addEventListener('click', function() {
        var info = terraSystem.getSystemInfo();
        
        document.getElementById('detailedInfo').classList.remove('hidden');
        document.getElementById('detailedOutput').textContent = JSON.stringify(info, null, 2);
    });
    
    // –û—Ç—á–µ—Ç —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏
    document.getElementById('compatibilityBtn').addEventListener('click', function() {
        var compatibility = {
            browser: navigator.userAgent,
            version: terraSystem.version,
            level: 'L' + terraSystem.currentLevel,
            features: {
                localStorage: typeof localStorage !== 'undefined',
                indexedDB: typeof indexedDB !== 'undefined',
                webWorkers: typeof Worker !== 'undefined'
            },
            performance: {
                memory: navigator.deviceMemory || 'unknown',
                connection: navigator.connection ? navigator.connection.effectiveType : 'unknown'
            }
        };
        
        document.getElementById('detailedInfo').classList.remove('hidden');
        document.getElementById('detailedOutput').textContent = JSON.stringify(compatibility, null, 2);
    });
    
});

// –ì–ª–æ–±–∞–ª—å–Ω—ã–π API
window.TerraAPI = {
    archive: function(text, files, userDid) {
        return terraSystem.processArchiveRequest(text, files, userDid);
    },
    search: function(query, options) {
        return terraSystem.searchArchive(query, options);
    },
    getSystemInfo: function() {
        return terraSystem.getSystemInfo();
    }
};

console.log("üöÄ Terra Archive Manager 2.0 –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ!");
</script>

</body>
</html>