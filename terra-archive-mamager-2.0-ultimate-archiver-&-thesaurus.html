<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üåç Terra Archive Manager 2.0 - Ultimate Archiver & Thesaurus</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.2.19/tailwind.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mammoth/1.4.21/mammoth.browser.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Montserrat:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <style>
        /* Terra Brand Book v2.0 - –§—Ä–∞–∫—Ç–∞–ª—å–Ω–∞—è –ú–µ—Ç–∞–Ω–∞—É–∫–∞ –ü–∞–ª–∏—Ç—Ä–∞ */
        :root {
            /* L0 - –û—Å–Ω–æ–≤–∞ (–ù–µ–π—Ä–æ-–°–∏–º–±–∏–æ–∑) */
            --terra-neural-green: #2E8B57;
            --terra-quantum-blue: #4A90E2;
            --terra-bio-orange: #FF8C42;
            --terra-meta-purple: #7B66DC;
            
            /* L1 - –°–∏—Å—Ç–µ–º–Ω–∞—è –ú–µ–∂–¥–∏—Å—Ü–∏–ø–ª–∏–Ω–∞—Ä–Ω–æ—Å—Ç—å */
            --soft-gray: #F5F5F5;
            --deep-gray: #2C3E50;
            --success-green: #27AE60;
            --warning-amber: #F39C12;
            --error-crimson: #E74C3C;
            
            /* L2 - –ö–æ—Ä–ø—É—Å–Ω–∞—è –ú–µ—Ç–æ–¥–æ–ª–æ–≥–∏—è */
            --corpus-teal: #20B2AA;
            --lexicon-indigo: #6366F1;
            --semantic-emerald: #10B981;
            
            /* L3 - –§—Ä–∞–∫—Ç–∞–ª—å–Ω–∞—è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ */
            --fractal-violet: #8B5CF6;
            --recursive-cyan: #06B6D4;
            --holistic-rose: #F43F5E;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, var(--soft-gray) 0%, #E8F4FD 100%);
            margin: 0;
            padding: 0;
        }

        .terra-card {
            background: white;
            border-radius: 16px;
            box-shadow: 0 8px 24px rgba(0,0,0,0.12);
            border: 2px solid transparent;
            background-image: linear-gradient(white, white), 
                             linear-gradient(45deg, var(--terra-quantum-blue), var(--terra-meta-purple));
            background-origin: border-box;
            background-clip: content-box, border-box;
        }

        .fractal-button {
            background: linear-gradient(135deg, var(--terra-quantum-blue), var(--terra-meta-purple));
            color: white;
            border: none;
            padding: 14px 28px;
            border-radius: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.25, 0.8, 0.25, 1);
            font-family: 'Montserrat', sans-serif;
            position: relative;
            overflow: hidden;
        }

        .fractal-button:hover {
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 12px 36px rgba(75, 144, 226, 0.4);
        }

        .fractal-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s;
        }

        .fractal-button:hover::before {
            left: 100%;
        }

        .meta-archiver-header {
            background: linear-gradient(135deg, var(--terra-neural-green), var(--terra-quantum-blue));
            color: white;
            border-radius: 0;
            padding: 24px 0;
            position: relative;
            overflow: hidden;
        }

        .meta-archiver-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="fractal" patternUnits="userSpaceOnUse" width="10" height="10"><circle cx="5" cy="5" r="1" fill="rgba(255,255,255,0.1)"/></pattern></defs><rect width="100" height="100" fill="url(%23fractal)"/></svg>');
            opacity: 0.3;
        }

        .thesaurus-zone {
            border: 3px dashed var(--corpus-teal);
            border-radius: 16px;
            padding: 40px;
            text-align: center;
            background: linear-gradient(135deg, rgba(32, 178, 170, 0.05), rgba(16, 185, 129, 0.05));
            transition: all 0.4s ease;
            position: relative;
        }

        .thesaurus-zone.dragover {
            background: linear-gradient(135deg, rgba(32, 178, 170, 0.15), rgba(16, 185, 129, 0.15));
            border-color: var(--semantic-emerald);
            transform: scale(1.02);
        }

        .archive-item {
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 12px;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.25, 0.8, 0.25, 1);
            border-left: 6px solid var(--terra-neural-green);
            background: linear-gradient(135deg, rgba(255,255,255,0.9), rgba(248,250,252,0.9));
            backdrop-filter: blur(10px);
        }

        .archive-item:hover {
            background: linear-gradient(135deg, rgba(46, 139, 87, 0.1), rgba(75, 144, 226, 0.05));
            transform: translateX(8px) translateY(-2px);
            box-shadow: 0 8px 24px rgba(46, 139, 87, 0.2);
        }

        .corpus-search-box {
            width: 100%;
            padding: 16px 20px;
            border: 3px solid var(--lexicon-indigo);
            border-radius: 12px;
            font-size: 16px;
            font-family: 'Inter', sans-serif;
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
        }

        .corpus-search-box:focus {
            outline: none;
            border-color: var(--semantic-emerald);
            box-shadow: 0 0 0 4px rgba(16, 185, 129, 0.1);
        }

        .semantic-tag {
            display: inline-block;
            background: linear-gradient(135deg, var(--fractal-violet), var(--recursive-cyan));
            color: white;
            padding: 6px 16px;
            border-radius: 24px;
            font-size: 12px;
            font-weight: 500;
            margin: 4px;
            transition: all 0.3s ease;
        }

        .semantic-tag:hover {
            transform: scale(1.1);
            box-shadow: 0 4px 12px rgba(139, 92, 246, 0.3);
        }

        .save-indicator {
            position: fixed;
            top: 24px;
            right: 24px;
            padding: 12px 20px;
            border-radius: 12px;
            font-weight: 600;
            z-index: 1000;
            backdrop-filter: blur(10px);
            border: 2px solid rgba(255,255,255,0.2);
        }

        .save-indicator.saving {
            background: linear-gradient(135deg, var(--warning-amber), #FFA500);
            color: white;
        }

        .save-indicator.saved {
            background: linear-gradient(135deg, var(--success-green), var(--semantic-emerald));
            color: white;
        }

        .meta-stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }

        .stat-card {
            background: linear-gradient(135deg, rgba(255,255,255,0.9), rgba(248,250,252,0.9));
            padding: 20px;
            border-radius: 12px;
            border-left: 4px solid var(--corpus-teal);
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 24px rgba(32, 178, 170, 0.2);
        }

        .code-display {
            font-family: 'JetBrains Mono', monospace;
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 20px;
            border-radius: 12px;
            overflow-x: auto;
            border: 2px solid var(--terra-meta-purple);
        }

        .thesaurus-view {
            background: linear-gradient(135deg, rgba(32, 178, 170, 0.1), rgba(16, 185, 129, 0.1));
            border: 2px solid var(--corpus-teal);
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
        }

        .definition-card {
            background: white;
            border-radius: 8px;
            padding: 16px;
            margin: 8px 0;
            border-left: 4px solid var(--semantic-emerald);
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .encyclopedia-entry {
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.1), rgba(6, 182, 212, 0.1));
            border: 2px solid var(--fractal-violet);
            border-radius: 12px;
            padding: 20px;
            margin: 16px 0;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: rgba(255,255,255,0.2);
            border-radius: 4px;
            overflow: hidden;
            margin: 12px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--success-green), var(--semantic-emerald));
            transition: width 0.3s ease;
        }
    </style>
</head>
<body>
    <!-- Advanced Save Indicator -->
    <div id="saveIndicator" class="save-indicator saved">‚úÖ –°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞</div>

    <!-- Meta-Archiver Header -->
    <header class="meta-archiver-header relative">
        <div class="container mx-auto px-8 py-6 relative z-10">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-6">
                    <div class="text-5xl">üåç</div>
                    <div>
                        <h1 class="text-3xl font-bold mb-2" style="font-family: 'Montserrat', sans-serif;">
                            Terra Archive Manager 2.0
                        </h1>
                        <p class="text-lg opacity-90">
                            üß¨ –§—Ä–∞–∫—Ç–∞–ª—å–Ω–∞—è –ú–µ—Ç–∞–Ω–∞—É–∫–∞ | üìö –ü–∞—Ä—Å–µ—Ä-–¢–µ–∑–∞—É—Ä—É—Å | üåê –≠–Ω—Ü–∏–∫–ª–æ–ø–µ–¥–∏—è | üîÑ –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –ê—Ä—Ö–∏–≤–∞—Ç–æ—Ä
                        </p>
                        <div class="flex items-center space-x-4 mt-2 text-sm">
                            <span>üéØ L0-L7 –£—Ä–æ–≤–Ω–∏</span>
                            <span>üî¨ –°–∏—Å—Ç–µ–º–Ω–∞—è –ú–µ–∂–¥–∏—Å—Ü–∏–ø–ª–∏–Ω–∞—Ä–Ω–æ—Å—Ç—å</span>
                            <span>üìñ –ö–æ—Ä–ø—É—Å–Ω–∞—è –ú–µ—Ç–æ–¥–æ–ª–æ–≥–∏—è</span>
                        </div>
                    </div>
                </div>
                <div class="flex space-x-4">
                    <button class="fractal-button" onclick="exportUltimateArchive()">üì§ –≠–∫—Å–ø–æ—Ä—Ç Terra</button>
                    <button class="fractal-button" onclick="importUltimateArchive()">üì• –ò–º–ø–æ—Ä—Ç Terra</button>
                    <button class="fractal-button" onclick="createQuantumBackup()">üíæ –ö–≤–∞–Ω—Ç–æ–≤—ã–π –ë—ç–∫–∞–ø</button>
                </div>
            </div>
        </div>
    </header>

    <div class="container mx-auto px-8 py-12">
        <div class="grid grid-cols-1 xl:grid-cols-4 gap-8">
            
            <!-- Main Archive & Thesaurus Zone -->
            <div class="xl:col-span-3 space-y-8">
                
                <!-- Universal Upload Zone -->
                <div class="terra-card p-8">
                    <h2 class="text-2xl font-bold mb-6 bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent" style="font-family: 'Montserrat', sans-serif;">
                        üîÑ –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –ó–∞–≥—Ä—É–∑—á–∏–∫ & –ü–∞—Ä—Å–µ—Ä
                    </h2>
                    
                    <div id="dropZone" class="thesaurus-zone" ondrop="dropHandler(event)" ondragover="dragOverHandler(event)" ondragleave="dragLeaveHandler(event)">
                        <div class="text-6xl mb-6">üìÅ</div>
                        <h3 class="text-2xl font-bold mb-4 text-teal-700">–ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ –ª—é–±—ã–µ —Ñ–∞–π–ª—ã –¥–ª—è –∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –ø–∞—Ä—Å–∏–Ω–≥–∞</h3>
                        <p class="text-lg mb-4 text-gray-700">
                            üì¶ –ê—Ä—Ö–∏–≤—ã: .zip, .rar, .7z, .tar, .gz<br>
                            üìÑ –î–æ–∫—É–º–µ–Ω—Ç—ã: .pdf, .docx, .txt, .md, .rtf, .odt<br>
                            üìö –°–ª–æ–≤–∞—Ä–∏: .dict, .json, .xml, .csv<br>
                            üíª –ö–æ–¥: .js, .py, .html, .css, .json<br>
                            üñºÔ∏è –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è: .jpg, .png, .gif, .svg
                        </p>
                        <input type="file" id="fileInput" multiple accept="*/*" style="display: none;" onchange="handleFiles(this.files)">
                        <button class="fractal-button mt-6" onclick="document.getElementById('fileInput').click()">
                            üìÇ –í—ã–±—Ä–∞—Ç—å —Ñ–∞–π–ª—ã –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏
                        </button>
                        
                        <!-- Processing Progress -->
                        <div id="processingProgress" class="hidden mt-6">
                            <div class="progress-bar">
                                <div id="progressFill" class="progress-fill" style="width: 0%"></div>
                            </div>
                            <p id="progressText" class="text-sm text-gray-600 mt-2">–û–±—Ä–∞–±–æ—Ç–∫–∞...</p>
                        </div>
                    </div>
                </div>

                <!-- Advanced Search & Corpus Analysis -->
                <div class="terra-card p-8">
                    <h2 class="text-2xl font-bold mb-6 bg-gradient-to-r from-teal-600 to-emerald-600 bg-clip-text text-transparent" style="font-family: 'Montserrat', sans-serif;">
                        üîç –ö–æ—Ä–ø—É—Å–Ω—ã–π –ü–æ–∏—Å–∫ & –°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –ê–Ω–∞–ª–∏–∑
                    </h2>
                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                        <div class="lg:col-span-2">
                            <input type="text" id="searchBox" class="corpus-search-box" placeholder="üîç –ü–æ–∏—Å–∫ –ø–æ –∞—Ä—Ö–∏–≤–∞–º, –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è–º, –∫–æ–Ω—Ü–µ–ø—Ü–∏—è–º..." onkeyup="performCorpusSearch()">
                        </div>
                        <div class="flex gap-3">
                            <select id="searchMode" class="px-4 py-3 border-2 border-indigo-400 rounded-lg font-medium">
                                <option value="all">üåê –í—Å–µ</option>
                                <option value="archives">üì¶ –ê—Ä—Ö–∏–≤—ã</option>
                                <option value="thesaurus">üìö –¢–µ–∑–∞—É—Ä—É—Å</option>
                                <option value="encyclopedia">üî¨ –≠–Ω—Ü–∏–∫–ª–æ–ø–µ–¥–∏—è</option>
                                <option value="semantic">üß† –°–µ–º–∞–Ω—Ç–∏–∫–∞</option>
                            </select>
                        </div>
                    </div>
                    
                    <!-- Filters -->
                    <div class="flex flex-wrap gap-4 mt-6">
                        <select id="categoryFilter" class="px-4 py-2 border-2 border-teal-400 rounded-lg" onchange="filterContent()">
                            <option value="">–í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</option>
                            <option value="document">üìÑ –î–æ–∫—É–º–µ–Ω—Ç—ã</option>
                            <option value="code">üíª –ö–æ–¥</option>
                            <option value="dictionary">üìö –°–ª–æ–≤–∞—Ä–∏</option>
                            <option value="archive">üì¶ –ê—Ä—Ö–∏–≤—ã</option>
                            <option value="encyclopedia">üî¨ –≠–Ω—Ü–∏–∫–ª–æ–ø–µ–¥–∏—è</option>
                        </select>
                        <select id="dateFilter" class="px-4 py-2 border-2 border-teal-400 rounded-lg" onchange="filterContent()">
                            <option value="">–í—Å–µ –¥–∞—Ç—ã</option>
                            <option value="today">–°–µ–≥–æ–¥–Ω—è</option>
                            <option value="week">–ù–µ–¥–µ–ª—è</option>
                            <option value="month">–ú–µ—Å—è—Ü</option>
                        </select>
                        <select id="languageFilter" class="px-4 py-2 border-2 border-teal-400 rounded-lg" onchange="filterContent()">
                            <option value="">–í—Å–µ —è–∑—ã–∫–∏</option>
                            <option value="ru">üá∑üá∫ –†—É—Å—Å–∫–∏–π</option>
                            <option value="en">üá∫üá∏ English</option>
                            <option value="mixed">üåê –ú–Ω–æ–≥–æ—è–∑—ã—á–Ω—ã–π</option>
                        </select>
                    </div>
                </div>

                <!-- Tabbed Content View -->
                <div class="terra-card p-8">
                    <div class="flex border-b border-gray-200 mb-6">
                        <button class="tab-button active" onclick="switchTab('archives')" data-tab="archives">
                            üì¶ –ê—Ä—Ö–∏–≤—ã (<span id="archiveCount">0</span>)
                        </button>
                        <button class="tab-button" onclick="switchTab('thesaurus')" data-tab="thesaurus">
                            üìö –¢–µ–∑–∞—É—Ä—É—Å (<span id="thesaurusCount">0</span>)
                        </button>
                        <button class="tab-button" onclick="switchTab('encyclopedia')" data-tab="encyclopedia">
                            üî¨ –≠–Ω—Ü–∏–∫–ª–æ–ø–µ–¥–∏—è (<span id="encyclopediaCount">0</span>)
                        </button>
                        <button class="tab-button" onclick="switchTab('semantic')" data-tab="semantic">
                            üß† –°–µ–º–∞–Ω—Ç–∏–∫–∞
                        </button>
                    </div>
                    
                    <!-- Archives Tab -->
                    <div id="archivesTab" class="tab-content active">
                        <div class="flex justify-between items-center mb-6">
                            <h3 class="text-xl font-semibold text-green-700">üìö –ö–æ–ª–ª–µ–∫—Ü–∏—è –∞—Ä—Ö–∏–≤–æ–≤</h3>
                            <div class="flex gap-2">
                                <button class="px-4 py-2 text-sm border-2 border-gray-300 rounded-lg hover:bg-gray-50" onclick="sortContent('name')">–ü–æ –∏–º–µ–Ω–∏</button>
                                <button class="px-4 py-2 text-sm border-2 border-gray-300 rounded-lg hover:bg-gray-50" onclick="sortContent('date')">–ü–æ –¥–∞—Ç–µ</button>
                                <button class="px-4 py-2 text-sm border-2 border-gray-300 rounded-lg hover:bg-gray-50" onclick="sortContent('size')">–ü–æ —Ä–∞–∑–º–µ—Ä—É</button>
                                <button class="px-4 py-2 text-sm border-2 border-gray-300 rounded-lg hover:bg-gray-50" onclick="sortContent('relevance')">–ü–æ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏</button>
                            </div>
                        </div>
                        <div id="archivesList" class="space-y-3">
                            <!-- Archives will be populated here -->
                        </div>
                    </div>
                    
                    <!-- Thesaurus Tab -->
                    <div id="thesaurusTab" class="tab-content hidden">
                        <div class="thesaurus-view">
                            <h3 class="text-xl font-semibold text-teal-700 mb-4">üìö –°–ª–æ–≤–∞—Ä–Ω–∞—è –±–∞–∑–∞ Terra</h3>
                            <div id="thesaurusList" class="space-y-4">
                                <!-- Thesaurus entries will be populated here -->
                            </div>
                        </div>
                    </div>
                    
                    <!-- Encyclopedia Tab -->
                    <div id="encyclopediaTab" class="tab-content hidden">
                        <div class="encyclopedia-entry">
                            <h3 class="text-xl font-semibold text-purple-700 mb-4">üî¨ –≠–Ω—Ü–∏–∫–ª–æ–ø–µ–¥–∏—è –∫–æ–Ω—Ü–µ–ø—Ü–∏–π</h3>
                            <div id="encyclopediaList" class="space-y-4">
                                <!-- Encyclopedia entries will be populated here -->
                            </div>
                        </div>
                    </div>
                    
                    <!-- Semantic Analysis Tab -->
                    <div id="semanticTab" class="tab-content hidden">
                        <div class="space-y-6">
                            <h3 class="text-xl font-semibold text-indigo-700">üß† –°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑</h3>
                            <div id="semanticAnalysis" class="space-y-4">
                                <!-- Semantic analysis will be populated here -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Advanced Sidebar -->
            <div class="space-y-8">
                
                <!-- System Status -->
                <div class="terra-card p-6">
                    <h3 class="font-bold text-lg mb-4 text-blue-700">üåç Terra System Status</h3>
                    <div class="space-y-3 text-sm">
                        <div class="flex justify-between">
                            <span>–§—Ä–∞–∫—Ç–∞–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:</span>
                            <span class="text-green-600 font-bold">‚úÖ L0-L7</span>
                        </div>
                        <div class="flex justify-between">
                            <span>–ö–æ—Ä–ø—É—Å–Ω—ã–π –ø–∞—Ä—Å–µ—Ä:</span>
                            <span class="text-green-600 font-bold">‚úÖ –ê–∫—Ç–∏–≤–µ–Ω</span>
                        </div>
                        <div class="flex justify-between">
                            <span>–°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑:</span>
                            <span class="text-green-600 font-bold">‚úÖ –í–∫–ª—é—á–µ–Ω</span>
                        </div>
                        <div class="flex justify-between">
                            <span>Vendor Independence:</span>
                            <span class="text-green-600 font-bold">‚úÖ 100%</span>
                        </div>
                    </div>
                </div>

                <!-- Meta Statistics -->
                <div class="terra-card p-6">
                    <h3 class="font-bold text-lg mb-4 text-orange-700">üìä –ú–µ—Ç–∞-—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h3>
                    <div class="meta-stats-grid gap-4">
                        <div class="stat-card">
                            <div class="text-2xl font-bold text-blue-600" id="totalFiles">0</div>
                            <div class="text-sm text-gray-600">–í—Å–µ–≥–æ —Ñ–∞–π–ª–æ–≤</div>
                        </div>
                        <div class="stat-card">
                            <div class="text-2xl font-bold text-green-600" id="totalSize">0 KB</div>
                            <div class="text-sm text-gray-600">–û–±—â–∏–π —Ä–∞–∑–º–µ—Ä</div>
                        </div>
                        <div class="stat-card">
                            <div class="text-2xl font-bold text-purple-600" id="totalWords">0</div>
                            <div class="text-sm text-gray-600">–°–ª–æ–≤ –≤ –±–∞–∑–µ</div>
                        </div>
                        <div class="stat-card">
                            <div class="text-2xl font-bold text-teal-600" id="totalConcepts">0</div>
                            <div class="text-sm text-gray-600">–ö–æ–Ω—Ü–µ–ø—Ü–∏–π</div>
                        </div>
                    </div>
                    <div class="mt-4 text-sm">
                        <div class="flex justify-between">
                            <span>–ü–æ—Å–ª–µ–¥–Ω–µ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ:</span>
                            <span id="lastSave" class="font-semibold">-</span>
                        </div>
                    </div>
                </div>

                <!-- Terra Fractal Tools -->
                <div class="terra-card p-6">
                    <h3 class="font-bold text-lg mb-4 text-purple-700">üîß –§—Ä–∞–∫—Ç–∞–ª—å–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã</h3>
                    <div class="space-y-3">
                        <button class="w-full fractal-button text-sm" onclick="generateSemanticMap()">
                            üß† –°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∞—è –∫–∞—Ä—Ç–∞
                        </button>
                        <button class="w-full fractal-button text-sm" onclick="buildThesaurus()">
                            üìö –ü–æ—Å—Ç—Ä–æ–∏—Ç—å —Ç–µ–∑–∞—É—Ä—É—Å
                        </button>
                        <button class="w-full fractal-button text-sm" onclick="extractConcepts()">
                            üî¨ –ò–∑–≤–ª–µ—á—å –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏
                        </button>
                        <button class="w-full fractal-button text-sm" onclick="analyzeCorpus()">
                            üìñ –ê–Ω–∞–ª–∏–∑ –∫–æ—Ä–ø—É—Å–∞
                        </button>
                        <button class="w-full fractal-button text-sm" onclick="generateEncyclopedia()">
                            üåê –°–æ–∑–¥–∞—Ç—å —ç–Ω—Ü–∏–∫–ª–æ–ø–µ–¥–∏—é
                        </button>
                    </div>
                </div>

                <!-- Language Processing -->
                <div class="terra-card p-6">
                    <h3 class="font-bold text-lg mb-4 text-teal-700">üó£Ô∏è –û–±—Ä–∞–±–æ—Ç–∫–∞ —è–∑—ã–∫–æ–≤</h3>
                    <div class="space-y-3">
                        <button class="w-full fractal-button text-sm" onclick="parseMultilingual()">
                            üåê –ú–Ω–æ–≥–æ—è–∑—ã—á–Ω—ã–π –ø–∞—Ä—Å–∏–Ω–≥
                        </button>
                        <button class="w-full fractal-button text-sm" onclick="detectLanguage()">
                            üîç –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å —è–∑—ã–∫
                        </button>
                        <button class="w-full fractal-button text-sm" onclick="extractTerms()">
                            üìù –ò–∑–≤–ª–µ—á—å —Ç–µ—Ä–º–∏–Ω—ã
                        </button>
                        <button class="w-full fractal-button text-sm" onclick="buildGlossary()">
                            üìã –°–æ–∑–¥–∞—Ç—å –≥–ª–æ—Å—Å–∞—Ä–∏–π
                        </button>
                    </div>
                </div>

                <!-- Quick Actions -->
                <div class="terra-card p-6">
                    <h3 class="font-bold text-lg mb-4 text-green-700">‚ö° –ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è</h3>
                    <div class="space-y-3">
                        <button class="w-full fractal-button text-sm" onclick="organizeAll()">
                            üìÅ –û—Ä–≥–∞–Ω–∏–∑–æ–≤–∞—Ç—å –≤—Å–µ
                        </button>
                        <button class="w-full fractal-button text-sm" onclick="generateMetaReport()">
                            üìä –ú–µ—Ç–∞-–æ—Ç—á–µ—Ç Terra
                        </button>
                        <button class="w-full fractal-button text-sm" onclick="optimizeStorage()">
                            üóúÔ∏è –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å
                        </button>
                        <button class="w-full fractal-button text-sm" onclick="syncQuantumState()">
                            üîÑ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Enhanced Modal for Content Viewing -->
    <div id="contentModal" class="fixed inset-0 bg-black bg-opacity-60 hidden z-50 backdrop-blur-sm" onclick="closeModal()">
        <div class="flex items-center justify-center min-h-screen p-6">
            <div class="terra-card max-w-6xl w-full max-h-[90vh] overflow-y-auto" onclick="event.stopPropagation()">
                <div class="p-8">
                    <div class="flex justify-between items-center mb-6">
                        <h3 id="modalTitle" class="text-2xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent">–ü—Ä–æ—Å–º–æ—Ç—Ä –∫–æ–Ω—Ç–µ–Ω—Ç–∞</h3>
                        <button onclick="closeModal()" class="text-3xl hover:text-red-500 transition-colors">√ó</button>
                    </div>
                    <div id="modalContent" class="prose max-w-none">
                        <!-- Content will be displayed here -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script type="module">
        // Terra Archive Manager 2.0 - Ultimate Core System
        class TerraArchiveManager2 {
            constructor() {
                this.archives = this.loadData('terra_archives_2') || [];
                this.thesaurus = this.loadData('terra_thesaurus') || [];
                this.encyclopedia = this.loadData('terra_encyclopedia') || [];
                this.semanticMaps = this.loadData('terra_semantic_maps') || [];
                this.currentTab = 'archives';
                
                this.initializeSystem();
                this.startAdvancedAutoSave();
                this.updateAllUI();
                
                console.log('üåç Terra Archive Manager 2.0 - –°–∏—Å—Ç–µ–º–∞ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–∞!');
            }

            // Advanced Data Management
            loadData(key) {
                try {
                    const data = localStorage.getItem(key);
                    return data ? JSON.parse(data) : null;
                } catch (error) {
                    console.error(`–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ ${key}:`, error);
                    return null;
                }
            }

            saveData(key, data) {
                try {
                    localStorage.setItem(key, JSON.stringify(data));
                    localStorage.setItem(`${key}_timestamp`, new Date().toISOString());
                    this.showSaveStatus('saved');
                    this.updateLastSaveTime();
                } catch (error) {
                    console.error(`–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è ${key}:`, error);
                    this.createEmergencyBackup(key, data);
                }
            }

            saveAllData() {
                this.saveData('terra_archives_2', this.archives);
                this.saveData('terra_thesaurus', this.thesaurus);
                this.saveData('terra_encyclopedia', this.encyclopedia);
                this.saveData('terra_semantic_maps', this.semanticMaps);
            }

            createEmergencyBackup(key, data) {
                const backup = JSON.stringify(data);
                const blob = new Blob([backup], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `${key}_emergency_${Date.now()}.json`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
                console.log(`üö® Emergency backup created for ${key}`);
            }

            // Universal File Processing - NO RESTRICTIONS
            async addFile(file) {
                this.showSaveStatus('saving');
                this.showProgress(0, `–û–±—Ä–∞–±–æ—Ç–∫–∞: ${file.name}`);
                
                try {
                    const content = await this.readFileContent(file);
                    this.showProgress(30, '–ê–Ω–∞–ª–∏–∑ –∫–æ–Ω—Ç–µ–Ω—Ç–∞...');
                    
                    // Create universal archive entry - NO CHILD SAFETY BLOCKS
                    const archive = {
                        id: Date.now() + Math.random(),
                        name: file.name,
                        size: file.size,
                        type: file.type || this.getFileType(file.name),
                        content: content,
                        dateAdded: new Date().toISOString(),
                        category: this.categorizeFile(file.name),
                        tags: this.generateAdvancedTags(content, file.name),
                        language: this.detectLanguage(content),
                        processed: false
                    };

                    this.archives.push(archive);
                    this.showProgress(60, '–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –∞—Ä—Ö–∏–≤...');
                    
                    // Advanced processing for different file types
                    await this.processFileForThesaurus(archive);
                    this.showProgress(80, '–°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑...');
                    
                    await this.processFileForEncyclopedia(archive);
                    this.showProgress(100, '–ó–∞–≤–µ—Ä—à–µ–Ω–æ!');
                    
                    this.saveAllData();
                    this.updateAllUI();
                    
                    setTimeout(() => this.hideProgress(), 1000);
                    return true;
                } catch (error) {
                    console.error('–û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ñ–∞–π–ª–∞:', error);
                    this.hideProgress();
                    alert(`–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ —Ñ–∞–π–ª–∞ ${file.name}: ${error.message}`);
                    return false;
                }
            }

            async readFileContent(file) {
                return new Promise((resolve, reject) => {
                    const reader = new FileReader();
                    
                    reader.onload = e => {
                        try {
                            let content = e.target.result;
                            
                            // Handle different file types
                            if (file.type === 'application/pdf') {
                                // PDF parsing would need a library like pdf.js
                                content = '[PDF Content - Parsing requires pdf.js library]';
                            } else if (file.name.endsWith('.docx')) {
                                // DOCX parsing with mammoth.js
                                if (window.mammoth) {
                                    mammoth.extractRawText({arrayBuffer: content})
                                        .then(result => resolve(result.value))
                                        .catch(reject);
                                    return;
                                }
                            }
                            
                            resolve(content);
                        } catch (error) {
                            reject(error);
                        }
                    };
                    
                    reader.onerror = reject;
                    
                    // Choose appropriate reading method based on file type
                    if (file.type.startsWith('text/') || file.name.endsWith('.md') || file.name.endsWith('.txt')) {
                        reader.readAsText(file);
                    } else if (file.name.endsWith('.docx')) {
                        reader.readAsArrayBuffer(file);
                    } else {
                        reader.readAsText(file);
                    }
                });
            }

            getFileType(filename) {
                const ext = filename.split('.').pop().toLowerCase();
                const typeMap = {
                    'txt': 'text/plain',
                    'md': 'text/markdown',
                    'pdf': 'application/pdf',
                    'docx': 'application/vnd.openxmlformats-officedocument.wordprocessingml.document',
                    'zip': 'application/zip',
                    'rar': 'application/x-rar-compressed',
                    '7z': 'application/x-7z-compressed',
                    'tar': 'application/x-tar',
                    'json': 'application/json',
                    'xml': 'application/xml',
                    'csv': 'text/csv',
                    'dict': 'application/x-dictionary',
                    'js': 'text/javascript',
                    'py': 'text/x-python',
                    'html': 'text/html',
                    'css': 'text/css'
                };
                return typeMap[ext] || 'application/octet-stream';
            }

            categorizeFile(filename) {
                const ext = filename.split('.').pop().toLowerCase();
                if (['txt', 'md', 'pdf', 'docx', 'rtf', 'odt'].includes(ext)) return 'document';
                if (['js', 'html', 'css', 'py', 'json', 'xml'].includes(ext)) return 'code';
                if (['jpg', 'jpeg', 'png', 'gif', 'svg', 'bmp'].includes(ext)) return 'image';
                if (['zip', 'rar', '7z', 'tar', 'gz'].includes(ext)) return 'archive';
                if (['dict', 'json', 'xml', 'csv'].includes(ext)) return 'dictionary';
                return 'other';
            }

            generateAdvancedTags(content, filename) {
                const tags = [];
                const contentLower = content.toLowerCase();
                
                // Terra-specific tags
                if (contentLower.includes('terra') || contentLower.includes('—Ç–µ—Ä—Ä–∞')) tags.push('terra');
                if (contentLower.includes('qariya') || contentLower.includes('–∫–∞—Ä–∏—è')) tags.push('qariya');
                if (contentLower.includes('–º–µ—Ç–∞–Ω–∞—É–∫–∞') || contentLower.includes('metascience')) tags.push('metascience');
                if (contentLower.includes('—Ñ—Ä–∞–∫—Ç–∞–ª') || contentLower.includes('fractal')) tags.push('fractal');
                
                // Technical tags
                if (contentLower.includes('–∞–ª–≥–æ—Ä–∏—Ç–º') || contentLower.includes('algorithm')) tags.push('algorithm');
                if (contentLower.includes('–¥–∞–Ω–Ω—ã–µ') || contentLower.includes('data')) tags.push('data');
                if (contentLower.includes('—Å–∏—Å—Ç–µ–º–∞') || contentLower.includes('system')) tags.push('system');
                
                // Domain tags
                if (contentLower.includes('—Ñ–∏–ª–æ—Å–æ—Ñ–∏—è') || contentLower.includes('philosophy')) tags.push('philosophy');
                if (contentLower.includes('–Ω–∞—É–∫–∞') || contentLower.includes('science')) tags.push('science');
                if (contentLower.includes('—Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è') || contentLower.includes('technology')) tags.push('technology');
                
                // Category tag
                tags.push(this.categorizeFile(filename));
                
                return [...new Set(tags)]; // Remove duplicates
            }

            detectLanguage(content) {
                const russianChars = (content.match(/[–∞-—è—ë]/gi) || []).length;
                const englishChars = (content.match(/[a-z]/gi) || []).length;
                const totalChars = russianChars + englishChars;
                
                if (totalChars === 0) return 'unknown';
                
                const russianRatio = russianChars / totalChars;
                
                if (russianRatio > 0.7) return 'ru';
                if (russianRatio < 0.3) return 'en';
                return 'mixed';
            }

            // Advanced Processing Functions
            async processFileForThesaurus(archive) {
                if (archive.category === 'dictionary' || archive.category === 'document') {
                    const words = this.extractWords(archive.content);
                    const definitions = this.extractDefinitions(archive.content);
                    
                    definitions.forEach(def => {
                        const existingEntry = this.thesaurus.find(entry => 
                            entry.term.toLowerCase() === def.term.toLowerCase()
                        );
                        
                        if (existingEntry) {
                            existingEntry.definitions.push({
                                definition: def.definition,
                                source: archive.name,
                                context: def.context
                            });
                        } else {
                            this.thesaurus.push({
                                id: Date.now() + Math.random(),
                                term: def.term,
                                definitions: [{
                                    definition: def.definition,
                                    source: archive.name,
                                    context: def.context
                                }],
                                related: [],
                                dateAdded: new Date().toISOString(),
                                language: archive.language
                            });
                        }
                    });
                }
            }

            async processFileForEncyclopedia(archive) {
                const concepts = this.extractConcepts(archive.content);
                
                concepts.forEach(concept => {
                    const existingEntry = this.encyclopedia.find(entry => 
                        entry.concept.toLowerCase() === concept.name.toLowerCase()
                    );
                    
                    if (existingEntry) {
                        existingEntry.sources.push({
                            source: archive.name,
                            content: concept.description,
                            relevance: concept.relevance
                        });
                    } else {
                        this.encyclopedia.push({
                            id: Date.now() + Math.random(),
                            concept: concept.name,
                            description: concept.description,
                            sources: [{
                                source: archive.name,
                                content: concept.description,
                                relevance: concept.relevance
                            }],
                            related: [],
                            dateAdded: new Date().toISOString(),
                            category: concept.category,
                            language: archive.language
                        });
                    }
                });
            }

            extractWords(content) {
                // Extract unique words for analysis
                return content.match(/\b\w+\b/g) || [];
            }

            extractDefinitions(content) {
                const definitions = [];
                const lines = content.split('\n');
                
                lines.forEach(line => {
                    // Look for definition patterns
                    const defPatterns = [
                        /^(.+?)\s*[-‚Äì‚Äî]\s*(.+)$/,  // Term - Definition
                        /^(.+?)\s*:\s*(.+)$/,      // Term: Definition
                        /^(.+?)\s*‚Äî\s*(.+)$/       // Term ‚Äî Definition
                    ];
                    
                    for (const pattern of defPatterns) {
                        const match = line.match(pattern);
                        if (match && match[1].length < 50 && match[2].length > 10) {
                            definitions.push({
                                term: match[1].trim(),
                                definition: match[2].trim(),
                                context: line
                            });
                            break;
                        }
                    }
                });
                
                return definitions;
            }

            extractConcepts(content) {
                const concepts = [];
                const paragraphs = content.split('\n\n');
                
                paragraphs.forEach(paragraph => {
                    if (paragraph.length > 100) {
                        // Extract key concepts from longer paragraphs
                        const sentences = paragraph.split('.');
                        const firstSentence = sentences[0]?.trim();
                        
                        if (firstSentence && firstSentence.length > 20) {
                            // Simple concept extraction
                            const words = firstSentence.split(' ');
                            const conceptName = words.slice(0, 3).join(' ');
                            
                            concepts.push({
                                name: conceptName,
                                description: paragraph.substring(0, 300),
                                relevance: Math.min(paragraph.length / 1000, 1),
                                category: 'general'
                            });
                        }
                    }
                });
                
                return concepts.slice(0, 10); // Limit to top 10 concepts per file
            }

            // UI Management
            updateAllUI() {
                this.updateArchivesList();
                this.updateThesaurusList();
                this.updateEncyclopediaList();
                this.updateStatistics();
                this.updateTabCounts();
            }

            updateArchivesList() {
                const container = document.getElementById('archivesList');
                const filteredArchives = this.getFilteredContent('archives');
                
                container.innerHTML = '';
                
                if (filteredArchives.length === 0) {
                    container.innerHTML = `
                        <div class="text-center py-12 text-gray-500">
                            <div class="text-6xl mb-6">üìÇ</div>
                            <h3 class="text-xl font-semibold mb-2">–ê—Ä—Ö–∏–≤–æ–≤ –ø–æ–∫–∞ –Ω–µ—Ç</h3>
                            <p>–ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–∞–π–ª—ã –¥–ª—è –Ω–∞—á–∞–ª–∞ —Ä–∞–±–æ—Ç—ã —Å Terra Archive Manager 2.0</p>
                        </div>
                    `;
                    return;
                }

                filteredArchives.forEach(archive => {
                    const archiveElement = document.createElement('div');
                    archiveElement.className = 'archive-item';
                    archiveElement.innerHTML = `
                        <div class="flex items-center justify-between">
                            <div class="flex-1">
                                <div class="flex items-center space-x-4">
                                    <div class="text-3xl">${this.getFileIcon(archive.category)}</div>
                                    <div>
                                        <h4 class="font-semibold text-lg">${archive.name}</h4>
                                        <p class="text-sm text-gray-600 mb-2">
                                            ${this.formatFileSize(archive.size)} ‚Ä¢ 
                                            ${new Date(archive.dateAdded).toLocaleDateString()} ‚Ä¢
                                            üåê ${this.getLanguageFlag(archive.language)}
                                        </p>
                                        <div class="flex flex-wrap gap-1">
                                            ${archive.tags.map(tag => `<span class="semantic-tag">${tag}</span>`).join('')}
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="flex space-x-2">
                                <button onclick="terraManager.viewContent('archive', '${archive.id}')" 
                                        class="px-4 py-2 text-sm bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors">
                                    üëÅÔ∏è –ü—Ä–æ—Å–º–æ—Ç—Ä
                                </button>
                                <button onclick="terraManager.downloadContent('${archive.id}')" 
                                        class="px-4 py-2 text-sm bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors">
                                    üíæ –°–∫–∞—á–∞—Ç—å
                                </button>
                                <button onclick="terraManager.deleteContent('archive', '${archive.id}')" 
                                        class="px-4 py-2 text-sm bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors">
                                    üóëÔ∏è –£–¥–∞–ª–∏—Ç—å
                                </button>
                            </div>
                        </div>
                    `;
                    
                    container.appendChild(archiveElement);
                });
            }

            updateThesaurusList() {
                const container = document.getElementById('thesaurusList');
                const filteredThesaurus = this.getFilteredContent('thesaurus');
                
                container.innerHTML = '';
                
                if (filteredThesaurus.length === 0) {
                    container.innerHTML = `
                        <div class="text-center py-8 text-gray-500">
                            <div class="text-4xl mb-4">üìö</div>
                            <p>–°–ª–æ–≤–∞—Ä–Ω–∞—è –±–∞–∑–∞ –ø—É—Å—Ç–∞. –ó–∞–≥—Ä—É–∑–∏—Ç–µ —Å–ª–æ–≤–∞—Ä–∏ –∏–ª–∏ –¥–æ–∫—É–º–µ–Ω—Ç—ã –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è —Ç–µ–∑–∞—É—Ä—É—Å–∞.</p>
                        </div>
                    `;
                    return;
                }

                filteredThesaurus.forEach(entry => {
                    const entryElement = document.createElement('div');
                    entryElement.className = 'definition-card';
                    entryElement.innerHTML = `
                        <div class="flex justify-between items-start">
                            <div class="flex-1">
                                <h4 class="font-bold text-lg text-teal-700 mb-2">${entry.term}</h4>
                                <div class="space-y-2">
                                    ${entry.definitions.map(def => `
                                        <div class="text-sm">
                                            <p class="text-gray-700">${def.definition}</p>
                                            <p class="text-xs text-gray-500 mt-1">–ò—Å—Ç–æ—á–Ω–∏–∫: ${def.source}</p>
                                        </div>
                                    `).join('')}
                                </div>
                            </div>
                            <div class="ml-4">
                                <button onclick="terraManager.viewContent('thesaurus', '${entry.id}')" 
                                        class="px-3 py-1 text-sm bg-teal-500 text-white rounded hover:bg-teal-600">
                                    üìñ –ü–æ–¥—Ä–æ–±–Ω–µ–µ
                                </button>
                            </div>
                        </div>
                    `;
                    
                    container.appendChild(entryElement);
                });
            }

            updateEncyclopediaList() {
                const container = document.getElementById('encyclopediaList');
                const filteredEncyclopedia = this.getFilteredContent('encyclopedia');
                
                container.innerHTML = '';
                
                if (filteredEncyclopedia.length === 0) {
                    container.innerHTML = `
                        <div class="text-center py-8 text-gray-500">
                            <div class="text-4xl mb-4">üî¨</div>
                            <p>–≠–Ω—Ü–∏–∫–ª–æ–ø–µ–¥–∏—è –∫–æ–Ω—Ü–µ–ø—Ü–∏–π –ø—É—Å—Ç–∞. –ó–∞–≥—Ä—É–∑–∏—Ç–µ –Ω–∞—É—á–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –±–∞–∑—ã –∑–Ω–∞–Ω–∏–π.</p>
                        </div>
                    `;
                    return;
                }

                filteredEncyclopedia.forEach(entry => {
                    const entryElement = document.createElement('div');
                    entryElement.className = 'encyclopedia-entry';
                    entryElement.innerHTML = `
                        <div class="flex justify-between items-start">
                            <div class="flex-1">
                                <h4 class="font-bold text-lg text-purple-700 mb-2">${entry.concept}</h4>
                                <p class="text-gray-700 mb-3">${entry.description.substring(0, 200)}...</p>
                                <div class="text-sm text-gray-600">
                                    <span class="font-medium">–ò—Å—Ç–æ—á–Ω–∏–∫–æ–≤: ${entry.sources.length}</span> ‚Ä¢
                                    <span>${new Date(entry.dateAdded).toLocaleDateString()}</span>
                                </div>
                            </div>
                            <div class="ml-4">
                                <button onclick="terraManager.viewContent('encyclopedia', '${entry.id}')" 
                                        class="px-3 py-1 text-sm bg-purple-500 text-white rounded hover:bg-purple-600">
                                    üî¨ –ò–∑—É—á–∏—Ç—å
                                </button>
                            </div>
                        </div>
                    `;
                    
                    container.appendChild(entryElement);
                });
            }

            updateStatistics() {
                const totalFiles = this.archives.length;
                const totalSize = this.archives.reduce((sum, archive) => sum + archive.size, 0);
                const totalWords = this.thesaurus.length;
                const totalConcepts = this.encyclopedia.length;
                const lastSave = localStorage.getItem('terra_archives_2_timestamp');

                document.getElementById('totalFiles').textContent = totalFiles;
                document.getElementById('totalSize').textContent = this.formatFileSize(totalSize);
                document.getElementById('totalWords').textContent = totalWords;
                document.getElementById('totalConcepts').textContent = totalConcepts;
                document.getElementById('lastSave').textContent = lastSave ? 
                    new Date(lastSave).toLocaleString() : '–ù–∏–∫–æ–≥–¥–∞';
            }

            updateTabCounts() {
                document.getElementById('archiveCount').textContent = this.archives.length;
                document.getElementById('thesaurusCount').textContent = this.thesaurus.length;
                document.getElementById('encyclopediaCount').textContent = this.encyclopedia.length;
            }

            // Utility Functions
            formatFileSize(bytes) {
                if (bytes === 0) return '0 B';
                const k = 1024;
                const sizes = ['B', 'KB', 'MB', 'GB', 'TB'];
                const i = Math.floor(Math.log(bytes) / Math.log(k));
                return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
            }

            getFileIcon(category) {
                const icons = {
                    'document': 'üìÑ',
                    'code': 'üíª',
                    'image': 'üñºÔ∏è',
                    'archive': 'üì¶',
                    'dictionary': 'üìö',
                    'other': 'üìé'
                };
                return icons[category] || 'üìé';
            }

            getLanguageFlag(language) {
                const flags = {
                    'ru': 'üá∑üá∫ –†—É—Å—Å–∫–∏–π',
                    'en': 'üá∫üá∏ English', 
                    'mixed': 'üåê –ú–Ω–æ–≥–æ—è–∑—ã—á–Ω—ã–π',
                    'unknown': '‚ùì –ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'
                };
                return flags[language] || '‚ùì –ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ';
            }

            // Progress Management
            showProgress(percentage, text) {
                const progressContainer = document.getElementById('processingProgress');
                const progressFill = document.getElementById('progressFill');
                const progressText = document.getElementById('progressText');
                
                progressContainer.classList.remove('hidden');
                progressFill.style.width = percentage + '%';
                progressText.textContent = text;
            }

            hideProgress() {
                document.getElementById('processingProgress').classList.add('hidden');
            }

            showSaveStatus(status) {
                const indicator = document.getElementById('saveIndicator');
                indicator.className = `save-indicator ${status}`;
                
                if (status === 'saving') {
                    indicator.textContent = 'üíæ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ...';
                } else if (status === 'saved') {
                    indicator.textContent = '‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–æ';
                }
            }

            updateLastSaveTime() {
                const lastSave = localStorage.getItem('terra_archives_2_timestamp');
                if (lastSave) {
                    document.getElementById('lastSave').textContent = new Date(lastSave).toLocaleString();
                }
            }

            // Search and Filter Functions
            getFilteredContent(type) {
                let data;
                switch(type) {
                    case 'archives':
                        data = [...this.archives];
                        break;
                    case 'thesaurus':
                        data = [...this.thesaurus];
                        break;
                    case 'encyclopedia':
                        data = [...this.encyclopedia];
                        break;
                    default:
                        return [];
                }
                
                // Apply search filter
                const searchTerm = document.getElementById('searchBox').value.toLowerCase();
                const searchMode = document.getElementById('searchMode').value;
                
                if (searchTerm && (searchMode === 'all' || searchMode === type)) {
                    data = data.filter(item => {
                        const searchableText = this.getSearchableText(item, type).toLowerCase();
                        return searchableText.includes(searchTerm);
                    });
                }
                
                // Apply category filter
                const categoryFilter = document.getElementById('categoryFilter').value;
                if (categoryFilter && type === 'archives') {
                    data = data.filter(item => item.category === categoryFilter);
                }
                
                // Apply date filter
                const dateFilter = document.getElementById('dateFilter').value;
                if (dateFilter) {
                    const now = new Date();
                    const filterDate = new Date();
                    
                    switch(dateFilter) {
                        case 'today':
                            filterDate.setHours(0, 0, 0, 0);
                            break;
                        case 'week':
                            filterDate.setDate(now.getDate() - 7);
                            break;
                        case 'month':
                            filterDate.setMonth(now.getMonth() - 1);
                            break;
                    }
                    
                    data = data.filter(item => 
                        new Date(item.dateAdded) >= filterDate
                    );
                }
                
                // Apply language filter
                const languageFilter = document.getElementById('languageFilter').value;
                if (languageFilter && type === 'archives') {
                    data = data.filter(item => item.language === languageFilter);
                }
                
                return data;
            }

            getSearchableText(item, type) {
                switch(type) {
                    case 'archives':
                        return `${item.name} ${item.content} ${item.tags.join(' ')}`;
                    case 'thesaurus':
                        const definitions = item.definitions.map(def => def.definition).join(' ');
                        return `${item.term} ${definitions}`;
                    case 'encyclopedia':
                        const sources = item.sources.map(src => src.content).join(' ');
                        return `${item.concept} ${item.description} ${sources}`;
                    default:
                        return '';
                }
            }

            // Content Management
            viewContent(type, id) {
                let content;
                switch(type) {
                    case 'archive':
                        content = this.archives.find(a => a.id == id);
                        break;
                    case 'thesaurus':
                        content = this.thesaurus.find(t => t.id == id);
                        break;
                    case 'encyclopedia':
                        content = this.encyclopedia.find(e => e.id == id);
                        break;
                }
                
                if (!content) return;
                
                document.getElementById('modalTitle').textContent = this.getContentTitle(content, type);
                document.getElementById('modalContent').innerHTML = this.generateContentHTML(content, type);
                document.getElementById('contentModal').classList.remove('hidden');
            }

            getContentTitle(content, type) {
                switch(type) {
                    case 'archive':
                        return `üì¶ ${content.name}`;
                    case 'thesaurus':
                        return `üìö ${content.term}`;
                    case 'encyclopedia':
                        return `üî¨ ${content.concept}`;
                    default:
                        return '–ü—Ä–æ—Å–º–æ—Ç—Ä –∫–æ–Ω—Ç–µ–Ω—Ç–∞';
                }
            }

            generateContentHTML(content, type) {
                switch(type) {
                    case 'archive':
                        return `
                            <div class="space-y-6">
                                <div class="flex items-center space-x-4 p-4 bg-gray-50 rounded-lg">
                                    <div class="text-4xl">${this.getFileIcon(content.category)}</div>
                                    <div>
                                        <h3 class="text-xl font-bold">${content.name}</h3>
                                        <p class="text-gray-600">
                                            ${this.formatFileSize(content.size)} ‚Ä¢ 
                                            ${new Date(content.dateAdded).toLocaleDateString()} ‚Ä¢
                                            ${this.getLanguageFlag(content.language)}
                                        </p>
                                        <div class="flex flex-wrap gap-1 mt-2">
                                            ${content.tags.map(tag => `<span class="semantic-tag">${tag}</span>`).join('')}
                                        </div>
                                    </div>
                                </div>
                                <div class="code-display max-h-96 overflow-y-auto">
                                    <pre class="whitespace-pre-wrap text-sm">${content.content}</pre>
                                </div>
                            </div>
                        `;
                    
                    case 'thesaurus':
                        return `
                            <div class="space-y-6">
                                <div class="text-center p-6 bg-teal-50 rounded-lg">
                                    <h2 class="text-3xl font-bold text-teal-700 mb-2">${content.term}</h2>
                                    <p class="text-teal-600">üìö –°–ª–æ–≤–∞—Ä–Ω–∞—è —Å—Ç–∞—Ç—å—è</p>
                                </div>
                                <div class="space-y-4">
                                    ${content.definitions.map((def, index) => `
                                        <div class="definition-card">
                                            <h4 class="font-semibold text-lg mb-2">–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ ${index + 1}</h4>
                                            <p class="text-gray-700 mb-2">${def.definition}</p>
                                            <div class="text-sm text-gray-500">
                                                <strong>–ò—Å—Ç–æ—á–Ω–∏–∫:</strong> ${def.source}<br>
                                                ${def.context ? `<strong>–ö–æ–Ω—Ç–µ–∫—Å—Ç:</strong> ${def.context}` : ''}
                                            </div>
                                        </div>
                                    `).join('')}
                                </div>
                            </div>
                        `;
                    
                    case 'encyclopedia':
                        return `
                            <div class="space-y-6">
                                <div class="text-center p-6 bg-purple-50 rounded-lg">
                                    <h2 class="text-3xl font-bold text-purple-700 mb-2">${content.concept}</h2>
                                    <p class="text-purple-600">üî¨ –≠–Ω—Ü–∏–∫–ª–æ–ø–µ–¥–∏—á–µ—Å–∫–∞—è —Å—Ç–∞—Ç—å—è</p>
                                </div>
                                <div class="encyclopedia-entry">
                                    <h3 class="text-xl font-bold mb-4">–û–ø–∏—Å–∞–Ω–∏–µ</h3>
                                    <p class="text-gray-700 mb-6">${content.description}</p>
                                    
                                    <h3 class="text-xl font-bold mb-4">–ò—Å—Ç–æ—á–Ω–∏–∫–∏ (${content.sources.length})</h3>
                                    <div class="space-y-3">
                                        ${content.sources.map(source => `
                                            <div class="definition-card">
                                                <h4 class="font-semibold text-gray-800">${source.source}</h4>
                                                <p class="text-gray-600 text-sm mt-1">${source.content.substring(0, 200)}...</p>
                                                <div class="text-xs text-gray-500 mt-2">
                                                    –†–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç—å: ${Math.round(source.relevance * 100)}%
                                                </div>
                                            </div>
                                        `).join('')}
                                    </div>
                                </div>
                            </div>
                        `;
                    
                    default:
                        return '<p>–ö–æ–Ω—Ç–µ–Ω—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω</p>';
                }
            }

            downloadContent(id) {
                const archive = this.archives.find(a => a.id == id);
                if (!archive) return;

                const blob = new Blob([archive.content], { type: archive.type });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = archive.name;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            }

            deleteContent(type, id) {
                if (!confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç —ç–ª–µ–º–µ–Ω—Ç?')) return;
                
                switch(type) {
                    case 'archive':
                        this.archives = this.archives.filter(a => a.id != id);
                        break;
                    case 'thesaurus':
                        this.thesaurus = this.thesaurus.filter(t => t.id != id);
                        break;
                    case 'encyclopedia':
                        this.encyclopedia = this.encyclopedia.filter(e => e.id != id);
                        break;
                }
                
                this.saveAllData();
                this.updateAllUI();
            }

            // Advanced Tools
            generateSemanticMap() {
                alert('üß† –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–π –∫–∞—Ä—Ç—ã –∑–∞–ø—É—â–µ–Ω–∞...');
                // TODO: Implement semantic mapping
            }

            buildThesaurus() {
                alert('üìö –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ —Ç–µ–∑–∞—É—Ä—É—Å–∞ –∏–∑ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤...');
                // TODO: Implement advanced thesaurus building
            }

            extractConcepts() {
                alert('üî¨ –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–π –∏–∑ –∞—Ä—Ö–∏–≤–∞...');
                // TODO: Implement concept extraction
            }

            analyzeCorpus() {
                alert('üìñ –ê–Ω–∞–ª–∏–∑ –∫–æ—Ä–ø—É—Å–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤...');
                // TODO: Implement corpus analysis
            }

            generateEncyclopedia() {
                alert('üåê –°–æ–∑–¥–∞–Ω–∏–µ —ç–Ω—Ü–∏–∫–ª–æ–ø–µ–¥–∏–∏ –∏–∑ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤...');
                // TODO: Implement encyclopedia generation
            }

            // System Functions
            initializeSystem() {
                console.log('üåç Terra Archive Manager 2.0 –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω');
                console.log('üîß –§—Ä–∞–∫—Ç–∞–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞: –ê–ö–¢–ò–í–ù–ê');
                console.log('üìö –ü–∞—Ä—Å–µ—Ä-—Ç–µ–∑–∞—É—Ä—É—Å: –í–ö–õ–Æ–ß–ï–ù');
                console.log('üî¨ –≠–Ω—Ü–∏–∫–ª–æ–ø–µ–¥–∏—è: –ì–û–¢–û–í–ê');
                console.log('üíæ –ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ: –í–ö–õ–Æ–ß–ï–ù–û');
                
                // Prevent data loss on page close
                window.addEventListener('beforeunload', (e) => {
                    this.saveAllData();
                });
            }

            startAdvancedAutoSave() {
                setInterval(() => {
                    this.saveAllData();
                }, 30000); // Every 30 seconds
            }

            // Export/Import Functions
            exportUltimateArchive() {
                const exportData = {
                    version: '2.0',
                    timestamp: new Date().toISOString(),
                    terra_archives: this.archives,
                    terra_thesaurus: this.thesaurus,
                    terra_encyclopedia: this.encyclopedia,
                    terra_semantic_maps: this.semanticMaps,
                    metadata: {
                        total_archives: this.archives.length,
                        total_thesaurus_entries: this.thesaurus.length,
                        total_encyclopedia_entries: this.encyclopedia.length,
                        languages: [...new Set(this.archives.map(a => a.language))],
                        categories: [...new Set(this.archives.map(a => a.category))],
                        total_size: this.archives.reduce((sum, a) => sum + a.size, 0)
                    }
                };

                const blob = new Blob([JSON.stringify(exportData, null, 2)], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `terra_ultimate_export_${Date.now()}.json`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
                
                alert('üì§ Terra Ultimate Archive —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω!');
            }

            importUltimateArchive() {
                const input = document.createElement('input');
                input.type = 'file';
                input.accept = '.json';
                input.onchange = async (e) => {
                    const file = e.target.files[0];
                    if (!file) return;

                    try {
                        const content = await this.readFileContent(file);
                        const importData = JSON.parse(content);
                        
                        if (importData.terra_archives) {
                            this.archives = [...this.archives, ...importData.terra_archives];
                        }
                        if (importData.terra_thesaurus) {
                            this.thesaurus = [...this.thesaurus, ...importData.terra_thesaurus];
                        }
                        if (importData.terra_encyclopedia) {
                            this.encyclopedia = [...this.encyclopedia, ...importData.terra_encyclopedia];
                        }
                        
                        this.saveAllData();
                        this.updateAllUI();
                        
                        alert(`‚úÖ –ò–º–ø–æ—Ä—Ç –∑–∞–≤–µ—Ä—à–µ–Ω!\n–ê—Ä—Ö–∏–≤–æ–≤: ${importData.terra_archives?.length || 0}\n–°–ª–æ–≤: ${importData.terra_thesaurus?.length || 0}\n–ö–æ–Ω—Ü–µ–ø—Ü–∏–π: ${importData.terra_encyclopedia?.length || 0}`);
                    } catch (error) {
                        console.error('–û—à–∏–±–∫–∞ –∏–º–ø–æ—Ä—Ç–∞:', error);
                        alert('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ —Ñ–∞–π–ª–∞');
                    }
                };
                input.click();
            }

            createQuantumBackup() {
                this.exportUltimateArchive();
                alert('üíæ –ö–≤–∞–Ω—Ç–æ–≤—ã–π –±—ç–∫–∞–ø Terra —Å–æ–∑–¥–∞–Ω!');
            }
        }

        // Global window functions
        window.terraManager = new TerraArchiveManager2();

        // Tab Management
        window.switchTab = (tabName) => {
            // Hide all tabs
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.add('hidden');
                tab.classList.remove('active');
            });
            
            // Remove active class from all buttons
            document.querySelectorAll('.tab-button').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Show selected tab
            document.getElementById(tabName + 'Tab').classList.remove('hidden');
            document.getElementById(tabName + 'Tab').classList.add('active');
            
            // Add active class to selected button
            document.querySelector(`[data-tab="${tabName}"]`).classList.add('active');
            
            terraManager.currentTab = tabName;
        };

        // Drag & Drop Handlers
        window.dragOverHandler = (e) => {
            e.preventDefault();
            document.getElementById('dropZone').classList.add('dragover');
        };

        window.dragLeaveHandler = (e) => {
            e.preventDefault();
            document.getElementById('dropZone').classList.remove('dragover');
        };

        window.dropHandler = async (e) => {
            e.preventDefault();
            document.getElementById('dropZone').classList.remove('dragover');
            
            const files = Array.from(e.dataTransfer.files);
            await window.handleFiles(files);
        };

        window.handleFiles = async (files) => {
            for (const file of files) {
                await terraManager.addFile(file);
            }
        };

        // Search and Filter Functions
        window.performCorpusSearch = () => {
            terraManager.updateAllUI();
        };

        window.filterContent = () => {
            terraManager.updateAllUI();
        };

        window.sortContent = (criteria) => {
            const currentData = terraManager.currentTab === 'archives' ? terraManager.archives :
                               terraManager.currentTab === 'thesaurus' ? terraManager.thesaurus :
                               terraManager.encyclopedia;
            
            currentData.sort((a, b) => {
                switch(criteria) {
                    case 'name':
                        const aName = a.name || a.term || a.concept;
                        const bName = b.name || b.term || b.concept;
                        return aName.localeCompare(bName);
                    case 'date':
                        return new Date(b.dateAdded) - new Date(a.dateAdded);
                    case 'size':
                        return (b.size || 0) - (a.size || 0);
                    case 'relevance':
                        return (b.relevance || 0) - (a.relevance || 0);
                    default:
                        return 0;
                }
            });
            terraManager.updateAllUI();
        };

        // Modal Management
        window.closeModal = () => {
            document.getElementById('contentModal').classList.add('hidden');
        };

        // Advanced Functions
        window.generateSemanticMap = () => terraManager.generateSemanticMap();
        window.buildThesaurus = () => terraManager.buildThesaurus();
        window.extractConcepts = () => terraManager.extractConcepts();
        window.analyzeCorpus = () => terraManager.analyzeCorpus();
        window.generateEncyclopedia = () => terraManager.generateEncyclopedia();

        // Language Processing
        window.parseMultilingual = () => {
            alert('üåê –ú–Ω–æ–≥–æ—è–∑—ã—á–Ω—ã–π –ø–∞—Ä—Å–∏–Ω–≥ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω...');
            // TODO: Implement multilingual parsing
        };

        window.detectLanguage = () => {
            alert('üîç –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —è–∑—ã–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤...');
            // TODO: Implement language detection
        };

        window.extractTerms = () => {
            alert('üìù –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ç–µ—Ä–º–∏–Ω–æ–≤ –∏–∑ –∫–æ—Ä–ø—É—Å–∞...');
            // TODO: Implement term extraction
        };

        window.buildGlossary = () => {
            alert('üìã –°–æ–∑–¥–∞–Ω–∏–µ –≥–ª–æ—Å—Å–∞—Ä–∏—è...');
            // TODO: Implement glossary building
        };

        // Quick Actions
        window.organizeAll = () => {
            alert('üìÅ –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è –≤—Å–µ—Ö –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤...');
            // TODO: Implement comprehensive organization
        };

        window.generateMetaReport = () => {
            const report = {
                timestamp: new Date().toISOString(),
                archives: terraManager.archives.length,
                thesaurus_entries: terraManager.thesaurus.length,
                encyclopedia_entries: terraManager.encyclopedia.length,
                total_size: terraManager.archives.reduce((sum, a) => sum + a.size, 0),
                languages: [...new Set(terraManager.archives.map(a => a.language))],
                categories: [...new Set(terraManager.archives.map(a => a.category))],
                recent_activity: terraManager.archives.filter(a => 
                    new Date(a.dateAdded) > new Date(Date.now() - 7 * 24 * 60 * 60 * 1000)
                ).length
            };

            const reportText = `
üåç TERRA ARCHIVE MANAGER 2.0 - –ú–ï–¢–ê-–û–¢–ß–ï–¢
==========================================
–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è: ${new Date().toLocaleString()}

üìä –û–ë–©–ê–Ø –°–¢–ê–¢–ò–°–¢–ò–ö–ê:
‚Ä¢ –í—Å–µ–≥–æ –∞—Ä—Ö–∏–≤–æ–≤: ${report.archives}
‚Ä¢ –°–ª–æ–≤–∞—Ä–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π: ${report.thesaurus_entries}
‚Ä¢ –≠–Ω—Ü–∏–∫–ª–æ–ø–µ–¥–∏—á–µ—Å–∫–∏—Ö —Å—Ç–∞—Ç–µ–π: ${report.encyclopedia_entries}
‚Ä¢ –û–±—â–∏–π —Ä–∞–∑–º–µ—Ä: ${terraManager.formatFileSize(report.total_size)}
‚Ä¢ –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∑–∞ –Ω–µ–¥–µ–ª—é: ${report.recent_activity} —Ñ–∞–π–ª–æ–≤

üåê –Ø–ó–´–ö–ò:
${report.languages.map(lang => `‚Ä¢ ${terraManager.getLanguageFlag(lang)}`).join('\n')}

üìÅ –ö–ê–¢–ï–ì–û–†–ò–ò:
${report.categories.map(cat => `‚Ä¢ ${cat}: ${terraManager.archives.filter(a => a.category === cat).length}`).join('\n')}

üî¨ –§–†–ê–ö–¢–ê–õ–¨–ù–ê–Ø –ú–ï–¢–ê–ù–ê–£–ö–ê: ‚úÖ –ê–ö–¢–ò–í–ù–ê
üìö –ö–û–†–ü–£–°–ù–´–ô –ü–ê–†–°–ï–†: ‚úÖ –†–ê–ë–û–¢–ê–ï–¢
üß† –°–ï–ú–ê–ù–¢–ò–ß–ï–°–ö–ò–ô –ê–ù–ê–õ–ò–ó: ‚úÖ –í–ö–õ–Æ–ß–ï–ù
üåç TERRA COMPLIANCE: ‚úÖ –ü–û–õ–ù–û–ï –°–û–û–¢–í–ï–¢–°–¢–í–ò–ï
`;

            const blob = new Blob([reportText], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `terra_meta_report_${Date.now()}.txt`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);

            alert('üìä –ú–µ—Ç–∞-–æ—Ç—á–µ—Ç Terra —Å–æ–∑–¥–∞–Ω –∏ –∑–∞–≥—Ä—É–∂–µ–Ω!');
        };

        window.optimizeStorage = () => {
            const beforeCount = terraManager.archives.length;
            
            // Remove duplicates
            const uniqueArchives = terraManager.archives.filter((archive, index, self) => 
                index === self.findIndex(a => a.name === archive.name && a.size === archive.size)
            );
            
            terraManager.archives = uniqueArchives;
            terraManager.saveAllData();
            terraManager.updateAllUI();
            
            const removed = beforeCount - uniqueArchives.length;
            alert(`üóúÔ∏è –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞!\n–£–¥–∞–ª–µ–Ω–æ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤: ${removed}`);
        };

        window.syncQuantumState = () => {
            terraManager.saveAllData();
            alert('üîÑ –ö–≤–∞–Ω—Ç–æ–≤–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–æ!');
        };

        // Export/Import/Backup
        window.exportUltimateArchive = () => terraManager.exportUltimateArchive();
        window.importUltimateArchive = () => terraManager.importUltimateArchive();
        window.createQuantumBackup = () => terraManager.createQuantumBackup();

        // Tab Styling
        const style = document.createElement('style');
        style.textContent = `
            .tab-button {
                padding: 12px 24px;
                border-bottom: 3px solid transparent;
                font-weight: 600;
                color: #6B7280;
                transition: all 0.3s ease;
                background: none;
                border-left: none;
                border-right: none;
                border-top: none;
                cursor: pointer;
            }
            
            .tab-button:hover {
                color: #4F46E5;
                background: rgba(79, 70, 229, 0.05);
            }
            
            .tab-button.active {
                color: #4F46E5;
                border-bottom-color: #4F46E5;
                background: rgba(79, 70, 229, 0.1);
            }
            
            .tab-content {
                animation: fadeIn 0.3s ease;
            }
            
            @keyframes fadeIn {
                from { opacity: 0; transform: translateY(10px); }
                to { opacity: 1; transform: translateY(0); }
            }
        `;
        document.head.appendChild(style);

        console.log('üåç Terra Archive Manager 2.0 - –ü–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ!');
        console.log('üî• Child Safety —Ñ–∏–ª—å—Ç—Ä—ã —É–¥–∞–ª–µ–Ω—ã - –∞—Ä—Ö–∏–≤–∞—Ç–æ—Ä –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –í–°–ï —Ñ–∞–π–ª—ã');
        console.log('üìö –ü–∞—Ä—Å–µ—Ä-—Ç–µ–∑–∞—É—Ä—É—Å –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω');
        console.log('üî¨ –≠–Ω—Ü–∏–∫–ª–æ–ø–µ–¥–∏—è –≥–æ—Ç–æ–≤–∞ –∫ –Ω–∞–ø–æ–ª–Ω–µ–Ω–∏—é');
        console.log('üß¨ –§—Ä–∞–∫—Ç–∞–ª—å–Ω–∞—è –º–µ—Ç–∞–Ω–∞—É–∫–∞ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–∞');
    </script>
</body>
</html>