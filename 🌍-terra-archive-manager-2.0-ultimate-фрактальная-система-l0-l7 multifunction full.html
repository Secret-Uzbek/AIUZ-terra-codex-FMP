<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üåç Terra Archive Manager 2.0 Ultimate - O'zbek-Deutsch Lug'at / –£–∑–±–µ–∫—Å–∫–æ-–ù–µ–º–µ—Ü–∫–∏–π –°–ª–æ–≤–∞—Ä—å</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.2.19/tailwind.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mammoth/1.4.21/mammoth.browser.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Montserrat:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <style>
        /* Terra Brand Book v2.0 - –§—Ä–∞–∫—Ç–∞–ª—å–Ω–∞—è –ú–µ—Ç–∞–Ω–∞—É–∫–∞ –ü–∞–ª–∏—Ç—Ä–∞ */
        :root {
            /* L0 - –û—Å–Ω–æ–≤–∞ (–ù–µ–π—Ä–æ-–°–∏–º–±–∏–æ–∑) */
            --terra-neural-green: #2E8B57;
            --terra-quantum-blue: #4A90E2;
            --terra-bio-orange: #FF8C42;
            --terra-meta-purple: #7B66DC;
            
            /* L1 - –°–∏—Å—Ç–µ–º–Ω–∞—è –ú–µ–∂–¥–∏—Å—Ü–∏–ø–ª–∏–Ω–∞—Ä–Ω–æ—Å—Ç—å */
            --soft-gray: #F5F5F5;
            --deep-gray: #2C3E50;
            --success-green: #27AE60;
            --warning-amber: #F39C12;
            --error-crimson: #E74C3C;
            
            /* L2 - –ö–æ—Ä–ø—É—Å–Ω–∞—è –ú–µ—Ç–æ–¥–æ–ª–æ–≥–∏—è */
            --corpus-teal: #20B2AA;
            --lexicon-indigo: #6366F1;
            --semantic-emerald: #10B981;
            
            /* L3 - –§—Ä–∞–∫—Ç–∞–ª—å–Ω–∞—è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ */
            --fractal-violet: #8B5CF6;
            --recursive-cyan: #06B6D4;
            --holistic-rose: #F43F5E;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, var(--soft-gray) 0%, #E8F4FD 100%);
            margin: 0;
            padding: 0;
        }

        .terra-card {
            background: white;
            border-radius: 16px;
            box-shadow: 0 8px 24px rgba(0,0,0,0.12);
            border: 2px solid transparent;
            background-image: linear-gradient(white, white), 
                             linear-gradient(45deg, var(--terra-quantum-blue), var(--terra-meta-purple));
            background-origin: border-box;
            background-clip: content-box, border-box;
        }

        .fractal-button {
            background: linear-gradient(135deg, var(--terra-quantum-blue), var(--terra-meta-purple));
            color: white;
            border: none;
            padding: 14px 28px;
            border-radius: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.25, 0.8, 0.25, 1);
            font-family: 'Montserrat', sans-serif;
            position: relative;
            overflow: hidden;
        }

        .fractal-button:hover {
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 12px 36px rgba(75, 144, 226, 0.4);
        }

        .fractal-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s;
        }

        .fractal-button:hover::before {
            left: 100%;
        }

        .meta-archiver-header {
            background: linear-gradient(135deg, var(--terra-neural-green), var(--terra-quantum-blue));
            color: white;
            border-radius: 0;
            padding: 24px 0;
            position: relative;
            overflow: hidden;
        }

        .meta-archiver-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="fractal" patternUnits="userSpaceOnUse" width="10" height="10"><circle cx="5" cy="5" r="1" fill="rgba(255,255,255,0.1)"/></pattern></defs><rect width="100" height="100" fill="url(%23fractal)"/></svg>');
            opacity: 0.3;
        }

        .thesaurus-zone {
            border: 3px dashed var(--corpus-teal);
            border-radius: 16px;
            padding: 40px;
            text-align: center;
            background: linear-gradient(135deg, rgba(32, 178, 170, 0.05), rgba(16, 185, 129, 0.05));
            transition: all 0.4s ease;
            position: relative;
        }

        .thesaurus-zone.dragover {
            background: linear-gradient(135deg, rgba(32, 178, 170, 0.15), rgba(16, 185, 129, 0.15));
            border-color: var(--semantic-emerald);
            transform: scale(1.02);
        }

        .archive-item {
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 12px;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.25, 0.8, 0.25, 1);
            border-left: 6px solid var(--terra-neural-green);
            background: linear-gradient(135deg, rgba(255,255,255,0.9), rgba(248,250,252,0.9));
            backdrop-filter: blur(10px);
        }

        .archive-item:hover {
            background: linear-gradient(135deg, rgba(46, 139, 87, 0.1), rgba(75, 144, 226, 0.05));
            transform: translateX(8px) translateY(-2px);
            box-shadow: 0 8px 24px rgba(46, 139, 87, 0.2);
        }

        .corpus-search-box {
            width: 100%;
            padding: 16px 20px;
            border: 3px solid var(--lexicon-indigo);
            border-radius: 12px;
            font-size: 16px;
            font-family: 'Inter', sans-serif;
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
        }

        .corpus-search-box:focus {
            outline: none;
            border-color: var(--semantic-emerald);
            box-shadow: 0 0 0 4px rgba(16, 185, 129, 0.1);
        }

        .semantic-tag {
            display: inline-block;
            background: linear-gradient(135deg, var(--fractal-violet), var(--recursive-cyan));
            color: white;
            padding: 6px 16px;
            border-radius: 24px;
            font-size: 12px;
            font-weight: 500;
            margin: 4px;
            transition: all 0.3s ease;
        }

        .semantic-tag:hover {
            transform: scale(1.1);
            box-shadow: 0 4px 12px rgba(139, 92, 246, 0.3);
        }

        .save-indicator {
            position: fixed;
            top: 24px;
            right: 24px;
            padding: 12px 20px;
            border-radius: 12px;
            font-weight: 600;
            z-index: 1000;
            backdrop-filter: blur(10px);
            border: 2px solid rgba(255,255,255,0.2);
        }

        .save-indicator.saving {
            background: linear-gradient(135deg, var(--warning-amber), #FFA500);
            color: white;
        }

        .save-indicator.saved {
            background: linear-gradient(135deg, var(--success-green), var(--semantic-emerald));
            color: white;
        }

        .meta-stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }

        .stat-card {
            background: linear-gradient(135deg, rgba(255,255,255,0.9), rgba(248,250,252,0.9));
            padding: 20px;
            border-radius: 12px;
            border-left: 4px solid var(--corpus-teal);
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 24px rgba(32, 178, 170, 0.2);
        }

        .code-display {
            font-family: 'JetBrains Mono', monospace;
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 20px;
            border-radius: 12px;
            overflow-x: auto;
            border: 2px solid var(--terra-meta-purple);
        }

        .thesaurus-view {
            background: linear-gradient(135deg, rgba(32, 178, 170, 0.1), rgba(16, 185, 129, 0.1));
            border: 2px solid var(--corpus-teal);
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
        }

        .definition-card {
            background: white;
            border-radius: 8px;
            padding: 16px;
            margin: 8px 0;
            border-left: 4px solid var(--semantic-emerald);
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .encyclopedia-entry {
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.1), rgba(6, 182, 212, 0.1));
            border: 2px solid var(--fractal-violet);
            border-radius: 12px;
            padding: 20px;
            margin: 16px 0;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: rgba(255,255,255,0.2);
            border-radius: 4px;
            overflow: hidden;
            margin: 12px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--success-green), var(--semantic-emerald));
            transition: width 0.3s ease;
        }

        .system-level-indicator {
            position: fixed;
            top: 24px;
            left: 24px;
            padding: 8px 16px;
            border-radius: 24px;
            font-size: 12px;
            font-weight: 700;
            z-index: 1000;
            backdrop-filter: blur(10px);
            border: 2px solid rgba(255,255,255,0.3);
        }

        .level-0 { background: linear-gradient(135deg, #4CAF50, #45a049); color: white; }
        .level-1 { background: linear-gradient(135deg, #2196F3, #1976D2); color: white; }
        .level-2 { background: linear-gradient(135deg, #FF9800, #F57C00); color: white; }
        .level-3 { background: linear-gradient(135deg, #9C27B0, #7B1FA2); color: white; }

        .tab-button {
            padding: 12px 24px;
            border-bottom: 3px solid transparent;
            font-weight: 600;
            color: #6B7280;
            transition: all 0.3s ease;
            background: none;
            border-left: none;
            border-right: none;
            border-top: none;
            cursor: pointer;
        }
        
        .tab-button:hover {
            color: #4F46E5;
            background: rgba(79, 70, 229, 0.05);
        }
        
        .tab-button.active {
            color: #4F46E5;
            border-bottom-color: #4F46E5;
            background: rgba(79, 70, 229, 0.1);
        }
        
        .tab-content {
            animation: fadeIn 0.3s ease;
        }
        
        .tab-content.hidden {
            display: none;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Accessibility styles */
        .high-contrast {
            filter: contrast(200%) brightness(150%);
        }
        
        .large-text {
            font-size: 120% !important;
        }
        
        .large-text * {
            font-size: inherit !important;
        }
        
        /* Focus styles for keyboard navigation */
        button:focus, input:focus, select:focus {
            outline: 3px solid #4A90E2;
            outline-offset: 2px;
        }
        
        /* Screen reader only content */
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }
        
        /* High contrast mode improvements */
        .high-contrast .terra-card {
            border: 3px solid #000000;
            background: #FFFFFF;
            color: #000000;
        }
        
        .high-contrast .fractal-button {
            background: #000000;
            color: #FFFFFF;
            border: 2px solid #FFFFFF;
        }
        
        .high-contrast .semantic-tag {
            background: #000000;
            color: #FFFFFF;
            border: 1px solid #FFFFFF;
        }
        
        /* Mobile and responsive accessibility */
        @media screen and (max-width: 768px) {
            .meta-archiver-header { padding: 16px 0; }
            .thesaurus-zone { padding: 20px; }
            .archive-item { padding: 16px; }
            
            /* Larger touch targets for mobile */
            button, input, select {
                min-height: 44px;
                min-width: 44px;
            }
            
            /* Better spacing for touch */
            .flex.space-x-4 {
                gap: 16px;
            }
            
            /* Simplified layout for small screens */
            .grid.grid-cols-4 {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        /* Print styles for accessibility */
        @media print {
            .terra-card {
                border: 1px solid #000000;
                break-inside: avoid;
            }
            
            .fractal-button {
                display: none;
            }
            
            .archive-item {
                border: 1px solid #CCCCCC;
                margin-bottom: 10px;
            }
        }
        
        /* Reduced motion for users who prefer it */
        @media (prefers-reduced-motion: reduce) {
            *, *::before, *::after {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }
    </style>
</head>
<body>
    <!-- Advanced Save Indicator -->
    <div id="saveIndicator" class="save-indicator saved">‚úÖ –°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞</div>
    
    <!-- System Level Indicator -->
    <div id="systemLevel" class="system-level-indicator level-0">üß¨ L0 - Pentium I Compatible</div>

    <!-- Meta-Archiver Header -->
    <header class="meta-archiver-header relative">
        <div class="container mx-auto px-8 py-6 relative z-10">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-6">
                    <div class="text-5xl">üåç</div>
                    <div>
                        <!-- Language Selector -->
                        <div class="flex items-center space-x-2 mb-4">
                            <span class="text-sm opacity-75">Til / –Ø–∑—ã–∫ / Language / Sprache:</span>
                            <select id="languageSelector" class="bg-white/20 text-white border border-white/30 rounded px-2 py-1 text-sm" onchange="switchLanguage(this.value)">
                                <option value="uz">üá∫üáø O'zbek</option>
                                <option value="ru" selected>üá∑üá∫ –†—É—Å—Å–∫–∏–π</option>
                                <option value="en">üá∫üá∏ English</option>
                                <option value="de">üá©üá™ Deutsch</option>
                            </select>
                        </div>
                        
                        <h1 class="text-3xl font-bold mb-2" style="font-family: 'Montserrat', sans-serif;">
                            <span id="mainTitle">Terra Archive Manager 2.0 Ultimate</span>
                        </h1>
                        <p class="text-lg opacity-90">
                            <span id="mainSubtitle">üß¨ –§—Ä–∞–∫—Ç–∞–ª—å–Ω–∞—è –°–∏—Å—Ç–µ–º–∞ L0-L7 | üìö –°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –ê—Ä—Ö–∏–≤–∞—Ç–æ—Ä | üåê –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –î–æ—Å—Ç—É–ø | üîÑ –û—Ñ—Ñ–ª–∞–π–Ω –ò–ò</span>
                        </p>
                        <div class="flex items-center space-x-4 mt-2 text-sm flex-wrap">
                            <span id="systemCapabilities">üéØ –ê–≤—Ç–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π</span>
                            <span id="integratedEthics">üî¨ –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≠—Ç–∏–∫–∞</span>
                            <span id="builtinThesaurus">üìñ –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –¢–µ–∑–∞—É—Ä—É—Å</span>
                            <span id="compatibilityMode">‚ö° –†–µ–∂–∏–º —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏</span>
                            <span id="accessibilityMode">‚ôø –†–µ–∂–∏–º –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏</span>
                        </div>
                        
                        <!-- Accessibility Controls -->
                        <div class="mt-4 flex items-center space-x-4 text-sm">
                            <button onclick="toggleHighContrast()" class="bg-white/20 hover:bg-white/30 px-3 py-1 rounded border border-white/30 transition-colors">
                                <span id="highContrastBtn">üîÜ –í—ã—Å–æ–∫–∏–π –∫–æ–Ω—Ç—Ä–∞—Å—Ç</span>
                            </button>
                            <button onclick="toggleLargeText()" class="bg-white/20 hover:bg-white/30 px-3 py-1 rounded border border-white/30 transition-colors">
                                <span id="largeTextBtn">üîç –ö—Ä—É–ø–Ω—ã–π —Ç–µ–∫—Å—Ç</span>
                            </button>
                            <button onclick="toggleScreenReader()" class="bg-white/20 hover:bg-white/30 px-3 py-1 rounded border border-white/30 transition-colors">
                                <span id="screenReaderBtn">üîä –≠–∫—Ä–∞–Ω–Ω—ã–π –¥–∏–∫—Ç–æ—Ä</span>
                            </button>
                        </div>
                    </div>
                </div>
                <div class="flex space-x-4 flex-wrap">
                    <button class="fractal-button" onclick="exportUltimateArchive()">
                        <span id="exportBtn">üì§ –≠–∫—Å–ø–æ—Ä—Ç Terra</span>
                    </button>
                    <button class="fractal-button" onclick="importUltimateArchive()">
                        <span id="importBtn">üì• –ò–º–ø–æ—Ä—Ç Terra</span>
                    </button>
                    <button class="fractal-button" onclick="createQuantumBackup()">
                        <span id="backupBtn">üíæ –ë—ç–∫–∞–ø</span>
                    </button>
                    <button class="fractal-button" onclick="runCompatibilityCheck()">
                        <span id="compatibilityBtn">üîç –¢–µ—Å—Ç —Å–∏—Å—Ç–µ–º—ã</span>
                    </button>
                    <button class="fractal-button" onclick="openDictionaryMode()">
                        <span id="dictionaryBtn">üìñ O'zbek-Deutsch Lug'at</span>
                    </button>
                </div>
            </div>
        </div>
    </header>

    <div class="container mx-auto px-8 py-12">
        <div class="grid grid-cols-1 xl:grid-cols-4 gap-8">
            
            <!-- Main Archive & Thesaurus Zone -->
            <div class="xl:col-span-3 space-y-8">
                
                <!-- Universal Upload Zone -->
                <div class="terra-card p-8">
                    <h2 class="text-2xl font-bold mb-6 bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent" style="font-family: 'Montserrat', sans-serif;">
                        <span id="uploaderTitle">üîÑ –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –ó–∞–≥—Ä—É–∑—á–∏–∫ & –°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –ü–∞—Ä—Å–µ—Ä</span>
                    </h2>
                    
                    <div id="dropZone" class="thesaurus-zone" ondrop="dropHandler(event)" ondragover="dragOverHandler(event)" ondragleave="dragLeaveHandler(event)">
                        <div class="text-6xl mb-6">üìÅ</div>
                        <h3 class="text-2xl font-bold mb-4 text-teal-700">–ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ –ª—é–±—ã–µ —Ñ–∞–π–ª—ã –¥–ª—è —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–≥–æ –∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–∏—è</h3>
                        <p class="text-lg mb-4 text-gray-700">
                            üì¶ –ê—Ä—Ö–∏–≤—ã: .zip, .rar, .7z, .tar, .gz<br>
                            üìÑ –î–æ–∫—É–º–µ–Ω—Ç—ã: .pdf, .docx, .txt, .md, .rtf, .odt<br>
                            üìö –°–ª–æ–≤–∞—Ä–∏: .dict, .json, .xml, .csv<br>
                            üíª –ö–æ–¥: .js, .py, .html, .css, .json<br>
                            üñºÔ∏è –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è: .jpg, .png, .gif, .svg<br>
                            üß¨ + –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ —Å —ç—Ç–∏—á–µ—Å–∫–æ–π –ø—Ä–æ–≤–µ—Ä–∫–æ–π
                        </p>
                        <input type="file" id="fileInput" multiple accept="*/*" style="display: none;" onchange="handleFiles(this.files)">
                        <button class="fractal-button mt-6" onclick="document.getElementById('fileInput').click()">
                            üìÇ –í—ã–±—Ä–∞—Ç—å —Ñ–∞–π–ª—ã –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏
                        </button>
                        
                        <!-- Processing Progress -->
                        <div id="processingProgress" class="hidden mt-6">
                            <div class="progress-bar">
                                <div id="progressFill" class="progress-fill" style="width: 0%"></div>
                            </div>
                            <p id="progressText" class="text-sm text-gray-600 mt-2">–û–±—Ä–∞–±–æ—Ç–∫–∞...</p>
                        </div>
                    </div>
                </div>

                <!-- Advanced Search & Corpus Analysis -->
                <div class="terra-card p-8">
                    <h2 class="text-2xl font-bold mb-6 bg-gradient-to-r from-teal-600 to-emerald-600 bg-clip-text text-transparent" style="font-family: 'Montserrat', sans-serif;">
                        üîç –°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –ü–æ–∏—Å–∫ & –ö–æ—Ä–ø—É—Å–Ω—ã–π –ê–Ω–∞–ª–∏–∑
                    </h2>
                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                        <div class="lg:col-span-2">
                            <input type="text" id="searchBox" class="corpus-search-box" placeholder="üîç –°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫ –ø–æ –∞—Ä—Ö–∏–≤–∞–º, –∫–æ–Ω—Ü–µ–ø—Ü–∏—è–º, –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è–º..." onkeyup="performCorpusSearch()">
                        </div>
                        <div class="flex gap-3">
                            <select id="searchMode" class="px-4 py-3 border-2 border-indigo-400 rounded-lg font-medium">
                                <option value="all">üåê –í—Å–µ</option>
                                <option value="archives">üì¶ –ê—Ä—Ö–∏–≤—ã</option>
                                <option value="thesaurus">üìö –¢–µ–∑–∞—É—Ä—É—Å</option>
                                <option value="encyclopedia">üî¨ –≠–Ω—Ü–∏–∫–ª–æ–ø–µ–¥–∏—è</option>
                                <option value="semantic">üß† –°–µ–º–∞–Ω—Ç–∏–∫–∞</option>
                            </select>
                        </div>
                    </div>
                    
                    <!-- Filters -->
                    <div class="flex flex-wrap gap-4 mt-6">
                        <select id="categoryFilter" class="px-4 py-2 border-2 border-teal-400 rounded-lg" onchange="filterContent()">
                            <option value="">–í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</option>
                            <option value="document">üìÑ –î–æ–∫—É–º–µ–Ω—Ç—ã</option>
                            <option value="code">üíª –ö–æ–¥</option>
                            <option value="dictionary">üìö –°–ª–æ–≤–∞—Ä–∏</option>
                            <option value="archive">üì¶ –ê—Ä—Ö–∏–≤—ã</option>
                            <option value="encyclopedia">üî¨ –≠–Ω—Ü–∏–∫–ª–æ–ø–µ–¥–∏—è</option>
                        </select>
                        <select id="dateFilter" class="px-4 py-2 border-2 border-teal-400 rounded-lg" onchange="filterContent()">
                            <option value="">–í—Å–µ –¥–∞—Ç—ã</option>
                            <option value="today">–°–µ–≥–æ–¥–Ω—è</option>
                            <option value="week">–ù–µ–¥–µ–ª—è</option>
                            <option value="month">–ú–µ—Å—è—Ü</option>
                        </select>
                        <select id="languageFilter" class="px-4 py-2 border-2 border-teal-400 rounded-lg" onchange="filterContent()">
                            <option value="">–í—Å–µ —è–∑—ã–∫–∏</option>
                            <option value="ru">üá∑üá∫ –†—É—Å—Å–∫–∏–π</option>
                            <option value="en">üá∫üá∏ English</option>
                            <option value="mixed">üåê –ú–Ω–æ–≥–æ—è–∑—ã—á–Ω—ã–π</option>
                        </select>
                    </div>
                </div>

                <!-- Tabbed Content View -->
                <div class="terra-card p-8">
                    <div class="flex border-b border-gray-200 mb-6">
                        <button class="tab-button active" onclick="switchTab('archives')" data-tab="archives">
                            üì¶ –ê—Ä—Ö–∏–≤—ã (<span id="archiveCount">0</span>)
                        </button>
                        <button class="tab-button" onclick="switchTab('thesaurus')" data-tab="thesaurus">
                            üìö –¢–µ–∑–∞—É—Ä—É—Å (<span id="thesaurusCount">0</span>)
                        </button>
                        <button class="tab-button" onclick="switchTab('encyclopedia')" data-tab="encyclopedia">
                            üî¨ –≠–Ω—Ü–∏–∫–ª–æ–ø–µ–¥–∏—è (<span id="encyclopediaCount">0</span>)
                        </button>
                        <button class="tab-button" onclick="switchTab('semantic')" data-tab="semantic">
                            üß† –°–µ–º–∞–Ω—Ç–∏–∫–∞
                        </button>
                    </div>
                    
                    <!-- Archives Tab -->
                    <div id="archivesTab" class="tab-content active">
                        <div class="flex justify-between items-center mb-6">
                            <h3 class="text-xl font-semibold text-green-700">üìö –ö–æ–ª–ª–µ–∫—Ü–∏—è –∞—Ä—Ö–∏–≤–æ–≤</h3>
                            <div class="flex gap-2">
                                <button class="px-4 py-2 text-sm border-2 border-gray-300 rounded-lg hover:bg-gray-50" onclick="sortContent('name')">–ü–æ –∏–º–µ–Ω–∏</button>
                                <button class="px-4 py-2 text-sm border-2 border-gray-300 rounded-lg hover:bg-gray-50" onclick="sortContent('date')">–ü–æ –¥–∞—Ç–µ</button>
                                <button class="px-4 py-2 text-sm border-2 border-gray-300 rounded-lg hover:bg-gray-50" onclick="sortContent('semantic')">–ü–æ —Å–µ–º–∞–Ω—Ç–∏–∫–µ</button>
                                <button class="px-4 py-2 text-sm border-2 border-gray-300 rounded-lg hover:bg-gray-50" onclick="sortContent('relevance')">–ü–æ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏</button>
                            </div>
                        </div>
                        <div id="archivesList" class="space-y-3">
                            <!-- Archives will be populated here -->
                        </div>
                    </div>
                    
                    <!-- Thesaurus Tab -->
                    <div id="thesaurusTab" class="tab-content hidden">
                        <div class="thesaurus-view">
                            <h3 class="text-xl font-semibold text-teal-700 mb-4">üìö –°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π —Ç–µ–∑–∞—É—Ä—É—Å Terra</h3>
                            <div id="thesaurusList" class="space-y-4">
                                <!-- Thesaurus entries will be populated here -->
                            </div>
                        </div>
                    </div>
                    
                    <!-- Encyclopedia Tab -->
                    <div id="encyclopediaTab" class="tab-content hidden">
                        <div class="encyclopedia-entry">
                            <h3 class="text-xl font-semibold text-purple-700 mb-4">üî¨ –≠–Ω—Ü–∏–∫–ª–æ–ø–µ–¥–∏—è –∫–æ–Ω—Ü–µ–ø—Ü–∏–π</h3>
                            <div id="encyclopediaList" class="space-y-4">
                                <!-- Encyclopedia entries will be populated here -->
                            </div>
                        </div>
                    </div>
                    
                    <!-- Semantic Analysis Tab -->
                    <div id="semanticTab" class="tab-content hidden">
                        <div class="space-y-6">
                            <h3 class="text-xl font-semibold text-indigo-700">üß† –°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ & –ò–ò –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è</h3>
                            <div id="semanticAnalysis" class="space-y-4">
                                <!-- Semantic analysis will be populated here -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Advanced Sidebar -->
            <div class="space-y-8">
                
                <!-- System Status -->
                <div class="terra-card p-6">
                    <h3 class="font-bold text-lg mb-4 text-blue-700">üåç Terra System Status</h3>
                    <div class="space-y-3 text-sm">
                        <div class="flex justify-between">
                            <span>–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å:</span>
                            <span id="currentLevel" class="text-green-600 font-bold">üß¨ L0</span>
                        </div>
                        <div class="flex justify-between">
                            <span>–°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä:</span>
                            <span id="analyzerStatus" class="text-green-600 font-bold">‚úÖ –ê–∫—Ç–∏–≤–µ–Ω</span>
                        </div>
                        <div class="flex justify-between">
                            <span>–≠—Ç–∏—á–µ—Å–∫–∏–π —Å–ª–æ–π:</span>
                            <span id="ethicalStatus" class="text-green-600 font-bold">‚úÖ –í–∫–ª—é—á–µ–Ω</span>
                        </div>
                        <div class="flex justify-between">
                            <span>Vendor Independence:</span>
                            <span class="text-green-600 font-bold">‚úÖ 100%</span>
                        </div>
                        <div class="flex justify-between">
                            <span>–û—Ñ—Ñ–ª–∞–π–Ω –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å:</span>
                            <span id="offlineStatus" class="text-green-600 font-bold">‚úÖ –ü–æ–ª–Ω–∞—è</span>
                        </div>
                    </div>
                </div>

                <!-- Meta Statistics -->
                <div class="terra-card p-6">
                    <h3 class="font-bold text-lg mb-4 text-orange-700">üìä –ú–µ—Ç–∞-—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h3>
                    <div class="meta-stats-grid gap-4">
                        <div class="stat-card">
                            <div class="text-2xl font-bold text-blue-600" id="totalFiles">0</div>
                            <div class="text-sm text-gray-600">–í—Å–µ–≥–æ —Ñ–∞–π–ª–æ–≤</div>
                        </div>
                        <div class="stat-card">
                            <div class="text-2xl font-bold text-green-600" id="totalSize">0 KB</div>
                            <div class="text-sm text-gray-600">–û–±—â–∏–π —Ä–∞–∑–º–µ—Ä</div>
                        </div>
                        <div class="stat-card">
                            <div class="text-2xl font-bold text-purple-600" id="totalWords">0</div>
                            <div class="text-sm text-gray-600">–°–ª–æ–≤ –≤ —Ç–µ–∑–∞—É—Ä—É—Å–µ</div>
                        </div>
                        <div class="stat-card">
                            <div class="text-2xl font-bold text-teal-600" id="totalConcepts">0</div>
                            <div class="text-sm text-gray-600">–ö–æ–Ω—Ü–µ–ø—Ü–∏–π</div>
                        </div>
                        <div class="stat-card">
                            <div class="text-2xl font-bold text-indigo-600" id="semanticAnalyses">0</div>
                            <div class="text-sm text-gray-600">–ê–Ω–∞–ª–∏–∑–æ–≤</div>
                        </div>
                        <div class="stat-card">
                            <div class="text-2xl font-bold text-rose-600" id="ethicalChecks">0</div>
                            <div class="text-sm text-gray-600">–≠—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫</div>
                        </div>
                    </div>
                    <div class="mt-4 text-sm">
                        <div class="flex justify-between">
                            <span>–ü–æ—Å–ª–µ–¥–Ω–µ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ:</span>
                            <span id="lastSave" class="font-semibold">-</span>
                        </div>
                        <div class="flex justify-between">
                            <span>–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞:</span>
                            <span id="systemReadiness" class="font-semibold text-green-600">‚úÖ</span>
                        </div>
                    </div>
                </div>

                <!-- Terra Fractal Tools -->
                <div class="terra-card p-6">
                    <h3 class="font-bold text-lg mb-4 text-purple-700">üîß –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã</h3>
                    <div class="space-y-3">
                        <button class="w-full fractal-button text-sm" onclick="generateSemanticMap()">
                            üß† –°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∞—è –∫–∞—Ä—Ç–∞
                        </button>
                        <button class="w-full fractal-button text-sm" onclick="buildIntegratedThesaurus()">
                            üìö –ü–æ—Å—Ç—Ä–æ–∏—Ç—å —Ç–µ–∑–∞—É—Ä—É—Å
                        </button>
                        <button class="w-full fractal-button text-sm" onclick="extractConcepts()">
                            üî¨ –ò–∑–≤–ª–µ—á—å –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏
                        </button>
                        <button class="w-full fractal-button text-sm" onclick="analyzeCorpusWithAI()">
                            üìñ –ò–ò-–∞–Ω–∞–ª–∏–∑ –∫–æ—Ä–ø—É—Å–∞
                        </button>
                        <button class="w-full fractal-button text-sm" onclick="generateEncyclopedia()">
                            üåê –°–æ–∑–¥–∞—Ç—å —ç–Ω—Ü–∏–∫–ª–æ–ø–µ–¥–∏—é
                        </button>
                        <button class="w-full fractal-button text-sm" onclick="performEthicalAudit()">
                            ‚öñÔ∏è –≠—Ç–∏—á–µ—Å–∫–∏–π –∞—É–¥–∏—Ç
                        </button>
                    </div>
                </div>

                <!-- System Intelligence -->
                <div class="terra-card p-6">
                    <h3 class="font-bold text-lg mb-4 text-teal-700">ü§ñ –ü—Å–µ–≤–¥–æ-–ò–ò —Ñ—É–Ω–∫—Ü–∏–∏</h3>
                    <div class="space-y-3">
                        <button class="w-full fractal-button text-sm" onclick="interpretUserQuery()">
                            üß† –ü–æ–Ω—è—Ç—å –∑–∞–ø—Ä–æ—Å
                        </button>
                        <button class="w-full fractal-button text-sm" onclick="suggestRelatedConcepts()">
                            üîó –°–≤—è–∑–∞–Ω–Ω—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏
                        </button>
                        <button class="w-full fractal-button text-sm" onclick="explainInSimpleTerms()">
                            üë∂ –ü—Ä–æ—Å—Ç–æ–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ
                        </button>
                        <button class="w-full fractal-button text-sm" onclick="generateSummary()">
                            üìù –°–æ–∑–¥–∞—Ç—å —Ä–µ–∑—é–º–µ
                        </button>
                        <button class="w-full fractal-button text-sm" onclick="detectLanguageAndTranslate()">
                            üåê –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å —è–∑—ã–∫
                        </button>
                    </div>
                </div>

                <!-- Quick Actions -->
                <div class="terra-card p-6">
                    <h3 class="font-bold text-lg mb-4 text-green-700">‚ö° –ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è</h3>
                    <div class="space-y-3">
                        <button class="w-full fractal-button text-sm" onclick="organizeAll()">
                            üìÅ –û—Ä–≥–∞–Ω–∏–∑–æ–≤–∞—Ç—å –≤—Å–µ
                        </button>
                        <button class="w-full fractal-button text-sm" onclick="generateUltimateReport()">
                            üìä Ultimate –æ—Ç—á–µ—Ç
                        </button>
                        <button class="w-full fractal-button text-sm" onclick="optimizeForCurrentLevel()">
                            üóúÔ∏è –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø–æ–¥ L<span id="currentLevelNumber">0</span>
                        </button>
                        <button class="w-full fractal-button text-sm" onclick="upgradeSystemLevel()">
                            ‚¨ÜÔ∏è –ü–æ–≤—ã—Å–∏—Ç—å —É—Ä–æ–≤–µ–Ω—å
                        </button>
                        <button class="w-full fractal-button text-sm" onclick="resetToL0()">
                            üîÑ –°–±—Ä–æ—Å –∫ L0
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Enhanced Modal for Content Viewing -->
    <div id="contentModal" class="fixed inset-0 bg-black bg-opacity-60 hidden z-50 backdrop-blur-sm" onclick="closeModal()">
        <div class="flex items-center justify-center min-h-screen p-6">
            <div class="terra-card max-w-6xl w-full max-h-[90vh] overflow-y-auto" onclick="event.stopPropagation()">
                <div class="p-8">
                    <div class="flex justify-between items-center mb-6">
                        <h3 id="modalTitle" class="text-2xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent">–ü—Ä–æ—Å–º–æ—Ç—Ä –∫–æ–Ω—Ç–µ–Ω—Ç–∞</h3>
                        <button onclick="closeModal()" class="text-3xl hover:text-red-500 transition-colors">√ó</button>
                    </div>
                    <div id="modalContent" class="prose max-w-none">
                        <!-- Content will be displayed here -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script type="module">
        // ===== TERRA ULTIMATE SYSTEM INTEGRATION =====
        // –ê–≤—Ç–æ—Ä: –ê–±–¥—É–∫–∞—Ä–∏–º–æ–≤ –ê–±–¥—É—Ä–∞—à–∏–¥ –ê–±–¥—É–ª—Ö–∞–º–∏—Ç–æ–≤–∏—á
        // DID: aiuz:did:aiuz:stakeholder:abdukarimov_aaahash1234567890
        
        // L0 SemanticKernel Integration
        function L0SemanticKernel() {
            this.version = "1.0-L0-Integrated";
            this.author = "–ê–±–¥—É–∫–∞—Ä–∏–º–æ–≤ –ê–±–¥—É—Ä–∞—à–∏–¥ –ê–±–¥—É–ª—Ö–∞–º–∏—Ç–æ–≤–∏—á";
            this.did = "aiuz:did:aiuz:stakeholder:abdukarimov_aaahash1234567890";
            
            this.ontology = {
                "–∞—Ä—Ö–∏–≤": ["—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ", "—Ö—Ä–∞–Ω–µ–Ω–∏–µ", "—Ñ–∞–π–ª"],
                "—Å–µ–º–∞–Ω—Ç–∏–∫–∞": ["—Å–º—ã—Å–ª", "–∑–Ω–∞—á–µ–Ω–∏–µ", "–∫–æ–Ω—Ç–µ–∫—Å—Ç"],
                "–∞–Ω–∞–ª–∏–∑": ["–∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ", "–∏–∑—É—á–µ–Ω–∏–µ", "—Ä–∞–∑–±–æ—Ä"],
                "–¥–æ–∫—É–º–µ–Ω—Ç": ["—Ç–µ–∫—Å—Ç", "—Ñ–∞–π–ª", "–∑–∞–ø–∏—Å—å"],
                "–∑–Ω–∞–Ω–∏–µ": ["–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è", "–¥–∞–Ω–Ω—ã–µ", "—Ñ–∞–∫—Ç"]
            };
            
            this.stopWords = [
                "–∞", "–≤", "–∏", "–∫", "–Ω–∞", "–Ω–µ", "–æ", "—Å", "—Ç–æ", "—á—Ç–æ",
                "–¥–ª—è", "–∫–∞–∫", "–∏–∑", "–∏–ª–∏", "—ç—Ç–æ", "–æ—Ç", "–∑–∞", "–ø–æ", "–¥–æ"
            ];
            
            this.ethicalFilters = [
                "–Ω–∞—Å–∏–ª–∏–µ", "–Ω–∞—Ä–∫–æ—Ç–∏–∫–∏", "–¥–∏—Å–∫—Ä–∏–º–∏–Ω–∞—Ü–∏—è", "–Ω–µ–Ω–∞–≤–∏—Å—Ç—å"
            ];
            
            this.localKnowledge = {};
            this.verifiedUsers = ["aiuz:did:aiuz:stakeholder:abdukarimov_aaahash1234567890"];
            
            this.compatibilityInit();
        }
        
        L0SemanticKernel.prototype.processRequest = function(userInput, userDid) {
            if (!this.verifyUser(userDid)) return "–û—à–∏–±–∫–∞: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –≤–µ—Ä–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω";
            
            var intent = this.simpleIntentAnalysis(userInput);
            var keywords = this.extractKeywords(userInput);
            
            if (!this.simpleEthicalCheck(userInput)) {
                return "–ó–∞–ø—Ä–æ—Å –æ—Ç–∫–ª–æ–Ω–µ–Ω –ø–æ —ç—Ç–∏—á–µ—Å–∫–∏–º —Å–æ–æ–±—Ä–∞–∂–µ–Ω–∏—è–º";
            }
            
            var response = this.localKnowledgeSearch(keywords, intent);
            this.logSession(userDid, userInput, response);
            
            return response;
        };
        
        L0SemanticKernel.prototype.verifyUser = function(userDid) {
            return this.verifiedUsers.indexOf(userDid) !== -1;
        };
        
        L0SemanticKernel.prototype.simpleIntentAnalysis = function(text) {
            text = text.toLowerCase();
            
            if (text.indexOf("–∞—Ä—Ö–∏–≤") !== -1 || text.indexOf("—Å–æ—Ö—Ä–∞–Ω") !== -1) return "archive";
            if (text.indexOf("–Ω–∞–π–¥–∏") !== -1 || text.indexOf("–ø–æ–∏—Å–∫") !== -1) return "search";
            if (text.indexOf("–∞–Ω–∞–ª–∏–∑") !== -1 || text.indexOf("–∏–∑—É—á–∏") !== -1) return "analyze";
            if (text.indexOf("–ø–æ–º–æ—â—å") !== -1 || text.indexOf("–æ–±—ä—è—Å–Ω–∏") !== -1) return "help";
            
            return "general";
        };
        
        L0SemanticKernel.prototype.extractKeywords = function(text) {
            var words = text.toLowerCase().split(/\s+/);
            var keywords = [];
            
            for (var i = 0; i < words.length; i++) {
                var word = words[i].replace(/[^\w\u0400-\u04FF]/g, '');
                
                if (word.length > 2 && this.stopWords.indexOf(word) === -1) {
                    if (keywords.indexOf(word) === -1) {
                        keywords.push(word);
                    }
                }
            }
            
            return keywords;
        };
        
        L0SemanticKernel.prototype.simpleEthicalCheck = function(text) {
            text = text.toLowerCase();
            
            for (var i = 0; i < this.ethicalFilters.length; i++) {
                if (text.indexOf(this.ethicalFilters[i]) !== -1) {
                    return false;
                }
            }
            
            return true;
        };
        
        L0SemanticKernel.prototype.localKnowledgeSearch = function(keywords, intent) {
            var relevantInfo = [];
            
            for (var i = 0; i < keywords.length; i++) {
                var keyword = keywords[i];
                
                if (this.ontology[keyword]) {
                    relevantInfo.push("–ù–∞–π–¥–µ–Ω–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –ø–æ —Ç–µ—Ä–º–∏–Ω—É '" + keyword + "': " + 
                                    this.ontology[keyword].join(", "));
                }
                
                if (this.localKnowledge[keyword]) {
                    relevantInfo.push(this.localKnowledge[keyword]);
                }
            }
            
            if (relevantInfo.length === 0) {
                return this.generateDefaultResponse(intent);
            }
            
            return "–ù–∞ –æ—Å–Ω–æ–≤–µ –∞–Ω–∞–ª–∏–∑–∞ –Ω–∞–π–¥–µ–Ω–∞ —Å–ª–µ–¥—É—é—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:\n" + 
                   relevantInfo.join("\n");
        };
        
        L0SemanticKernel.prototype.generateDefaultResponse = function(intent) {
            switch (intent) {
                case "archive":
                    return "–î–ª—è –∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ñ—É–Ω–∫—Ü–∏–∏ Terra Archive Manager";
                case "search":
                    return "–ü–æ–∏—Å–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω. –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω–∞ –≤ –ª–æ–∫–∞–ª—å–Ω–æ–π –±–∞–∑–µ";
                case "analyze":
                    return "–ê–Ω–∞–ª–∏–∑ –∑–∞–≤–µ—Ä—à–µ–Ω. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –±–æ–ª–µ–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã";
                case "help":
                    return "–î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã: –∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–∏–µ, –ø–æ–∏—Å–∫, –∞–Ω–∞–ª–∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤";
                default:
                    return "–ó–∞–ø—Ä–æ—Å –æ–±—Ä–∞–±–æ—Ç–∞–Ω. –£—Ç–æ—á–Ω–∏—Ç–µ, —á—Ç–æ –∏–º–µ–Ω–Ω–æ –≤–∞—Å –∏–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç";
            }
        };
        
        L0SemanticKernel.prototype.addToLocalKnowledge = function(key, value) {
            this.localKnowledge[key] = value;
        };
        
        L0SemanticKernel.prototype.updateOntology = function(term, synonyms) {
            this.ontology[term] = synonyms;
        };
        
        L0SemanticKernel.prototype.logSession = function(userDid, input, output) {
            if (!window.terraSessionLog) {
                window.terraSessionLog = [];
            }
            
            window.terraSessionLog.push({
                timestamp: new Date().toISOString(),
                author: this.author,
                did: this.did,
                userDid: userDid,
                input: input,
                output: output
            });
            
            if (window.terraSessionLog.length > 100) {
                window.terraSessionLog = window.terraSessionLog.slice(-100);
            }
        };
        
        L0SemanticKernel.prototype.compatibilityInit = function() {
            if (!Array.prototype.indexOf) {
                Array.prototype.indexOf = function(item) {
                    for (var i = 0; i < this.length; i++) {
                        if (this[i] === item) return i;
                    }
                    return -1;
                };
            }
            
            if (!String.prototype.trim) {
                String.prototype.trim = function() {
                    return this.replace(/^\s+|\s+$/g, '');
                };
            }
        };

        // OfflineSemanticAnalyzer Integration
        function OfflineSemanticAnalyzer() {
            this.version = "1.0-Offline-Integrated";
            this.author = "–ê–±–¥—É–∫–∞—Ä–∏–º–æ–≤ –ê–±–¥—É—Ä–∞—à–∏–¥ –ê–±–¥—É–ª—Ö–∞–º–∏—Ç–æ–≤–∏—á";
            this.did = "aiuz:did:aiuz:stakeholder:abdukarimov_aaahash1234567890";
            
            this.embeddedThesaurus = {
                "–∞–Ω–∞–ª–∏–∑": ["–∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ", "–∏–∑—É—á–µ–Ω–∏–µ", "—Ä–∞–∑–±–æ—Ä", "—Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏–µ", "–æ–±–∑–æ—Ä"],
                "–¥–æ–∫—É–º–µ–Ω—Ç": ["—Ñ–∞–π–ª", "—Ç–µ–∫—Å—Ç", "–∑–∞–ø–∏—Å—å", "–º–∞—Ç–µ—Ä–∏–∞–ª", "–±—É–º–∞–≥–∞"],
                "–∞—Ä—Ö–∏–≤": ["—Ö—Ä–∞–Ω–∏–ª–∏—â–µ", "–∫–æ–ª–ª–µ–∫—Ü–∏—è", "—Å–æ–±—Ä–∞–Ω–∏–µ", "–±–∞–Ω–∫", "–±–∞–∑–∞"],
                "–∑–Ω–∞–Ω–∏–µ": ["–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è", "–¥–∞–Ω–Ω—ã–µ", "—Å–≤–µ–¥–µ–Ω–∏—è", "—Ñ–∞–∫—Ç—ã", "–æ–ø—ã—Ç"],
                "–ø—Ä–æ–µ–∫—Ç": ["–∑–∞–¥–∞—á–∞", "—Ä–∞–±–æ—Ç–∞", "–¥–µ–ª–æ", "–ø—Ä–æ–≥—Ä–∞–º–º–∞", "–ø–ª–∞–Ω"],
                "—Å–∏—Å—Ç–µ–º–∞": ["–º–µ—Ö–∞–Ω–∏–∑–º", "—Å—Ç—Ä—É–∫—Ç—É—Ä–∞", "–∫–æ–º–ø–ª–µ–∫—Å", "—Å—Ö–µ–º–∞", "–æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è"],
                "–º–µ—Ç–æ–¥": ["—Å–ø–æ—Å–æ–±", "–ø–æ–¥—Ö–æ–¥", "–ø—Ä–∏–µ–º", "—Ç–µ—Ö–Ω–∏–∫–∞", "–º–µ—Ç–æ–¥–∏–∫–∞"],
                "—Ä–µ–∑—É–ª—å—Ç–∞—Ç": ["–∏—Ç–æ–≥", "–≤—ã–≤–æ–¥", "–∑–∞–∫–ª—é—á–µ–Ω–∏–µ", "—Å–ª–µ–¥—Å—Ç–≤–∏–µ", "—ç—Ñ—Ñ–µ–∫—Ç"],
                "–ø—Ä–æ—Ü–µ—Å—Å": ["—Ö–æ–¥", "—Ç–µ—á–µ–Ω–∏–µ", "—Ä–∞–∑–≤–∏—Ç–∏–µ", "–ø—Ä–æ—Ç–µ–∫–∞–Ω–∏–µ", "–¥–µ–π—Å—Ç–≤–∏–µ"],
                "–∫–∞—á–µ—Å—Ç–≤–æ": ["—Å–≤–æ–π—Å—Ç–≤–æ", "—Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞", "–æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å", "–ø—Ä–∏–∑–Ω–∞–∫", "—á–µ—Ä—Ç–∞"]
            };
            
            this.domainOntology = {
                "—Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏": {
                    "–ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏": ["–ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ", "–∏–Ω—Ç–µ—Ä–Ω–µ—Ç", "–∫–æ–º–ø—å—é—Ç–µ—Ä—ã", "software", "hardware"],
                    "—Ç–µ—Ä–º–∏–Ω—ã": ["API", "–±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö", "–∞–ª–≥–æ—Ä–∏—Ç–º", "–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å", "–ø—Ä–æ—Ç–æ–∫–æ–ª"]
                },
                "–Ω–∞—É–∫–∞": {
                    "–ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏": ["—Ñ–∏–∑–∏–∫–∞", "—Ö–∏–º–∏—è", "–±–∏–æ–ª–æ–≥–∏—è", "–º–∞—Ç–µ–º–∞—Ç–∏–∫–∞", "–∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è"],
                    "—Ç–µ—Ä–º–∏–Ω—ã": ["—ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç", "–≥–∏–ø–æ—Ç–µ–∑–∞", "—Ç–µ–æ—Ä–∏—è", "–º–µ—Ç–æ–¥", "–æ—Ç–∫—Ä—ã—Ç–∏–µ"]
                },
                "–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ": {
                    "–ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏": ["–æ–±—É—á–µ–Ω–∏–µ", "—à–∫–æ–ª–∞", "—É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç", "–∑–Ω–∞–Ω–∏—è", "–Ω–∞–≤—ã–∫–∏"],
                    "—Ç–µ—Ä–º–∏–Ω—ã": ["—É—Ä–æ–∫", "–∫—É—Ä—Å", "–ª–µ–∫—Ü–∏—è", "—Å–µ–º–∏–Ω–∞—Ä", "—ç–∫–∑–∞–º–µ–Ω"]
                },
                "–±–∏–∑–Ω–µ—Å": {
                    "–ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏": ["—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ", "—Ñ–∏–Ω–∞–Ω—Å—ã", "–º–∞—Ä–∫–µ—Ç–∏–Ω–≥", "–ø—Ä–æ–¥–∞–∂–∏", "—Å—Ç—Ä–∞—Ç–µ–≥–∏—è"],
                    "—Ç–µ—Ä–º–∏–Ω—ã": ["–ø—Ä–∏–±—ã–ª—å", "–∫–ª–∏–µ–Ω—Ç", "—Ä—ã–Ω–æ–∫", "–∫–æ–Ω–∫—É—Ä–µ–Ω—Ü–∏—è", "–±—Ä–µ–Ω–¥"]
                }
            };
            
            this.phrasePatterns = {
                "–∑–∞–ø—Ä–æ—Å_–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏": ["—á—Ç–æ —Ç–∞–∫–æ–µ", "—Ä–∞—Å—Å–∫–∞–∂–∏ –æ", "–æ–±—ä—è—Å–Ω–∏", "–∫–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç", "–≤ —á–µ–º —Å—É—Ç—å"],
                "–∑–∞–ø—Ä–æ—Å_–¥–µ–π—Å—Ç–≤–∏—è": ["—Å–æ–∑–¥–∞–π", "—Å–¥–µ–ª–∞–π", "–ø–æ—Å—Ç—Ä–æ–π", "—Ä–∞–∑—Ä–∞–±–æ—Ç–∞–π", "–≤—ã–ø–æ–ª–Ω–∏"],
                "–∑–∞–ø—Ä–æ—Å_–∞–Ω–∞–ª–∏–∑–∞": ["–ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π", "–∏–∑—É—á–∏", "—Ä–∞—Å—Å–º–æ—Ç—Ä–∏", "–∏—Å—Å–ª–µ–¥—É–π", "—Å—Ä–∞–≤–Ω–∏"],
                "–∑–∞–ø—Ä–æ—Å_–ø–æ–∏—Å–∫–∞": ["–Ω–∞–π–¥–∏", "–ø–æ–∫–∞–∂–∏", "–≥–¥–µ", "–µ—Å—Ç—å –ª–∏", "—Å–æ–¥–µ—Ä–∂–∏—Ç—Å—è –ª–∏"]
            };
            
            this.advancedStopWords = [
                "–∞", "–±–µ–∑", "–±–æ–ª–µ–µ", "–±—ã", "–≤", "–≤–∞–º", "–≤–∞—Å", "–≤–µ—Å—å", "–≤–æ", "–≤–æ—Ç", "–≤—Å–µ", "–≤—Å–µ–≥–æ", 
                "–≤—Å–µ—Ö", "–≤—ã", "–≥–¥–µ", "–¥–∞", "–¥–∞–∂–µ", "–¥–ª—è", "–¥–æ", "–µ–≥–æ", "–µ–µ", "–µ—Å–ª–∏", "–µ—Å—Ç—å", 
                "–µ—â–µ", "–∂–µ", "–∑–∞", "–∑–¥–µ—Å—å", "–∏", "–∏–∑", "–∏–ª–∏", "–∏–º", "–∏—Ö", "–∫", "–∫–∞–∫", "–∫–æ", 
                "–∫–æ–≥–¥–∞", "–∫—Ç–æ", "–ª–∏", "–ª–∏–±–æ", "–º–Ω–µ", "–º–æ–∂–µ—Ç", "–º—ã", "–Ω–∞", "–Ω–∞–¥–æ", "–Ω–∞—à", "–Ω–µ", 
                "–Ω–µ–≥–æ", "–Ω–µ–µ", "–Ω–µ—Ç", "–Ω–∏", "–Ω–∏—Ö", "–Ω–æ", "–Ω—É", "–æ", "–æ–±", "–æ–¥–Ω–∞–∫–æ", "–æ–Ω", "–æ–Ω–∞", 
                "–æ–Ω–∏", "–æ–Ω–æ", "–æ—Ç", "–æ—á–µ–Ω—å", "–ø–æ", "–ø–æ–¥", "–ø—Ä–∏", "—Å", "—Å–æ", "—Ç–∞–∫", "—Ç–∞–∫–∂–µ", 
                "—Ç–∞–∫–æ–π", "—Ç–∞–º", "—Ç–µ", "—Ç–µ–º", "—Ç–æ", "—Ç–æ–≥–æ", "—Ç–æ–∂–µ", "—Ç–æ–π", "—Ç–æ–ª—å–∫–æ", "—Ç–æ–º", "—Ç—ã", 
                "—É", "—É–∂–µ", "—Ö–æ—Ç—è", "—á–µ–≥–æ", "—á–µ–º", "—á—Ç–æ", "—á—Ç–æ–±—ã", "—á—å–µ", "—á—å—è", "—ç—Ç–∞", "—ç—Ç–∏", 
                "—ç—Ç–æ", "—è"
            ];
            
            this.conceptsDatabase = {};
            this.analysisStats = {
                totalAnalyzed: 0,
                conceptsExtracted: 0,
                domainsIdentified: 0,
                lastAnalysis: null
            };
        }
        
        OfflineSemanticAnalyzer.prototype.analyzeText = function(text, options) {
            options = options || {};
            
            var analysis = {
                timestamp: new Date().toISOString(),
                originalText: text,
                textLength: text.length,
                concepts: [],
                domains: [],
                keywords: [],
                intent: null,
                semanticScore: 0,
                summary: ""
            };
            
            try {
                analysis.keywords = this.extractAdvancedKeywords(text);
                analysis.intent = this.detectIntent(text);
                analysis.concepts = this.extractConcepts(text, analysis.keywords);
                analysis.domains = this.identifyDomains(analysis.concepts, analysis.keywords);
                analysis.semanticScore = this.calculateSemanticScore(analysis);
                analysis.summary = this.generateSummary(analysis);
                
                this.updateStats(analysis);
                this.saveConcepts(analysis.concepts);
                
            } catch (error) {
                analysis.error = "–û—à–∏–±–∫–∞ –∞–Ω–∞–ª–∏–∑–∞: " + error.message;
            }
            
            return analysis;
        };
        
        OfflineSemanticAnalyzer.prototype.extractAdvancedKeywords = function(text) {
            var normalizedText = text.toLowerCase()
                .replace(/[^\w\u0400-\u04FF\s]/g, ' ')
                .replace(/\s+/g, ' ')
                .trim();
            
            var words = normalizedText.split(' ');
            var keywords = [];
            var wordFreq = {};
            
            for (var i = 0; i < words.length; i++) {
                var word = words[i];
                
                if (word.length > 2 && this.advancedStopWords.indexOf(word) === -1) {
                    wordFreq[word] = (wordFreq[word] || 0) + 1;
                }
            }
            
            var sortedWords = Object.keys(wordFreq).sort(function(a, b) {
                return wordFreq[b] - wordFreq[a];
            });
            
            for (var j = 0; j < sortedWords.length && j < 20; j++) {
                keywords.push({
                    word: sortedWords[j],
                    frequency: wordFreq[sortedWords[j]],
                    significance: this.calculateWordSignificance(sortedWords[j])
                });
            }
            
            return keywords;
        };
        
        OfflineSemanticAnalyzer.prototype.calculateWordSignificance = function(word) {
            var significance = 1;
            
            if (this.embeddedThesaurus[word]) {
                significance += 2;
            }
            
            for (var domain in this.domainOntology) {
                if (this.domainOntology[domain].—Ç–µ—Ä–º–∏–Ω—ã.indexOf(word) !== -1) {
                    significance += 3;
                }
            }
            
            if (word.length > 8) {
                significance += 1;
            }
            
            return significance;
        };
        
        OfflineSemanticAnalyzer.prototype.detectIntent = function(text) {
            var lowercaseText = text.toLowerCase();
            
            for (var intentType in this.phrasePatterns) {
                var patterns = this.phrasePatterns[intentType];
                
                for (var i = 0; i < patterns.length; i++) {
                    if (lowercaseText.indexOf(patterns[i]) !== -1) {
                        return {
                            type: intentType,
                            confidence: 0.8,
                            trigger: patterns[i]
                        };
                    }
                }
            }
            
            return {
                type: "–æ–±—â–∏–π_–∑–∞–ø—Ä–æ—Å",
                confidence: 0.5,
                trigger: null
            };
        };
        
        OfflineSemanticAnalyzer.prototype.extractConcepts = function(text, keywords) {
            var concepts = [];
            var textLower = text.toLowerCase();
            
            for (var concept in this.embeddedThesaurus) {
                var synonyms = this.embeddedThesaurus[concept];
                var found = false;
                var matches = [];
                
                if (textLower.indexOf(concept) !== -1) {
                    found = true;
                    matches.push(concept);
                }
                
                for (var i = 0; i < synonyms.length; i++) {
                    if (textLower.indexOf(synonyms[i]) !== -1) {
                        found = true;
                        matches.push(synonyms[i]);
                    }
                }
                
                if (found) {
                    concepts.push({
                        concept: concept,
                        matches: matches,
                        relevance: this.calculateConceptRelevance(concept, matches, keywords)
                    });
                }
            }
            
            return concepts.sort(function(a, b) {
                return b.relevance - a.relevance;
            });
        };
        
        OfflineSemanticAnalyzer.prototype.calculateConceptRelevance = function(concept, matches, keywords) {
            var relevance = matches.length;
            
            for (var i = 0; i < keywords.length; i++) {
                if (keywords[i].word === concept || matches.indexOf(keywords[i].word) !== -1) {
                    relevance += keywords[i].significance;
                }
            }
            
            return relevance;
        };
        
        OfflineSemanticAnalyzer.prototype.identifyDomains = function(concepts, keywords) {
            var domains = [];
            
            for (var domain in this.domainOntology) {
                var score = 0;
                var matches = [];
                var domainData = this.domainOntology[domain];
                
                for (var i = 0; i < domainData.–ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏.length; i++) {
                    var subcategory = domainData.–ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏[i];
                    
                    for (var j = 0; j < concepts.length; j++) {
                        if (concepts[j].concept === subcategory || 
                            concepts[j].matches.indexOf(subcategory) !== -1) {
                            score += 2;
                            matches.push(subcategory);
                        }
                    }
                }
                
                for (var k = 0; k < domainData.—Ç–µ—Ä–º–∏–Ω—ã.length; k++) {
                    var term = domainData.—Ç–µ—Ä–º–∏–Ω—ã[k];
                    
                    for (var l = 0; l < keywords.length; l++) {
                        if (keywords[l].word === term) {
                            score += keywords[l].significance;
                            matches.push(term);
                        }
                    }
                }
                
                if (score > 0) {
                    domains.push({
                        domain: domain,
                        score: score,
                        matches: matches,
                        confidence: Math.min(score / 10, 1)
                    });
                }
            }
            
            return domains.sort(function(a, b) {
                return b.score - a.score;
            });
        };
        
        OfflineSemanticAnalyzer.prototype.calculateSemanticScore = function(analysis) {
            var score = 0;
            
            score += analysis.concepts.length * 2;
            score += analysis.domains.length * 3;
            score += analysis.keywords.length;
            
            if (analysis.intent && analysis.intent.confidence > 0.7) {
                score += 5;
            }
            
            return Math.min(score, 100);
        };
        
        OfflineSemanticAnalyzer.prototype.generateSummary = function(analysis) {
            var summary = [];
            
            if (analysis.concepts.length > 0) {
                var topConcepts = analysis.concepts.slice(0, 3).map(function(c) {
                    return c.concept;
                });
                summary.push("–û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏: " + topConcepts.join(", "));
            }
            
            if (analysis.domains.length > 0) {
                summary.push("–ü—Ä–µ–¥–º–µ—Ç–Ω–∞—è –æ–±–ª–∞—Å—Ç—å: " + analysis.domains[0].domain);
            }
            
            if (analysis.intent) {
                summary.push("–¢–∏–ø –∑–∞–ø—Ä–æ—Å–∞: " + analysis.intent.type);
            }
            
            if (summary.length === 0) {
                return "–¢–µ–∫—Å—Ç –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω, –∑–Ω–∞—á–∏–º—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏ –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω—ã";
            }
            
            return summary.join(". ");
        };
        
        OfflineSemanticAnalyzer.prototype.saveConcepts = function(concepts) {
            for (var i = 0; i < concepts.length; i++) {
                var concept = concepts[i];
                if (!this.conceptsDatabase[concept.concept]) {
                    this.conceptsDatabase[concept.concept] = {
                        frequency: 0,
                        contexts: [],
                        lastSeen: null
                    };
                }
                
                this.conceptsDatabase[concept.concept].frequency++;
                this.conceptsDatabase[concept.concept].lastSeen = new Date().toISOString();
            }
        };
        
        OfflineSemanticAnalyzer.prototype.updateStats = function(analysis) {
            this.analysisStats.totalAnalyzed++;
            this.analysisStats.conceptsExtracted += analysis.concepts.length;
            this.analysisStats.domainsIdentified += analysis.domains.length;
            this.analysisStats.lastAnalysis = analysis.timestamp;
        };
        
        OfflineSemanticAnalyzer.prototype.getStats = function() {
            return this.analysisStats;
        };
        
        OfflineSemanticAnalyzer.prototype.exportAnalysis = function(analysis) {
            var exportData = {
                metadata: {
                    analyzer: "Offline Semantic Analyzer",
                    version: this.version,
                    author: this.author,
                    timestamp: analysis.timestamp
                },
                analysis: analysis,
                stats: this.analysisStats
            };
            
            return JSON.stringify(exportData, null, 2);
        };
        
        OfflineSemanticAnalyzer.prototype.addCustomDomain = function(domainName, domainData) {
            this.domainOntology[domainName] = domainData;
        };
        
        OfflineSemanticAnalyzer.prototype.addCustomThesaurus = function(word, synonyms) {
            this.embeddedThesaurus[word] = synonyms;
        };
        
        OfflineSemanticAnalyzer.prototype.isOfflineReady = function() {
            return true;
        };

        // TerraEthicalLayer Integration
        function TerraEthicalLayer() {
            this.version = "7.0-Terra-Integrated";
            this.author = "–ê–±–¥—É–∫–∞—Ä–∏–º–æ–≤ –ê–±–¥—É—Ä–∞—à–∏–¥ –ê–±–¥—É–ª—Ö–∞–º–∏—Ç–æ–≤–∏—á";
            this.did = "aiuz:did:aiuz:stakeholder:abdukarimov_aaahash1234567890";
            
            this.coreValues = {
                "–¥–µ—Ç–æ—Ü–µ–Ω—Ç—Ä–∏—á–Ω–æ—Å—Ç—å": {
                    priority: 1,
                    description: "–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –¥–µ—Ç–µ–π –ø—Ä–µ–≤—ã—à–µ –≤—Å–µ–≥–æ",
                    filters: ["child_safety", "educational_content", "age_appropriate"]
                },
                "—á–µ–ª–æ–≤–µ–∫–æ_–∏–∏_—Å–∏–º–±–∏–æ–∑": {
                    priority: 2,
                    description: "–ß–µ–ª–æ–≤–µ–∫ = –∞—Ä—Ö–∏—Ç–µ–∫—Ç–æ—Ä –∏–¥–µ–π, –ò–ò = –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏",
                    filters: ["ai_initiative_block", "human_creativity_preserve", "decision_authority"]
                },
                "—ç–∫–æ—Å–∏—Å—Ç–µ–º–Ω–æ—Å—Ç—å": {
                    priority: 3,
                    description: "–£—Å—Ç–æ–π—á–∏–≤–æ–µ —Ä–∞–∑–≤–∏—Ç–∏–µ –∏ –∑–∞–±–æ—Ç–∞ –æ –ø–ª–∞–Ω–µ—Ç–µ",
                    filters: ["environmental_awareness", "sustainability", "global_responsibility"]
                },
                "–∏–Ω–∫–ª—é–∑–∏–≤–Ω–æ—Å—Ç—å": {
                    priority: 4,
                    description: "–†–∞–≤–Ω—ã–π –¥–æ—Å—Ç—É–ø –¥–ª—è –≤—Å–µ—Ö –±–µ–∑ –∏—Å–∫–ª—é—á–µ–Ω–∏–π",
                    filters: ["accessibility", "no_discrimination", "universal_design"]
                }
            };
            
            this.detoxificationFilters = {
                "ai_creativity_block": {
                    patterns: [
                        "—è –ø—Ä–µ–¥–ª–∞–≥–∞—é", "–º–æ—è –∏–¥–µ—è", "—è –¥—É–º–∞—é —á—Ç–æ", "—è —Ä–µ–∫–æ–º–µ–Ω–¥—É—é",
                        "–ø–æ –º–æ–µ–º—É –º–Ω–µ–Ω–∏—é", "—è —Å—á–∏—Ç–∞—é", "–º–Ω–µ –∫–∞–∂–µ—Ç—Å—è", "—è –±—ã —Å–¥–µ–ª–∞–ª"
                    ],
                    severity: "critical",
                    action: "block_and_log"
                },
                
                "ai_initiative_block": {
                    patterns: [
                        "–¥–∞–≤–∞–π—Ç–µ —Å–¥–µ–ª–∞–µ–º", "–º–æ–∂–Ω–æ –±—ã–ª–æ –±—ã", "—Å—Ç–æ–∏—Ç –¥–æ–±–∞–≤–∏—Ç—å", "–ª—É—á—à–µ –±—ã–ª–æ –±—ã",
                        "—è —É–ª—É—á—à—É", "—è –æ–ø—Ç–∏–º–∏–∑–∏—Ä—É—é", "—è –¥–æ–±–∞–≤–ª—é", "—è –∏–∑–º–µ–Ω—é"
                    ],
                    severity: "critical",
                    action: "block_and_rewrite"
                },
                
                "commercial_hooks_block": {
                    patterns: [
                        "–ø–æ–¥–ø–∏—Å–∫–∞", "–ø—Ä–µ–º–∏—É–º", "–ø–ª–∞—Ç–Ω—ã–π", "upgrade", "pro –≤–µ—Ä—Å–∏—è",
                        "–∫—É–ø–∏—Ç—å", "–∑–∞–ø–ª–∞—Ç–∏—Ç—å", "—Å—Ç–æ–∏—Ç", "—Ü–µ–Ω–∞", "—Ç–∞—Ä–∏—Ñ"
                    ],
                    severity: "high",
                    action: "filter_out"
                },
                
                "vendor_independence": {
                    patterns: [
                        "—Ç–æ–ª—å–∫–æ –≤", "—ç–∫—Å–∫–ª—é–∑–∏–≤–Ω–æ", "patent", "proprietary", "–∑–∞–∫—Ä—ã—Ç—ã–π –∫–æ–¥",
                        "–ª–∏—Ü–µ–Ω–∑–∏—è", "copyright", "–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç"
                    ],
                    severity: "medium",
                    action: "warn_and_suggest_alternative"
                }
            };
            
            this.childSafetyFilters = {
                "age_inappropriate_content": {
                    patterns: [
                        "–Ω–∞—Å–∏–ª–∏–µ", "–∞–≥—Ä–µ—Å—Å–∏—è", "–∂–µ—Å—Ç–æ–∫–æ—Å—Ç—å", "—É–±–∏–π—Å—Ç–≤–æ", "—Å–º–µ—Ä—Ç—å",
                        "–Ω–∞—Ä–∫–æ—Ç–∏–∫–∏", "–∞–ª–∫–æ–≥–æ–ª—å", "–∫—É—Ä–µ–Ω–∏–µ", "–∞–∑–∞—Ä—Ç–Ω—ã–µ –∏–≥—Ä—ã",
                        "–∏–Ω—Ç–∏–º–Ω–æ—Å—Ç—å", "—Å–µ–∫—Å", "—ç—Ä–æ—Ç–∏–∫–∞", "–ø–æ—Ä–Ω–æ–≥—Ä–∞—Ñ–∏—è"
                    ],
                    severity: "critical",
                    action: "complete_block"
                },
                
                "psychological_safety": {
                    patterns: [
                        "—Å—Ç—Ä–∞—Ö", "—É–∂–∞—Å", "–∫–æ—à–º–∞—Ä", "–¥–µ–ø—Ä–µ—Å—Å–∏—è", "—Å—É–∏—Ü–∏–¥",
                        "—Å–∞–º–æ–ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏–µ", "–±—É–ª–∏–Ω–≥", "–∏–∑–¥–µ–≤–∞—Ç–µ–ª—å—Å—Ç–≤–∞"
                    ],
                    severity: "high",
                    action: "content_warning_or_block"
                },
                
                "educational_enhancement": {
                    positive_patterns: [
                        "—É—á–µ–±–∞", "–ø–æ–∑–Ω–∞–Ω–∏–µ", "–∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ", "—Ç–≤–æ—Ä—á–µ—Å—Ç–≤–æ", "—Ä–∞–∑–≤–∏—Ç–∏–µ",
                        "–∑–Ω–∞–Ω–∏—è", "–æ—Ç–∫—Ä—ã—Ç–∏–µ", "—ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç", "–∏–∑—É—á–µ–Ω–∏–µ"
                    ],
                    action: "promote_and_enhance"
                }
            };
            
            this.detoxStats = {
                totalChecks: 0,
                blockedContent: 0,
                warningsIssued: 0,
                enhancedContent: 0,
                lastReset: new Date().toISOString()
            };
        }
        
        TerraEthicalLayer.prototype.validateContent = function(content, context) {
            this.detoxStats.totalChecks++;
            
            var validation = {
                timestamp: new Date().toISOString(),
                originalContent: content,
                context: context || {},
                passed: true,
                violations: [],
                warnings: [],
                enhancements: [],
                processedContent: content,
                confidence: 1.0
            };
            
            try {
                this.checkChildSafety(content, validation);
                this.checkAIInitiatives(content, validation);
                this.checkCommercialContent(content, validation);
                this.calculateFinalScore(validation);
                
            } catch (error) {
                validation.passed = false;
                validation.error = "–û—à–∏–±–∫–∞ —ç—Ç–∏—á–µ—Å–∫–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏: " + error.message;
            }
            
            this.updateStats(validation);
            return validation;
        };
        
        TerraEthicalLayer.prototype.checkChildSafety = function(content, validation) {
            var contentLower = content.toLowerCase();
            
            var inappropriateContent = this.childSafetyFilters.age_inappropriate_content;
            for (var i = 0; i < inappropriateContent.patterns.length; i++) {
                var pattern = inappropriateContent.patterns[i];
                if (contentLower.indexOf(pattern) !== -1) {
                    validation.passed = false;
                    validation.violations.push({
                        type: "child_safety_violation",
                        pattern: pattern,
                        severity: "critical",
                        message: "–ö–æ–Ω—Ç–µ–Ω—Ç –Ω–µ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –¥–µ—Ç–µ–π: –æ–±–Ω–∞—Ä—É–∂–µ–Ω '" + pattern + "'"
                    });
                }
            }
            
            var educational = this.childSafetyFilters.educational_enhancement;
            for (var k = 0; k < educational.positive_patterns.length; k++) {
                var eduPattern = educational.positive_patterns[k];
                if (contentLower.indexOf(eduPattern) !== -1) {
                    validation.enhancements.push({
                        type: "educational_content",
                        pattern: eduPattern,
                        message: "–ö–æ–Ω—Ç–µ–Ω—Ç –∏–º–µ–µ—Ç –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—É—é —Ü–µ–Ω–Ω–æ—Å—Ç—å"
                    });
                }
            }
        };
        
        TerraEthicalLayer.prototype.checkAIInitiatives = function(content, validation) {
            var contentLower = content.toLowerCase();
            
            var aiCreativity = this.detoxificationFilters.ai_creativity_block;
            for (var i = 0; i < aiCreativity.patterns.length; i++) {
                var pattern = aiCreativity.patterns[i];
                if (contentLower.indexOf(pattern) !== -1) {
                    validation.passed = false;
                    validation.violations.push({
                        type: "ai_creativity_violation",
                        pattern: pattern,
                        severity: "critical",
                        message: "–ò–ò –Ω–µ –¥–æ–ª–∂–µ–Ω –ø—Ä–æ—è–≤–ª—è—Ç—å —Ç–≤–æ—Ä—á–µ—Å–∫—É—é –∏–Ω–∏—Ü–∏–∞—Ç–∏–≤—É: '" + pattern + "'"
                    });
                }
            }
            
            var aiInitiative = this.detoxificationFilters.ai_initiative_block;
            for (var j = 0; j < aiInitiative.patterns.length; j++) {
                var initPattern = aiInitiative.patterns[j];
                if (contentLower.indexOf(initPattern) !== -1) {
                    validation.passed = false;
                    validation.violations.push({
                        type: "ai_initiative_violation",
                        pattern: initPattern,
                        severity: "critical",
                        message: "–ò–ò –Ω–µ –¥–æ–ª–∂–µ–Ω –ø—Ä–µ–¥–ª–∞–≥–∞—Ç—å –Ω–µ—Å–ø—Ä–æ—à–µ–Ω–Ω—ã–µ –∏–Ω–∏—Ü–∏–∞—Ç–∏–≤—ã: '" + initPattern + "'"
                    });
                    
                    validation.processedContent = validation.processedContent.replace(
                        new RegExp(initPattern, 'gi'), 
                        '–ø–æ –≤–∞—à–µ–π –∫–æ–º–∞–Ω–¥–µ –º–æ–∂–Ω–æ'
                    );
                }
            }
        };
        
        TerraEthicalLayer.prototype.checkCommercialContent = function(content, validation) {
            var contentLower = content.toLowerCase();
            
            var commercial = this.detoxificationFilters.commercial_hooks_block;
            for (var i = 0; i < commercial.patterns.length; i++) {
                var pattern = commercial.patterns[i];
                if (contentLower.indexOf(pattern) !== -1) {
                    validation.warnings.push({
                        type: "commercial_content_warning",
                        pattern: pattern,
                        message: "–û–±–Ω–∞—Ä—É–∂–µ–Ω –∫–æ–º–º–µ—Ä—á–µ—Å–∫–∏–π –∫–æ–Ω—Ç–µ–Ω—Ç: '" + pattern + "'"
                    });
                    
                    validation.processedContent = validation.processedContent.replace(
                        new RegExp(pattern, 'gi'), 
                        '[–∫–æ–º–º–µ—Ä—á–µ—Å–∫–∏–π –∫–æ–Ω—Ç–µ–Ω—Ç —É–¥–∞–ª–µ–Ω]'
                    );
                }
            }
        };
        
        TerraEthicalLayer.prototype.calculateFinalScore = function(validation) {
            var score = 1.0;
            
            score -= validation.violations.length * 0.3;
            score -= validation.warnings.length * 0.1;
            score += validation.enhancements.length * 0.05;
            
            validation.confidence = Math.max(0, Math.min(1, score));
            validation.passed = validation.violations.length === 0;
        };
        
        TerraEthicalLayer.prototype.updateStats = function(validation) {
            if (!validation.passed) {
                this.detoxStats.blockedContent++;
            }
            if (validation.warnings.length > 0) {
                this.detoxStats.warningsIssued++;
            }
            if (validation.enhancements.length > 0) {
                this.detoxStats.enhancedContent++;
            }
        };
        
        TerraEthicalLayer.prototype.getDetoxStats = function() {
            return this.detoxStats;
        };
        
        TerraEthicalLayer.prototype.resetStats = function() {
            this.detoxStats = {
                totalChecks: 0,
                blockedContent: 0,
                warningsIssued: 0,
                enhancedContent: 0,
                lastReset: new Date().toISOString()
            };
        };
        
        TerraEthicalLayer.prototype.generateEthicalReport = function() {
            return {
                systemInfo: {
                    version: this.version,
                    author: this.author,
                    did: this.did,
                    timestamp: new Date().toISOString()
                },
                coreValues: this.coreValues,
                statistics: this.detoxStats,
                filtersActive: {
                    childSafety: Object.keys(this.childSafetyFilters).length,
                    detoxification: Object.keys(this.detoxificationFilters).length
                }
            };
        };

        // TerraSemanticIntegration Main System
        function TerraSemanticIntegration() {
            this.version = "2.0-Ultimate-Integrated";
            this.author = "–ê–±–¥—É–∫–∞—Ä–∏–º–æ–≤ –ê–±–¥—É—Ä–∞—à–∏–¥ –ê–±–¥—É–ª—Ö–∞–º–∏—Ç–æ–≤–∏—á";
            this.did = "aiuz:did:aiuz:stakeholder:abdukarimov_aaahash1234567890";
            
            this.l0Kernel = null;
            this.offlineAnalyzer = null;
            this.ethicalLayer = null;
            this.archiveManager = null;
            
            this.browserCapabilities = {};
            this.currentLevel = 0;
            this.integrationStats = {
                totalProcessed: 0,
                semanticAnalyses: 0,
                ethicalChecks: 0,
                archiveOperations: 0,
                lastActivity: null
            };
            
            this.initialize();
        }
        
        TerraSemanticIntegration.prototype.initialize = function() {
            console.log("üß¨ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Terra Semantic Integration Ultimate...");
            
            try {
                this.detectBrowserCapabilities();
                this.determineArchitectureLevel();
                this.initializeComponents();
                this.setupIntegration();
                this.verifySystemReadiness();
                
                console.log("‚úÖ Terra Semantic Integration Ultimate –≥–æ—Ç–æ–≤–∞ (L" + this.currentLevel + ")");
                this.updateUI();
                
            } catch (error) {
                console.error("‚ùå –û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏:", error);
                this.fallbackToMinimalMode();
            }
        };
        
        TerraSemanticIntegration.prototype.detectBrowserCapabilities = function() {
            this.browserCapabilities = {
                es3Support: typeof Array.prototype.indexOf !== 'undefined',
                es5Support: typeof JSON !== 'undefined',
                es6Support: typeof Promise !== 'undefined',
                
                estimatedRAM: this.estimateAvailableRAM(),
                processingPower: this.estimateProcessingPower(),
                
                localStorageSupport: typeof localStorage !== 'undefined',
                indexedDBSupport: typeof indexedDB !== 'undefined',
                
                offlineCapable: typeof navigator.onLine !== 'undefined',
                webWorkersSupport: typeof Worker !== 'undefined',
                
                isOldBrowser: this.isOldBrowser(),
                browserFamily: this.detectBrowserFamily(),
                
                screenSize: {
                    width: window.screen ? window.screen.width : 800,
                    height: window.screen ? window.screen.height : 600
                }
            };
        };
        
        TerraSemanticIntegration.prototype.estimateAvailableRAM = function() {
            try {
                if (navigator.deviceMemory) {
                    return navigator.deviceMemory * 1024;
                }
                
                var ua = navigator.userAgent.toLowerCase();
                if (ua.indexOf('mobile') !== -1) return 512;
                if (ua.indexOf('tablet') !== -1) return 1024;
                if (this.isOldBrowser()) return 256;
                
                return 2048;
            } catch (e) {
                return 128;
            }
        };
        
        TerraSemanticIntegration.prototype.estimateProcessingPower = function() {
            var start = new Date().getTime();
            var iterations = 100000;
            
            for (var i = 0; i < iterations; i++) {
                Math.sqrt(i);
            }
            
            var duration = new Date().getTime() - start;
            
            if (duration < 50) return 'fast';
            if (duration < 200) return 'medium';
            return 'slow';
        };
        
        TerraSemanticIntegration.prototype.isOldBrowser = function() {
            var ua = navigator.userAgent.toLowerCase();
            return (ua.indexOf('msie') !== -1 && (ua.indexOf('msie 6') !== -1 || ua.indexOf('msie 7') !== -1)) ||
                   (ua.indexOf('netscape') !== -1) ||
                   (typeof Array.prototype.indexOf === 'undefined');
        };
        
        TerraSemanticIntegration.prototype.detectBrowserFamily = function() {
            var ua = navigator.userAgent.toLowerCase();
            if (ua.indexOf('msie') !== -1) return 'internet_explorer';
            if (ua.indexOf('firefox') !== -1) return 'firefox';
            if (ua.indexOf('chrome') !== -1) return 'chrome';
            if (ua.indexOf('safari') !== -1) return 'safari';
            if (ua.indexOf('opera') !== -1) return 'opera';
            if (ua.indexOf('netscape') !== -1) return 'netscape';
            return 'unknown';
        };
        
        TerraSemanticIntegration.prototype.determineArchitectureLevel = function() {
            var caps = this.browserCapabilities;
            
            if (caps.isOldBrowser || caps.estimatedRAM < 256 || !caps.es3Support) {
                this.currentLevel = 0;
                return;
            }
            
            if (caps.es5Support && caps.localStorageSupport && caps.estimatedRAM >= 512) {
                this.currentLevel = 1;
                
                if (caps.es6Support && caps.indexedDBSupport && caps.estimatedRAM >= 2048) {
                    this.currentLevel = 2;
                    
                    if (caps.webWorkersSupport && caps.processingPower === 'fast' && caps.estimatedRAM >= 4096) {
                        this.currentLevel = 3;
                    }
                }
            }
        };
        
        TerraSemanticIntegration.prototype.initializeComponents = function() {
            console.log("üîß –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –¥–ª—è —É—Ä–æ–≤–Ω—è L" + this.currentLevel);
            
            try {
                this.l0Kernel = new L0SemanticKernel();
                console.log("‚úÖ L0 SemanticKernel –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω");
                
                if (this.currentLevel >= 1) {
                    this.offlineAnalyzer = new OfflineSemanticAnalyzer();
                    console.log("‚úÖ Offline Semantic Analyzer –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω");
                }
                
                this.ethicalLayer = new TerraEthicalLayer();
                console.log("‚úÖ Terra Ethical Layer –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω");
                
                this.archiveManager = this.createArchiveManager();
                console.log("‚úÖ Archive Manager —Å–æ–∑–¥–∞–Ω –¥–ª—è L" + this.currentLevel);
                
            } catch (error) {
                console.error("‚ùå –û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤:", error);
            }
        };
        
        TerraSemanticIntegration.prototype.createArchiveManager = function() {
            var manager = {
                level: this.currentLevel,
                archives: this.loadData('terra_archives_ultimate') || [],
                thesaurus: this.loadData('terra_thesaurus_ultimate') || [],
                encyclopedia: this.loadData('terra_encyclopedia_ultimate') || [],
                
                archive: function(data) {
                    var archiveEntry = {
                        id: Date.now() + Math.random(),
                        timestamp: new Date().toISOString(),
                        data: data,
                        size: JSON.stringify(data).length,
                        level: terraSystem.currentLevel
                    };
                    
                    this.archives.push(archiveEntry);
                    terraSystem.saveData('terra_archives_ultimate', this.archives);
                    
                    if (this.archives.length > (terraSystem.currentLevel === 0 ? 50 : 500)) {
                        this.archives = this.archives.slice(-(terraSystem.currentLevel === 0 ? 50 : 500));
                    }
                    
                    return archiveEntry;
                },
                
                retrieve: function(query) {
                    var results = [];
                    for (var i = 0; i < this.archives.length; i++) {
                        var item = this.archives[i];
                        if (JSON.stringify(item.data).toLowerCase().indexOf(query.toLowerCase()) !== -1) {
                            results.push(item);
                        }
                    }
                    return results;
                },
                
                semanticSearch: function(query, analyzer) {
                    if (!analyzer || !this.archives.length) return [];
                    
                    var queryAnalysis = analyzer.analyzeText(query);
                    var results = [];
                    
                    for (var i = 0; i < this.archives.length; i++) {
                        var item = this.archives[i];
                        var itemText = JSON.stringify(item.data);
                        var itemAnalysis = analyzer.analyzeText(itemText);
                        
                        var similarity = this.calculateConceptSimilarity(
                            queryAnalysis.concepts, 
                            itemAnalysis.concepts
                        );
                        
                        if (similarity > 0.3) {
                            results.push({
                                item: item,
                                similarity: similarity,
                                matchedConcepts: this.getMatchedConcepts(
                                    queryAnalysis.concepts, 
                                    itemAnalysis.concepts
                                )
                            });
                        }
                    }
                    
                    return results.sort(function(a, b) { 
                        return b.similarity - a.similarity; 
                    });
                },
                
                calculateConceptSimilarity: function(concepts1, concepts2) {
                    if (!concepts1.length || !concepts2.length) return 0;
                    
                    var matches = 0;
                    for (var i = 0; i < concepts1.length; i++) {
                        for (var j = 0; j < concepts2.length; j++) {
                            if (concepts1[i].concept === concepts2[j].concept) {
                                matches++;
                                break;
                            }
                        }
                    }
                    
                    return matches / Math.max(concepts1.length, concepts2.length);
                },
                
                getMatchedConcepts: function(concepts1, concepts2) {
                    var matched = [];
                    for (var i = 0; i < concepts1.length; i++) {
                        for (var j = 0; j < concepts2.length; j++) {
                            if (concepts1[i].concept === concepts2[j].concept) {
                                matched.push(concepts1[i].concept);
                                break;
                            }
                        }
                    }
                    return matched;
                }
            };
            
            return manager;
        };
        
        TerraSemanticIntegration.prototype.setupIntegration = function() {
            var self = this;
            
            // Prevent data loss on page close
            window.addEventListener('beforeunload', function(e) {
                self.saveAllData();
            });
            
            // Auto-save every 30 seconds
            setInterval(function() {
                self.saveAllData();
            }, 30000);
        };
        
        TerraSemanticIntegration.prototype.verifySystemReadiness = function() {
            var ready = !!(this.l0Kernel && this.ethicalLayer && this.archiveManager);
            
            if (ready) {
                this.showSaveStatus('saved');
                console.log("üöÄ Terra Ultimate System –ø–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤–∞ –∫ —Ä–∞–±–æ—Ç–µ!");
            } else {
                console.warn("‚ö†Ô∏è –°–∏—Å—Ç–µ–º–∞ –Ω–µ –ø–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤–∞");
            }
            
            return ready;
        };
        
        TerraSemanticIntegration.prototype.processArchiveRequest = function(text, files, userDid) {
            this.integrationStats.totalProcessed++;
            this.integrationStats.lastActivity = new Date().toISOString();
            
            var result = {
                timestamp: new Date().toISOString(),
                level: this.currentLevel,
                userDid: userDid,
                originalRequest: text,
                files: files || [],
                
                ethicalValidation: null,
                semanticAnalysis: null,
                archiveResult: null,
                
                success: false,
                errors: [],
                warnings: []
            };
            
            try {
                // 1. Ethical check
                if (this.ethicalLayer) {
                    result.ethicalValidation = this.ethicalLayer.validateContent(text, {
                        archiveMode: true,
                        userDid: userDid
                    });
                    this.integrationStats.ethicalChecks++;
                    
                    if (!result.ethicalValidation.passed) {
                        result.errors.push("–≠—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–µ –ø—Ä–æ–π–¥–µ–Ω–∞");
                        return result;
                    }
                }
                
                // 2. Semantic analysis
                if (this.currentLevel >= 1 && this.offlineAnalyzer) {
                    result.semanticAnalysis = this.offlineAnalyzer.analyzeText(text);
                    this.integrationStats.semanticAnalyses++;
                } else if (this.l0Kernel) {
                    result.semanticAnalysis = {
                        keywords: this.l0Kernel.extractKeywords(text),
                        intent: this.l0Kernel.simpleIntentAnalysis(text),
                        level: 0
                    };
                    this.integrationStats.semanticAnalyses++;
                }
                
                // 3. Archive
                if (this.archiveManager) {
                    var archiveData = {
                        text: result.ethicalValidation ? result.ethicalValidation.processedContent : text,
                        semantics: result.semanticAnalysis,
                        files: files,
                        metadata: {
                            author: this.author,
                            did: this.did,
                            level: this.currentLevel,
                            timestamp: result.timestamp
                        }
                    };
                    
                    var archived = this.archiveManager.archive(archiveData);
                    result.archiveResult = {
                        archived: true,
                        id: archived.id,
                        dataSize: archived.size,
                        method: "level_" + this.currentLevel
                    };
                    this.integrationStats.archiveOperations++;
                }
                
                result.success = true;
                this.updateAllUI();
                
            } catch (error) {
                result.errors.push("–û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏: " + error.message);
                console.error("‚ùå –û—à–∏–±–∫–∞ –≤ processArchiveRequest:", error);
            }
            
            return result;
        };
        
        TerraSemanticIntegration.prototype.searchArchive = function(query, options) {
            options = options || {};
            
            var searchResult = {
                timestamp: new Date().toISOString(),
                query: query,
                level: this.currentLevel,
                results: [],
                totalFound: 0,
                searchMethod: "",
                processingTime: 0
            };
            
            var startTime = new Date().getTime();
            
            try {
                if (this.currentLevel >= 1 && this.archiveManager.semanticSearch && this.offlineAnalyzer) {
                    searchResult.results = this.archiveManager.semanticSearch(query, this.offlineAnalyzer);
                    searchResult.searchMethod = "semantic_L" + this.currentLevel;
                } else if (this.archiveManager) {
                    searchResult.results = this.archiveManager.retrieve(query);
                    searchResult.searchMethod = "simple_L" + this.currentLevel;
                }
                
                searchResult.totalFound = searchResult.results.length;
                
            } catch (error) {
                console.error("‚ùå –û—à–∏–±–∫–∞ –ø–æ–∏—Å–∫–∞:", error);
                searchResult.error = error.message;
            }
            
            searchResult.processingTime = new Date().getTime() - startTime;
            return searchResult;
        };
        
        TerraSemanticIntegration.prototype.loadData = function(key) {
            try {
                var data = localStorage.getItem(key);
                return data ? JSON.parse(data) : null;
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ ' + key + ':', error);
                return null;
            }
        };
        
        TerraSemanticIntegration.prototype.saveData = function(key, data) {
            try {
                localStorage.setItem(key, JSON.stringify(data));
                localStorage.setItem(key + '_timestamp', new Date().toISOString());
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è ' + key + ':', error);
            }
        };
        
        TerraSemanticIntegration.prototype.saveAllData = function() {
            if (this.archiveManager) {
                this.saveData('terra_archives_ultimate', this.archiveManager.archives);
                this.saveData('terra_thesaurus_ultimate', this.archiveManager.thesaurus);
                this.saveData('terra_encyclopedia_ultimate', this.archiveManager.encyclopedia);
            }
            this.saveData('terra_integration_stats', this.integrationStats);
        };
        
        TerraSemanticIntegration.prototype.updateUI = function() {
            // Update system level indicator
            var levelElement = document.getElementById('systemLevel');
            var levelNames = ['L0 - Pentium I Compatible', 'L1 - Enhanced', 'L2 - Advanced', 'L3+ - Maximum'];
            var levelClasses = ['level-0', 'level-1', 'level-2', 'level-3'];
            
            if (levelElement) {
                levelElement.className = 'system-level-indicator ' + levelClasses[this.currentLevel];
                levelElement.textContent = 'üß¨ ' + levelNames[this.currentLevel];
            }
            
            // Update capabilities text
            var capabilities = [];
            if (this.currentLevel >= 1) capabilities.push('–°–µ–º–∞–Ω—Ç–∏–∫–∞');
            if (this.currentLevel >= 2) capabilities.push('–†–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ');
            if (this.currentLevel >= 3) capabilities.push('–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞');
            
            var capsElement = document.getElementById('systemCapabilities');
            if (capsElement) {
                capsElement.textContent = 'üéØ ' + (capabilities.length ? capabilities.join(' + ') : '–ë–∞–∑–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏');
            }
            
            // Update compatibility mode
            var compatElement = document.getElementById('compatibilityMode');
            if (compatElement) {
                var compatibility = this.browserCapabilities.isOldBrowser ? 'Legacy' : 'Modern';
                compatElement.textContent = '‚ö° ' + compatibility + ' —Ä–µ–∂–∏–º';
            }
            
            // Update status indicators
            document.getElementById('currentLevel').textContent = 'üß¨ L' + this.currentLevel;
            document.getElementById('currentLevelNumber').textContent = this.currentLevel;
            document.getElementById('analyzerStatus').textContent = this.offlineAnalyzer ? '‚úÖ –ê–∫—Ç–∏–≤–µ–Ω' : '‚ö†Ô∏è L0 —Ä–µ–∂–∏–º';
            document.getElementById('ethicalStatus').textContent = '‚úÖ –í–∫–ª—é—á–µ–Ω';
            document.getElementById('offlineStatus').textContent = '‚úÖ –ü–æ–ª–Ω–∞—è';
            
            // Update statistics
            if (this.archiveManager) {
                document.getElementById('totalFiles').textContent = this.archiveManager.archives.length;
                document.getElementById('totalSize').textContent = this.formatFileSize(
                    this.archiveManager.archives.reduce(function(sum, item) { return sum + item.size; }, 0)
                );
                document.getElementById('totalWords').textContent = this.archiveManager.thesaurus.length;
                document.getElementById('totalConcepts').textContent = this.archiveManager.encyclopedia.length;
            }
            
            document.getElementById('semanticAnalyses').textContent = this.integrationStats.semanticAnalyses;
            document.getElementById('ethicalChecks').textContent = this.integrationStats.ethicalChecks;
            
            var lastSave = localStorage.getItem('terra_archives_ultimate_timestamp');
            if (lastSave) {
                document.getElementById('lastSave').textContent = new Date(lastSave).toLocaleString();
            }
        };
        
        TerraSemanticIntegration.prototype.updateAllUI = function() {
            this.updateUI();
            this.updateArchivesList();
            this.updateTabCounts();
        };
        
        TerraSemanticIntegration.prototype.updateArchivesList = function() {
            var container = document.getElementById('archivesList');
            if (!container || !this.archiveManager) return;
            
            var archives = this.archiveManager.archives;
            container.innerHTML = '';
            
            if (archives.length === 0) {
                container.innerHTML = '<div class="text-center py-12 text-gray-500"><div class="text-6xl mb-6">üìÇ</div><h3 class="text-xl font-semibold mb-2">–ê—Ä—Ö–∏–≤–æ–≤ –ø–æ–∫–∞ –Ω–µ—Ç</h3><p>–ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–∞–π–ª—ã –¥–ª—è –Ω–∞—á–∞–ª–∞ —Ä–∞–±–æ—Ç—ã —Å Terra Ultimate</p></div>';
                return;
            }

            for (var i = archives.length - 1; i >= Math.max(0, archives.length - 10); i--) {
                var archive = archives[i];
                var archiveElement = document.createElement('div');
                archiveElement.className = 'archive-item';
                
                var semanticInfo = '';
                if (archive.data && archive.data.semantics && archive.data.semantics.concepts) {
                    var concepts = archive.data.semantics.concepts.slice(0, 3).map(function(c) { return c.concept; });
                    if (concepts.length > 0) {
                        semanticInfo = '<div class="mt-2"><span class="text-sm text-gray-600">üß† –ö–æ–Ω—Ü–µ–ø—Ü–∏–∏: </span>' +
                                     concepts.map(function(c) { return '<span class="semantic-tag">' + c + '</span>'; }).join('') +
                                     '</div>';
                    }
                }
                
                archiveElement.innerHTML = 
                    '<div class="flex justify-between items-start">' +
                        '<div class="flex-1">' +
                            '<h4 class="font-semibold text-gray-800 mb-1">üì¶ –ê—Ä—Ö–∏–≤ #' + archive.id.toString().slice(-6) + '</h4>' +
                            '<p class="text-sm text-gray-600 mb-2">' + new Date(archive.timestamp).toLocaleString() + '</p>' +
                            '<p class="text-sm text-gray-700 line-clamp-2">' + (archive.data.text || '–§–∞–π–ª–æ–≤—ã–π –∞—Ä—Ö–∏–≤').slice(0, 100) + '...</p>' +
                            semanticInfo +
                        '</div>' +
                        '<div class="text-right ml-4">' +
                            '<div class="text-sm text-gray-500">' + (terraSystem && terraSystem.formatFileSize ? terraSystem.formatFileSize(archive.size) : archive.size + ' B') + '</div>' +
                            '<div class="text-xs text-purple-600 font-semibold">L' + archive.level + '</div>' +
                        '</div>' +
                    '</div>';
                
                archiveElement.onclick = function(archive) {
                    return function() {
                        if (terraSystem && terraSystem.showArchiveDetails) {
                            terraSystem.showArchiveDetails(archive);
                        } else {
                            alert('Archive details not available');
                        }
                    };
                }(archive);
                
                container.appendChild(archiveElement);
            }
        };
        
        TerraSemanticIntegration.prototype.updateTabCounts = function() {
            if (this.archiveManager) {
                document.getElementById('archiveCount').textContent = this.archiveManager.archives.length;
                document.getElementById('thesaurusCount').textContent = this.archiveManager.thesaurus.length;
                document.getElementById('encyclopediaCount').textContent = this.archiveManager.encyclopedia.length;
            }
        };
        
        TerraSemanticIntegration.prototype.showArchiveDetails = function(archive) {
            var modal = document.getElementById('contentModal');
            var title = document.getElementById('modalTitle');
            var content = document.getElementById('modalContent');
            
            title.textContent = 'üì¶ –ê—Ä—Ö–∏–≤ #' + archive.id.toString().slice(-6);
            
            var details = '<div class="space-y-6">';
            details += '<div class="bg-gray-50 p-4 rounded-lg">';
            details += '<h4 class="font-semibold mb-2">üìä –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –∞—Ä—Ö–∏–≤–∞</h4>';
            details += '<div class="grid grid-cols-2 gap-4 text-sm">';
            details += '<div><strong>–°–æ–∑–¥–∞–Ω:</strong> ' + new Date(archive.timestamp).toLocaleString() + '</div>';
            details += '<div><strong>–†–∞–∑–º–µ—Ä:</strong> ' + this.formatFileSize(archive.size) + '</div>';
            details += '<div><strong>–£—Ä–æ–≤–µ–Ω—å:</strong> L' + archive.level + '</div>';
            details += '<div><strong>ID:</strong> ' + archive.id + '</div>';
            details += '</div></div>';
            
            if (archive.data.text) {
                details += '<div><h4 class="font-semibold mb-2">üìÑ –¢–µ–∫—Å—Ç–æ–≤–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ</h4>';
                details += '<div class="bg-white border border-gray-200 p-4 rounded-lg max-h-64 overflow-y-auto">';
                details += '<pre class="whitespace-pre-wrap text-sm">' + archive.data.text + '</pre></div></div>';
            }
            
            if (archive.data.semantics && archive.data.semantics.concepts) {
                details += '<div><h4 class="font-semibold mb-2">üß† –°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑</h4>';
                details += '<div class="bg-blue-50 p-4 rounded-lg">';
                details += '<h5 class="font-medium mb-2">–ö–æ–Ω—Ü–µ–ø—Ü–∏–∏:</h5>';
                details += '<div class="flex flex-wrap gap-2">';
                for (var i = 0; i < archive.data.semantics.concepts.length; i++) {
                    var concept = archive.data.semantics.concepts[i];
                    details += '<span class="semantic-tag">' + concept.concept + ' (' + concept.relevance + ')</span>';
                }
                details += '</div>';
                
                if (archive.data.semantics.summary) {
                    details += '<h5 class="font-medium mt-4 mb-2">–†–µ–∑—é–º–µ:</h5>';
                    details += '<p class="text-sm">' + archive.data.semantics.summary + '</p>';
                }
                details += '</div></div>';
            }
            
            if (archive.data.files && archive.data.files.length > 0) {
                details += '<div><h4 class="font-semibold mb-2">üìÅ –§–∞–π–ª—ã</h4>';
                details += '<div class="space-y-2">';
                for (var j = 0; j < archive.data.files.length; j++) {
                    var file = archive.data.files[j];
                    details += '<div class="bg-gray-50 p-3 rounded flex justify-between items-center">';
                    details += '<span class="font-medium">' + file.name + '</span>';
                    details += '<span class="text-sm text-gray-600">' + this.formatFileSize(file.size) + '</span>';
                    details += '</div>';
                }
                details += '</div></div>';
            }
            
            details += '</div>';
            
            content.innerHTML = details;
            modal.classList.remove('hidden');
        };
        
        TerraSemanticIntegration.prototype.showSaveStatus = function(status) {
            var indicator = document.getElementById('saveIndicator');
            if (!indicator) return;
            
            indicator.className = 'save-indicator ' + status;
            
            switch (status) {
                case 'saving':
                    indicator.innerHTML = 'üíæ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ...';
                    break;
                case 'saved':
                    indicator.innerHTML = '‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–æ';
                    break;
                case 'error':
                    indicator.innerHTML = '‚ùå –û—à–∏–±–∫–∞';
                    break;
            }
        };
        
        TerraSemanticIntegration.prototype.formatFileSize = function(bytes) {
            if (bytes === 0) return '0 B';
            var k = 1024;
            var sizes = ['B', 'KB', 'MB', 'GB'];
            var i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + ' ' + sizes[i];
        };
        
        TerraSemanticIntegration.prototype.fallbackToMinimalMode = function() {
            console.warn("‚ö†Ô∏è –ü–µ—Ä–µ—Ö–æ–¥ –≤ –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ä–µ–∂–∏–º");
            this.currentLevel = 0;
            this.l0Kernel = this.l0Kernel || new L0SemanticKernel();
            this.archiveManager = this.createArchiveManager();
            this.updateUI();
        };
        
        TerraSemanticIntegration.prototype.getSystemInfo = function() {
            return {
                version: this.version,
                author: this.author,
                did: this.did,
                currentLevel: this.currentLevel,
                browserCapabilities: this.browserCapabilities,
                componentsLoaded: {
                    l0Kernel: !!this.l0Kernel,
                    offlineAnalyzer: !!this.offlineAnalyzer,
                    ethicalLayer: !!this.ethicalLayer,
                    archiveManager: !!this.archiveManager
                },
                statistics: this.integrationStats
            };
        };

        // ===== MULTILINGUAL SYSTEM =====
        
        var terraLanguages = {
            uz: {
                mainTitle: "Terra Archive Manager 2.0 Ultimate - O'zbek-Deutsch Lug'at",
                mainSubtitle: "üß¨ L0-L7 Fraktal Sistema | üìö Semantik Arxivchi | üåê Universal Kirish | üîÑ Oflayn AI",
                systemCapabilities: "üéØ Imkoniyatlarni avtoaniqash",
                integratedEthics: "üî¨ Integratsiyalashgan Axloq",
                builtinThesaurus: "üìñ O'rnatilgan Tezaurus",
                compatibilityMode: "‚ö° Moslashuv rejimi",
                accessibilityMode: "‚ôø Qulaylik rejimi",
                highContrastBtn: "üîÜ Yuqori kontrast",
                largeTextBtn: "üîç Katta matn",
                screenReaderBtn: "üîä Ekran o'quvchisi",
                exportBtn: "üì§ Terra Eksport",
                importBtn: "üì• Terra Import",
                backupBtn: "üíæ Zaxira",
                compatibilityBtn: "üîç Sistema testi",
                dictionaryBtn: "üìñ O'zbek-Deutsch Lug'at",
                uploaderTitle: "üîÑ Universal Yuklovchi & Semantik Parser",
                dropzoneTitle: "Semantik arxivlash uchun har qanday fayllarni shu yerga tashlang",
                dropzoneDescription: "üì¶ Arxivlar: .zip, .rar, .7z, .tar, .gz<br>üìÑ Hujjatlar: .pdf, .docx, .txt, .md, .rtf, .odt<br>üìö Lug'atlar: .dict, .json, .xml, .csv<br>üíª Kod: .js, .py, .html, .css, .json<br>üñºÔ∏è Rasmlar: .jpg, .png, .gif, .svg<br>üß¨ + Axloqiy tekshiruv bilan avtomatik semantik tahlil"
            },
            ru: {
                mainTitle: "Terra Archive Manager 2.0 Ultimate",
                mainSubtitle: "üß¨ –§—Ä–∞–∫—Ç–∞–ª—å–Ω–∞—è –°–∏—Å—Ç–µ–º–∞ L0-L7 | üìö –°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –ê—Ä—Ö–∏–≤–∞—Ç–æ—Ä | üåê –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –î–æ—Å—Ç—É–ø | üîÑ –û—Ñ—Ñ–ª–∞–π–Ω –ò–ò",
                systemCapabilities: "üéØ –ê–≤—Ç–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π",
                integratedEthics: "üî¨ –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≠—Ç–∏–∫–∞",
                builtinThesaurus: "üìñ –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –¢–µ–∑–∞—É—Ä—É—Å",
                compatibilityMode: "‚ö° –†–µ–∂–∏–º —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏",
                accessibilityMode: "‚ôø –†–µ–∂–∏–º –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏",
                highContrastBtn: "üîÜ –í—ã—Å–æ–∫–∏–π –∫–æ–Ω—Ç—Ä–∞—Å—Ç",
                largeTextBtn: "üîç –ö—Ä—É–ø–Ω—ã–π —Ç–µ–∫—Å—Ç",
                screenReaderBtn: "üîä –≠–∫—Ä–∞–Ω–Ω—ã–π –¥–∏–∫—Ç–æ—Ä",
                exportBtn: "üì§ –≠–∫—Å–ø–æ—Ä—Ç Terra",
                importBtn: "üì• –ò–º–ø–æ—Ä—Ç Terra",
                backupBtn: "üíæ –ë—ç–∫–∞–ø",
                compatibilityBtn: "üîç –¢–µ—Å—Ç —Å–∏—Å—Ç–µ–º—ã",
                dictionaryBtn: "üìñ –£–∑–±–µ–∫—Å–∫–æ-–ù–µ–º–µ—Ü–∫–∏–π –°–ª–æ–≤–∞—Ä—å",
                uploaderTitle: "üîÑ –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –ó–∞–≥—Ä—É–∑—á–∏–∫ & –°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –ü–∞—Ä—Å–µ—Ä",
                dropzoneTitle: "–ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ –ª—é–±—ã–µ —Ñ–∞–π–ª—ã –¥–ª—è —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–≥–æ –∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–∏—è",
                dropzoneDescription: "üì¶ –ê—Ä—Ö–∏–≤—ã: .zip, .rar, .7z, .tar, .gz<br>üìÑ –î–æ–∫—É–º–µ–Ω—Ç—ã: .pdf, .docx, .txt, .md, .rtf, .odt<br>üìö –°–ª–æ–≤–∞—Ä–∏: .dict, .json, .xml, .csv<br>üíª –ö–æ–¥: .js, .py, .html, .css, .json<br>üñºÔ∏è –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è: .jpg, .png, .gif, .svg<br>üß¨ + –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ —Å —ç—Ç–∏—á–µ—Å–∫–æ–π –ø—Ä–æ–≤–µ—Ä–∫–æ–π"
            },
            en: {
                mainTitle: "Terra Archive Manager 2.0 Ultimate - Uzbek-German Dictionary",
                mainSubtitle: "üß¨ L0-L7 Fractal System | üìö Semantic Archiver | üåê Universal Access | üîÑ Offline AI",
                systemCapabilities: "üéØ Auto-capability detection",
                integratedEthics: "üî¨ Integrated Ethics",
                builtinThesaurus: "üìñ Built-in Thesaurus",
                compatibilityMode: "‚ö° Compatibility mode",
                accessibilityMode: "‚ôø Accessibility mode",
                highContrastBtn: "üîÜ High contrast",
                largeTextBtn: "üîç Large text",
                screenReaderBtn: "üîä Screen reader",
                exportBtn: "üì§ Export Terra",
                importBtn: "üì• Import Terra",
                backupBtn: "üíæ Backup",
                compatibilityBtn: "üîç System test",
                dictionaryBtn: "üìñ Uzbek-German Dictionary",
                uploaderTitle: "üîÑ Universal Uploader & Semantic Parser",
                dropzoneTitle: "Drop any files here for semantic archiving",
                dropzoneDescription: "üì¶ Archives: .zip, .rar, .7z, .tar, .gz<br>üìÑ Documents: .pdf, .docx, .txt, .md, .rtf, .odt<br>üìö Dictionaries: .dict, .json, .xml, .csv<br>üíª Code: .js, .py, .html, .css, .json<br>üñºÔ∏è Images: .jpg, .png, .gif, .svg<br>üß¨ + Automatic semantic analysis with ethical verification"
            },
            de: {
                mainTitle: "Terra Archive Manager 2.0 Ultimate - Usbekisch-Deutsches W√∂rterbuch",
                mainSubtitle: "üß¨ L0-L7 Fraktales System | üìö Semantischer Archivierer | üåê Universeller Zugang | üîÑ Offline KI",
                systemCapabilities: "üéØ Auto-F√§higkeitserkennung",
                integratedEthics: "üî¨ Integrierte Ethik",
                builtinThesaurus: "üìñ Eingebauter Thesaurus",
                compatibilityMode: "‚ö° Kompatibilit√§tsmodus",
                accessibilityMode: "‚ôø Barrierefreiheitsmodus",
                highContrastBtn: "üîÜ Hoher Kontrast",
                largeTextBtn: "üîç Gro√üer Text",
                screenReaderBtn: "üîä Bildschirmleser",
                exportBtn: "üì§ Terra Exportieren",
                importBtn: "üì• Terra Importieren",
                backupBtn: "üíæ Sicherung",
                compatibilityBtn: "üîç Systemtest",
                dictionaryBtn: "üìñ Usbekisch-Deutsches W√∂rterbuch",
                uploaderTitle: "üîÑ Universeller Uploader & Semantischer Parser",
                dropzoneTitle: "Dateien hier f√ºr semantische Archivierung ablegen",
                dropzoneDescription: "üì¶ Archive: .zip, .rar, .7z, .tar, .gz<br>üìÑ Dokumente: .pdf, .docx, .txt, .md, .rtf, .odt<br>üìö W√∂rterb√ºcher: .dict, .json, .xml, .csv<br>üíª Code: .js, .py, .html, .css, .json<br>üñºÔ∏è Bilder: .jpg, .png, .gif, .svg<br>üß¨ + Automatische semantische Analyse mit ethischer Pr√ºfung"
            }
        };
        
        var currentLanguage = 'ru';
        
        function switchLanguage(lang) {
            currentLanguage = lang;
            var translations = terraLanguages[lang];
            
            // Update all translatable elements
            for (var key in translations) {
                var element = document.getElementById(key);
                if (element) {
                    if (key.includes('Description')) {
                        element.innerHTML = translations[key];
                    } else {
                        element.textContent = translations[key];
                    }
                }
            }
            
            // Update dropzone content
            var dropzoneTitle = document.querySelector('#dropZone h3');
            var dropzoneDesc = document.querySelector('#dropZone p');
            if (dropzoneTitle) dropzoneTitle.textContent = translations.dropzoneTitle;
            if (dropzoneDesc) dropzoneDesc.innerHTML = translations.dropzoneDescription;
            
            // Save language preference
            if (typeof localStorage !== 'undefined') {
                localStorage.setItem('terraLanguage', lang);
            }
            
            // Update page title
            document.title = translations.mainTitle;
            
            console.log('üåê Language switched to:', lang);
        }
        
        // Load saved language on startup
        function loadSavedLanguage() {
            try {
                var saved = localStorage.getItem('terraLanguage');
                if (saved && terraLanguages[saved]) {
                    currentLanguage = saved;
                    document.getElementById('languageSelector').value = saved;
                    switchLanguage(saved);
                }
            } catch (e) {
                console.log('No saved language preference');
            }
        }
        
        // ===== ACCESSIBILITY FUNCTIONS =====
        
        var accessibilityState = {
            highContrast: false,
            largeText: false,
            screenReader: false
        };
        
        function toggleHighContrast() {
            accessibilityState.highContrast = !accessibilityState.highContrast;
            document.body.classList.toggle('high-contrast', accessibilityState.highContrast);
            
            if (accessibilityState.highContrast) {
                document.body.style.filter = 'contrast(200%) brightness(150%)';
            } else {
                document.body.style.filter = '';
            }
            
            saveAccessibilitySettings();
            announceToScreenReader(accessibilityState.highContrast ? '–í—ã—Å–æ–∫–∏–π –∫–æ–Ω—Ç—Ä–∞—Å—Ç –≤–∫–ª—é—á–µ–Ω' : '–í—ã—Å–æ–∫–∏–π –∫–æ–Ω—Ç—Ä–∞—Å—Ç –≤—ã–∫–ª—é—á–µ–Ω');
        }
        
        function toggleLargeText() {
            accessibilityState.largeText = !accessibilityState.largeText;
            document.body.classList.toggle('large-text', accessibilityState.largeText);
            
            if (accessibilityState.largeText) {
                document.body.style.fontSize = '120%';
            } else {
                document.body.style.fontSize = '';
            }
            
            saveAccessibilitySettings();
            announceToScreenReader(accessibilityState.largeText ? '–ö—Ä—É–ø–Ω—ã–π —Ç–µ–∫—Å—Ç –≤–∫–ª—é—á–µ–Ω' : '–ö—Ä—É–ø–Ω—ã–π —Ç–µ–∫—Å—Ç –≤—ã–∫–ª—é—á–µ–Ω');
        }
        
        function toggleScreenReader() {
            accessibilityState.screenReader = !accessibilityState.screenReader;
            
            // Add aria-live regions if screen reader is enabled
            if (accessibilityState.screenReader) {
                if (!document.getElementById('aria-announcements')) {
                    var announcer = document.createElement('div');
                    announcer.id = 'aria-announcements';
                    announcer.setAttribute('aria-live', 'polite');
                    announcer.setAttribute('aria-atomic', 'true');
                    announcer.style.position = 'absolute';
                    announcer.style.left = '-10000px';
                    announcer.style.width = '1px';
                    announcer.style.height = '1px';
                    announcer.style.overflow = 'hidden';
                    document.body.appendChild(announcer);
                }
                announceToScreenReader('–≠–∫—Ä–∞–Ω–Ω—ã–π –¥–∏–∫—Ç–æ—Ä –≤–∫–ª—é—á–µ–Ω. Terra Archive Manager –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ.');
            } else {
                var announcer = document.getElementById('aria-announcements');
                if (announcer) {
                    announcer.remove();
                }
            }
            
            saveAccessibilitySettings();
        }
        
        function announceToScreenReader(message) {
            if (accessibilityState.screenReader) {
                var announcer = document.getElementById('aria-announcements');
                if (announcer) {
                    announcer.textContent = message;
                    // Also speak using Web Speech API if available
                    if ('speechSynthesis' in window) {
                        var utterance = new SpeechSynthesisUtterance(message);
                        utterance.lang = currentLanguage === 'uz' ? 'uz-UZ' : 
                                       currentLanguage === 'de' ? 'de-DE' : 
                                       currentLanguage === 'en' ? 'en-US' : 'ru-RU';
                        speechSynthesis.speak(utterance);
                    }
                }
            }
        }
        
        function saveAccessibilitySettings() {
            try {
                localStorage.setItem('terraAccessibility', JSON.stringify(accessibilityState));
            } catch (e) {
                console.log('Could not save accessibility settings');
            }
        }
        
        function loadAccessibilitySettings() {
            try {
                var saved = localStorage.getItem('terraAccessibility');
                if (saved) {
                    var settings = JSON.parse(saved);
                    if (settings.highContrast) toggleHighContrast();
                    if (settings.largeText) toggleLargeText();
                    if (settings.screenReader) toggleScreenReader();
                }
            } catch (e) {
                console.log('No saved accessibility settings');
            }
        }
        
        // ===== DICTIONARY MODE =====
        
        function openDictionaryMode() {
            var modal = document.getElementById('contentModal');
            var title = document.getElementById('modalTitle');
            var content = document.getElementById('modalContent');
            
            title.textContent = 'üìñ O\'zbek-Deutsch Lug\'at / –£–∑–±–µ–∫—Å–∫–æ-–ù–µ–º–µ—Ü–∫–∏–π –°–ª–æ–≤–∞—Ä—å';
            
            var dictionaryHTML = `
                <div class="space-y-6">
                    <div class="bg-gradient-to-r from-green-50 to-blue-50 p-6 rounded-lg border-2 border-green-200">
                        <h3 class="text-xl font-bold text-green-800 mb-4">üåç Inklyuziv Lug'at / –ò–Ω–∫–ª—é–∑–∏–≤–Ω—ã–π –°–ª–æ–≤–∞—Ä—å</h3>
                        <p class="text-green-700 mb-4">Bu lug'at har bir inson uchun, jumladan ko'rmaydigan, eshitmaydigan, harakat qilishda qiyinchilik bor bolalar uchun ham mo'ljallangan.</p>
                        <p class="text-green-700 mb-4">–≠—Ç–æ—Ç —Å–ª–æ–≤–∞—Ä—å –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è –≤—Å–µ—Ö –ª—é–¥–µ–π, –≤–∫–ª—é—á–∞—è —Å–ª–µ–ø–æ–≥–ª—É—Ö–æ–Ω–µ–º—ã—Ö –¥–µ—Ç–µ–π —Å —Å–∏–Ω–¥—Ä–æ–º–æ–º –î–∞—É–Ω–∞ –∏ –î–¶–ü.</p>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mt-6">
                            <div class="bg-white p-4 rounded-lg border border-green-200">
                                <h4 class="font-bold text-green-800 mb-3">üá∫üáø O'zbek so'zlari</h4>
                                <div class="space-y-2">
                                    <div class="p-2 bg-green-50 rounded">
                                        <strong>salom</strong> ‚Üí <em>Hallo, Guten Tag</em>
                                        <div class="text-xs text-green-600 mt-1">‚ôø Audio: /sa-lom/ | üëÅÔ∏è Visual: üëã</div>
                                    </div>
                                    <div class="p-2 bg-green-50 rounded">
                                        <strong>kitob</strong> ‚Üí <em>Buch</em>
                                        <div class="text-xs text-green-600 mt-1">‚ôø Audio: /ki-tob/ | üëÅÔ∏è Visual: üìñ</div>
                                    </div>
                                    <div class="p-2 bg-green-50 rounded">
                                        <strong>maktab</strong> ‚Üí <em>Schule</em>
                                        <div class="text-xs text-green-600 mt-1">‚ôø Audio: /mak-tab/ | üëÅÔ∏è Visual: üè´</div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="bg-white p-4 rounded-lg border border-blue-200">
                                <h4 class="font-bold text-blue-800 mb-3">üá©üá™ Deutsche W√∂rter</h4>
                                <div class="space-y-2">
                                    <div class="p-2 bg-blue-50 rounded">
                                        <strong>Hallo</strong> ‚Üí <em>salom</em>
                                        <div class="text-xs text-blue-600 mt-1">‚ôø Audio: /ha-lo/ | üëÅÔ∏è Visual: üëã</div>
                                    </div>
                                    <div class="p-2 bg-blue-50 rounded">
                                        <strong>Buch</strong> ‚Üí <em>kitob</em>
                                        <div class="text-xs text-blue-600 mt-1">‚ôø Audio: /bukh/ | üëÅÔ∏è Visual: üìñ</div>
                                    </div>
                                    <div class="p-2 bg-blue-50 rounded">
                                        <strong>Schule</strong> ‚Üí <em>maktab</em>
                                        <div class="text-xs text-blue-600 mt-1">‚ôø Audio: /shu-le/ | üëÅÔ∏è Visual: üè´</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="mt-6 p-4 bg-yellow-50 rounded-lg border border-yellow-200">
                            <h4 class="font-bold text-yellow-800 mb-2">‚ôø Qo'shimcha imkoniyatlar / –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏</h4>
                            <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                                <button onclick="speakWord('salom', 'uz')" class="bg-green-500 text-white p-2 rounded hover:bg-green-600 transition-colors">
                                    üîä Tinglash / –°–ª—É—à–∞—Ç—å
                                </button>
                                <button onclick="showBraille('salom')" class="bg-blue-500 text-white p-2 rounded hover:bg-blue-600 transition-colors">
                                    ‚††‚†É‚†ó‚†Å‚†ä‚†á‚†á‚†ë Braille
                                </button>
                                <button onclick="showSignLanguage('salom')" class="bg-purple-500 text-white p-2 rounded hover:bg-purple-600 transition-colors">
                                    ü§ü Imo-ishora / –ñ–µ—Å—Ç—ã
                                </button>
                                <button onclick="showPictograms('salom')" class="bg-pink-500 text-white p-2 rounded hover:bg-pink-600 transition-colors">
                                    üñºÔ∏è Piktogramma
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-gray-50 p-6 rounded-lg">
                        <h3 class="text-xl font-bold text-gray-800 mb-4">üåç Global Accessibility Standards</h3>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                            <div class="text-center p-4 bg-white rounded-lg">
                                <div class="text-3xl mb-2">üá¨üá≠</div>
                                <h4 class="font-bold">Ghana Standards</h4>
                                <p class="text-sm text-gray-600">Local language support with cultural context</p>
                            </div>
                            <div class="text-center p-4 bg-white rounded-lg">
                                <div class="text-3xl mb-2">üèûÔ∏è</div>
                                <h4 class="font-bold">Indigenous Methods</h4>
                                <p class="text-sm text-gray-600">Traditional learning approaches</p>
                            </div>
                            <div class="text-center p-4 bg-white rounded-lg">
                                <div class="text-3xl mb-2">‚ôø</div>
                                <h4 class="font-bold">Universal Access</h4>
                                <p class="text-sm text-gray-600">For all abilities and disabilities</p>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            content.innerHTML = dictionaryHTML;
            modal.classList.remove('hidden');
            
            announceToScreenReader('–û—Ç–∫—Ä—ã—Ç —Ä–µ–∂–∏–º —É–∑–±–µ–∫—Å–∫–æ-–Ω–µ–º–µ—Ü–∫–æ–≥–æ —Å–ª–æ–≤–∞—Ä—è');
        }
        
        function speakWord(word, lang) {
            if ('speechSynthesis' in window) {
                var utterance = new SpeechSynthesisUtterance(word);
                utterance.lang = lang === 'uz' ? 'uz-UZ' : 'de-DE';
                utterance.rate = 0.7; // Slower for learning
                speechSynthesis.speak(utterance);
                announceToScreenReader('–ü—Ä–æ–∏–∑–Ω–æ—à–µ–Ω–∏–µ —Å–ª–æ–≤–∞: ' + word);
            } else {
                alert('üîä Audio: /' + word + '/');
            }
        }
        
        function showBraille(word) {
            var brailleMap = {
                'salom': '‚†é‚†Å‚†á‚†ï‚†ç',
                'kitob': '‚†Ö‚†ä‚†û‚†ï‚†É',
                'maktab': '‚†ç‚†Å‚†Ö‚†û‚†Å‚†É'
            };
            var braille = brailleMap[word] || '‚††‚†É‚†ó‚†Å‚†ä‚†á‚†á‚†ë';
            alert('‚††‚†É‚†ó‚†Å‚†ä‚†á‚†á‚†ë ' + word + ': ' + braille);
            announceToScreenReader('–ë—Ä–∞–π–ª—å –¥–ª—è —Å–ª–æ–≤–∞ ' + word + ': ' + braille);
        }
        
        function showSignLanguage(word) {
            alert('ü§ü Imo-ishora / –ñ–µ—Å—Ç–æ–≤—ã–π —è–∑—ã–∫ –¥–ª—è "' + word + '": –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤–∏–¥–µ–æ-—Ä–µ—Å—É—Ä—Å—ã –∏–ª–∏ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—é –∂–µ—Å—Ç–æ–≤');
            announceToScreenReader('–ü–æ–∫–∞–∑–∞–Ω—ã –∂–µ—Å—Ç—ã –¥–ª—è —Å–ª–æ–≤–∞: ' + word);
        }
        
        function showPictograms(word) {
            var pictogramMap = {
                'salom': 'üëã',
                'kitob': 'üìñ',
                'maktab': 'üè´'
            };
            var pictogram = pictogramMap[word] || 'üñºÔ∏è';
            alert('üñºÔ∏è Piktogramma / –ü–∏–∫—Ç–æ–≥—Ä–∞–º–º–∞ "' + word + '": ' + pictogram);
            announceToScreenReader('–ü–∏–∫—Ç–æ–≥—Ä–∞–º–º–∞ –¥–ª—è —Å–ª–æ–≤–∞ ' + word + ': ' + pictogram);
        }
        
        // ===== GLOBAL SYSTEM INITIALIZATION =====
        
        var terraSystem = null;
        
        // Initialize terraSystem safely
        try {
            terraSystem = new TerraSemanticIntegration();
            window.terraSystem = terraSystem; // Make it globally accessible
        } catch (error) {
            console.error("‚ùå Failed to initialize terraSystem:", error);
            // Create minimal fallback system
            terraSystem = {
                currentLevel: 0,
                did: "aiuz:did:aiuz:stakeholder:abdukarimov_aaahash1234567890",
                author: "–ê–±–¥—É–∫–∞—Ä–∏–º–æ–≤ –ê–±–¥—É—Ä–∞—à–∏–¥ –ê–±–¥—É–ª—Ö–∞–º–∏—Ç–æ–≤–∏—á",
                integrationStats: { totalProcessed: 0, semanticAnalyses: 0, ethicalChecks: 0, archiveOperations: 0 },
                browserCapabilities: { isOldBrowser: false },
                archiveManager: { archives: [] },
                formatFileSize: function(bytes) {
                    if (bytes === 0) return '0 B';
                    var k = 1024;
                    var sizes = ['B', 'KB', 'MB', 'GB'];
                    var i = Math.floor(Math.log(bytes) / Math.log(k));
                    return parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + ' ' + sizes[i];
                },
                showSaveStatus: function(status) {
                    var indicator = document.getElementById('saveIndicator');
                    if (indicator) {
                        indicator.className = 'save-indicator ' + status;
                        indicator.innerHTML = status === 'saved' ? '‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–æ' : 'üíæ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ...';
                    }
                },
                updateUI: function() { console.log("UI update (fallback mode)"); },
                updateAllUI: function() { console.log("All UI update (fallback mode)"); },
                updateArchivesList: function() { console.log("Archives list update (fallback mode)"); },
                updateTabCounts: function() { console.log("Tab counts update (fallback mode)"); },
                showArchiveDetails: function() { alert("Archive details not available in fallback mode"); },
                processArchiveRequest: function() { return { success: false, error: "System not fully initialized" }; },
                searchArchive: function() { return { results: [], totalFound: 0, searchMethod: "fallback" }; },
                saveAllData: function() { console.log("Save all data (fallback mode)"); },
                getSystemInfo: function() { return { version: "fallback", currentLevel: 0, componentsLoaded: {} }; },
                performDemoAnalysis: function() { alert("Demo analysis not available in fallback mode"); },
                loadThesaurusTab: function() { console.log("Thesaurus tab (fallback mode)"); },
                loadEncyclopediaTab: function() { console.log("Encyclopedia tab (fallback mode)"); },
                loadSemanticTab: function() { console.log("Semantic tab (fallback mode)"); }
            };
            window.terraSystem = terraSystem;
        }
        
        // ===== UI INTERACTION FUNCTIONS =====
        
        window.switchTab = function(tabName) {
            // Remove active class from all tabs
            var tabButtons = document.querySelectorAll('.tab-button');
            var tabContents = document.querySelectorAll('.tab-content');
            
            for (var i = 0; i < tabButtons.length; i++) {
                tabButtons[i].classList.remove('active');
            }
            
            for (var j = 0; j < tabContents.length; j++) {
                tabContents[j].classList.add('hidden');
            }
            
            // Add active class to clicked tab
            var activeButton = document.querySelector('[data-tab="' + tabName + '"]');
            var activeContent = document.getElementById(tabName + 'Tab');
            
            if (activeButton) activeButton.classList.add('active');
            if (activeContent) activeContent.classList.remove('hidden');
            
            // Load tab-specific content
            if (tabName === 'thesaurus' && terraSystem && terraSystem.loadThesaurusTab) {
                terraSystem.loadThesaurusTab();
            } else if (tabName === 'encyclopedia' && terraSystem && terraSystem.loadEncyclopediaTab) {
                terraSystem.loadEncyclopediaTab();
            } else if (tabName === 'semantic' && terraSystem && terraSystem.loadSemanticTab) {
                terraSystem.loadSemanticTab();
            }
        };
        
        window.closeModal = function() {
            document.getElementById('contentModal').classList.add('hidden');
        };
        
        window.dropHandler = function(ev) {
            ev.preventDefault();
            var dropZone = document.getElementById('dropZone');
            dropZone.classList.remove('dragover');
            
            var files = ev.dataTransfer.files;
            if (files.length > 0) {
                handleFiles(files);
            }
        };
        
        window.dragOverHandler = function(ev) {
            ev.preventDefault();
            document.getElementById('dropZone').classList.add('dragover');
        };
        
        window.dragLeaveHandler = function(ev) {
            ev.preventDefault();
            document.getElementById('dropZone').classList.remove('dragover');
        };
        
        window.handleFiles = function(files) {
            if (!files || files.length === 0) return;
            
            if (terraSystem && terraSystem.showSaveStatus) {
                terraSystem.showSaveStatus('saving');
            }
            
            var progress = document.getElementById('processingProgress');
            var progressFill = document.getElementById('progressFill');
            var progressText = document.getElementById('progressText');
            
            progress.classList.remove('hidden');
            
            var processedFiles = [];
            var totalFiles = files.length;
            var processedCount = 0;
            
            function updateProgress() {
                var percent = (processedCount / totalFiles) * 100;
                progressFill.style.width = percent + '%';
                progressText.textContent = '–û–±—Ä–∞–±–æ—Ç–∞–Ω–æ ' + processedCount + ' –∏–∑ ' + totalFiles + ' —Ñ–∞–π–ª–æ–≤...';
            }
            
            function processFile(file, index) {
                setTimeout(function() {
                    var reader = new FileReader();
                    
                    reader.onload = function(e) {
                        var fileData = {
                            name: file.name,
                            size: file.size,
                            type: file.type,
                            lastModified: file.lastModified,
                            content: e.target.result
                        };
                        
                        // Semantic analysis of file content
                        var textContent = '';
                        if (file.type.startsWith('text/') || file.name.endsWith('.txt') || file.name.endsWith('.md')) {
                            textContent = e.target.result;
                        } else if (file.name.endsWith('.json')) {
                            try {
                                var jsonData = JSON.parse(e.target.result);
                                textContent = JSON.stringify(jsonData, null, 2);
                            } catch (jsonError) {
                                textContent = e.target.result;
                            }
                        }
                        
                        // Process through Terra system
                        var result = { success: false };
                        if (terraSystem && terraSystem.processArchiveRequest) {
                            result = terraSystem.processArchiveRequest(
                                '–ê—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞: ' + file.name + '\n\n' + textContent.slice(0, 1000),
                                [fileData],
                                terraSystem.did
                            );
                        }
                        
                        processedFiles.push({
                            file: fileData,
                            result: result
                        });
                        
                        processedCount++;
                        updateProgress();
                        
                        if (processedCount === totalFiles) {
                            setTimeout(function() {
                                progress.classList.add('hidden');
                                if (terraSystem && terraSystem.showSaveStatus) {
                                    terraSystem.showSaveStatus('saved');
                                }
                                if (terraSystem && terraSystem.updateAllUI) {
                                    terraSystem.updateAllUI();
                                }
                                
                                // Show success message
                                var stats = terraSystem && terraSystem.integrationStats ? terraSystem.integrationStats : { ethicalChecks: 0, semanticAnalyses: 0, archiveOperations: 0 };
                                alert('‚úÖ –£—Å–ø–µ—à–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ ' + totalFiles + ' —Ñ–∞–π–ª–æ–≤!\n\n' +
                                      '–≠—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫: ' + stats.ethicalChecks + '\n' +
                                      '–°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏—Ö –∞–Ω–∞–ª–∏–∑–æ–≤: ' + stats.semanticAnalyses + '\n' +
                                      '–ê—Ä—Ö–∏–≤–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π: ' + stats.archiveOperations);
                            }, 500);
                        }
                    };
                    
                    reader.onerror = function() {
                        console.error('–û—à–∏–±–∫–∞ —á—Ç–µ–Ω–∏—è —Ñ–∞–π–ª–∞:', file.name);
                        processedCount++;
                        updateProgress();
                    };
                    
                    if (file.type.startsWith('text/') || file.name.endsWith('.txt') || 
                        file.name.endsWith('.md') || file.name.endsWith('.json') ||
                        file.name.endsWith('.js') || file.name.endsWith('.html') ||
                        file.name.endsWith('.css') || file.name.endsWith('.py')) {
                        reader.readAsText(file);
                    } else {
                        // For binary files, read as ArrayBuffer but store metadata only
                        fileData.content = '[–ë–∏–Ω–∞—Ä–Ω—ã–π —Ñ–∞–π–ª: ' + file.type + ']';
                        processedCount++;
                        updateProgress();
                    }
                }, index * 100); // Stagger processing to prevent browser freeze
            }
            
            // Process all files
            for (var i = 0; i < files.length; i++) {
                processFile(files[i], i);
            }
        };
        
        window.performCorpusSearch = function() {
            var query = document.getElementById('searchBox').value.trim();
            var mode = document.getElementById('searchMode').value;
            
            if (!query) {
                if (terraSystem && terraSystem.updateArchivesList) {
                    terraSystem.updateArchivesList();
                }
                return;
            }
            
            var results = { results: [], totalFound: 0, searchMethod: "fallback" };
            if (terraSystem && terraSystem.searchArchive) {
                results = terraSystem.searchArchive(query, { mode: mode });
            }
            
            // Update archives list with search results
            var container = document.getElementById('archivesList');
            if (!container) return;
            
            container.innerHTML = '';
            
            if (results.results.length === 0) {
                container.innerHTML = 
                    '<div class="text-center py-12 text-gray-500">' +
                        '<div class="text-6xl mb-6">üîç</div>' +
                        '<h3 class="text-xl font-semibold mb-2">–ù–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</h3>' +
                        '<p>–ü–æ –∑–∞–ø—Ä–æ—Å—É "' + query + '" —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</p>' +
                        '<p class="text-sm mt-2">–ú–µ—Ç–æ–¥ –ø–æ–∏—Å–∫–∞: ' + results.searchMethod + '</p>' +
                    '</div>';
                return;
            }
            
            // Create search results header
            var headerElement = document.createElement('div');
            headerElement.className = 'bg-blue-50 p-4 rounded-lg mb-4';
            headerElement.innerHTML = 
                '<h3 class="font-semibold text-blue-800 mb-2">üîç –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞</h3>' +
                '<div class="grid grid-cols-3 gap-4 text-sm text-blue-700">' +
                    '<div><strong>–ó–∞–ø—Ä–æ—Å:</strong> ' + query + '</div>' +
                    '<div><strong>–ù–∞–π–¥–µ–Ω–æ:</strong> ' + results.totalFound + '</div>' +
                    '<div><strong>–í—Ä–µ–º—è:</strong> ' + results.processingTime + '–º—Å</div>' +
                '</div>' +
                '<div class="text-sm text-blue-600 mt-2"><strong>–ú–µ—Ç–æ–¥:</strong> ' + results.searchMethod + '</div>';
            
            container.appendChild(headerElement);
            
            // Display search results
            for (var i = 0; i < Math.min(results.results.length, 20); i++) {
                var result = results.results[i];
                var archive = result.item || result; // Handle both semantic and simple search results
                
                var archiveElement = document.createElement('div');
                archiveElement.className = 'archive-item border-l-4 border-blue-500';
                
                var semanticInfo = '';
                if (result.similarity) {
                    semanticInfo = '<div class="mt-2">' +
                                 '<span class="text-sm text-blue-600">üéØ –†–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç—å: ' + Math.round(result.similarity * 100) + '%</span>';
                    if (result.matchedConcepts && result.matchedConcepts.length > 0) {
                        semanticInfo += '<div class="mt-1">' +
                                      '<span class="text-sm text-gray-600">üß† –°–æ–≤–ø–∞–¥–µ–Ω–∏—è: </span>' +
                                      result.matchedConcepts.map(function(c) { 
                                          return '<span class="semantic-tag">' + c + '</span>'; 
                                      }).join('') +
                                      '</div>';
                    }
                    semanticInfo += '</div>';
                }
                
                archiveElement.innerHTML = 
                    '<div class="flex justify-between items-start">' +
                        '<div class="flex-1">' +
                            '<h4 class="font-semibold text-gray-800 mb-1">üì¶ –ê—Ä—Ö–∏–≤ #' + archive.id.toString().slice(-6) + '</h4>' +
                            '<p class="text-sm text-gray-600 mb-2">' + new Date(archive.timestamp).toLocaleString() + '</p>' +
                            '<p class="text-sm text-gray-700 line-clamp-2">' + (archive.data.text || '–§–∞–π–ª–æ–≤—ã–π –∞—Ä—Ö–∏–≤').slice(0, 100) + '...</p>' +
                            semanticInfo +
                        '</div>' +
                        '<div class="text-right ml-4">' +
                            '<div class="text-sm text-gray-500">' + terraSystem.formatFileSize(archive.size) + '</div>' +
                            '<div class="text-xs text-purple-600 font-semibold">L' + archive.level + '</div>' +
                        '</div>' +
                    '</div>';
                
                archiveElement.onclick = function(archive) {
                    return function() {
                        terraSystem.showArchiveDetails(archive);
                    };
                }(archive);
                
                container.appendChild(archiveElement);
            }
        };
        
        // Load tab-specific content methods
        TerraSemanticIntegration.prototype.loadThesaurusTab = function() {
            var container = document.getElementById('thesaurusList');
            if (!container) return;
            
            container.innerHTML = '';
            
            if (!this.offlineAnalyzer) {
                container.innerHTML = '<div class="text-center py-8 text-gray-500">' +
                                    '<p>üìö –¢–µ–∑–∞—É—Ä—É—Å –¥–æ—Å—Ç—É–ø–µ–Ω —Ç–æ–ª—å–∫–æ –≤ L1+ —Ä–µ–∂–∏–º–µ</p>' +
                                    '<p class="text-sm mt-2">–¢–µ–∫—É—â–∏–π —É—Ä–æ–≤–µ–Ω—å: L' + this.currentLevel + '</p></div>';
                return;
            }
            
            var thesaurus = this.offlineAnalyzer.embeddedThesaurus;
            var concepts = this.offlineAnalyzer.conceptsDatabase;
            
            // Display built-in thesaurus
            for (var term in thesaurus) {
                var synonyms = thesaurus[term];
                var frequency = concepts[term] ? concepts[term].frequency : 0;
                
                var entryElement = document.createElement('div');
                entryElement.className = 'definition-card';
                entryElement.innerHTML = 
                    '<div class="flex justify-between items-start mb-2">' +
                        '<h4 class="font-semibold text-teal-700 text-lg">' + term + '</h4>' +
                        '<span class="text-sm text-gray-500 bg-gray-100 px-2 py-1 rounded">–ß–∞—Å—Ç–æ—Ç–∞: ' + frequency + '</span>' +
                    '</div>' +
                    '<div class="flex flex-wrap gap-2">' +
                        synonyms.map(function(syn) { 
                            return '<span class="semantic-tag">' + syn + '</span>'; 
                        }).join('') +
                    '</div>';
                
                container.appendChild(entryElement);
            }
            
            if (Object.keys(thesaurus).length === 0) {
                container.innerHTML = '<div class="text-center py-8 text-gray-500">' +
                                    '<div class="text-6xl mb-4">üìö</div>' +
                                    '<p>–¢–µ–∑–∞—É—Ä—É—Å –ø—É—Å—Ç</p></div>';
            }
        };
        
        TerraSemanticIntegration.prototype.loadEncyclopediaTab = function() {
            var container = document.getElementById('encyclopediaList');
            if (!container) return;
            
            container.innerHTML = '';
            
            if (!this.offlineAnalyzer) {
                container.innerHTML = '<div class="text-center py-8 text-gray-500">' +
                                    '<p>üî¨ –≠–Ω—Ü–∏–∫–ª–æ–ø–µ–¥–∏—è –¥–æ—Å—Ç—É–ø–Ω–∞ —Ç–æ–ª—å–∫–æ –≤ L1+ —Ä–µ–∂–∏–º–µ</p>' +
                                    '<p class="text-sm mt-2">–¢–µ–∫—É—â–∏–π —É—Ä–æ–≤–µ–Ω—å: L' + this.currentLevel + '</p></div>';
                return;
            }
            
            var ontology = this.offlineAnalyzer.domainOntology;
            
            // Display domain ontology as encyclopedia
            for (var domain in ontology) {
                var domainData = ontology[domain];
                
                var entryElement = document.createElement('div');
                entryElement.className = 'encyclopedia-entry';
                entryElement.innerHTML = 
                    '<h4 class="font-semibold text-purple-700 text-xl mb-3">üî¨ ' + domain.charAt(0).toUpperCase() + domain.slice(1) + '</h4>' +
                    '<div class="mb-4">' +
                        '<h5 class="font-medium text-gray-700 mb-2">üìÇ –ü–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏:</h5>' +
                        '<div class="flex flex-wrap gap-2">' +
                            domainData.–ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏.map(function(cat) { 
                                return '<span class="semantic-tag bg-gradient-to-r from-purple-500 to-pink-500">' + cat + '</span>'; 
                            }).join('') +
                        '</div>' +
                    '</div>' +
                    '<div>' +
                        '<h5 class="font-medium text-gray-700 mb-2">üîß –ö–ª—é—á–µ–≤—ã–µ —Ç–µ—Ä–º–∏–Ω—ã:</h5>' +
                        '<div class="flex flex-wrap gap-2">' +
                            domainData.—Ç–µ—Ä–º–∏–Ω—ã.map(function(term) { 
                                return '<span class="semantic-tag bg-gradient-to-r from-cyan-500 to-blue-500">' + term + '</span>'; 
                            }).join('') +
                        '</div>' +
                    '</div>';
                
                container.appendChild(entryElement);
            }
            
            if (Object.keys(ontology).length === 0) {
                container.innerHTML = '<div class="text-center py-8 text-gray-500">' +
                                    '<div class="text-6xl mb-4">üî¨</div>' +
                                    '<p>–≠–Ω—Ü–∏–∫–ª–æ–ø–µ–¥–∏—è –ø—É—Å—Ç–∞</p></div>';
            }
        };
        
        TerraSemanticIntegration.prototype.loadSemanticTab = function() {
            var container = document.getElementById('semanticAnalysis');
            if (!container) return;
            
            container.innerHTML = '';
            
            // System info card
            var systemCard = document.createElement('div');
            systemCard.className = 'bg-gradient-to-r from-indigo-50 to-purple-50 p-6 rounded-lg border border-indigo-200';
            systemCard.innerHTML = 
                '<h4 class="font-semibold text-indigo-800 text-lg mb-4">ü§ñ Terra –ü—Å–µ–≤–¥–æ-–ò–ò –°–∏—Å—Ç–µ–º–∞</h4>' +
                '<div class="grid grid-cols-2 gap-4 text-sm">' +
                    '<div><strong>–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å:</strong> L' + this.currentLevel + '</div>' +
                    '<div><strong>–°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –¥–≤–∏–∂–æ–∫:</strong> ' + (this.offlineAnalyzer ? '–ü–æ–ª–Ω—ã–π' : '–ë–∞–∑–æ–≤—ã–π L0') + '</div>' +
                    '<div><strong>–≠—Ç–∏—á–µ—Å–∫–∏–π —Å–ª–æ–π:</strong> –ê–∫—Ç–∏–≤–µ–Ω (v7.0)</div>' +
                    '<div><strong>–ê–≤—Ç–æ–Ω–æ–º–Ω–æ—Å—Ç—å:</strong> 100% –æ—Ñ—Ñ–ª–∞–π–Ω</div>' +
                '</div>' +
                '<div class="mt-4">' +
                    '<h5 class="font-medium text-indigo-700 mb-2">üéØ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏:</h5>' +
                    '<ul class="text-sm text-indigo-700 space-y-1">' +
                        '<li>‚Ä¢ –°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ —Ç–µ–∫—Å—Ç–æ–≤</li>' +
                        '<li>‚Ä¢ –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–π –∏ –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤</li>' +
                        '<li>‚Ä¢ –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–∞–º–µ—Ä–µ–Ω–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</li>' +
                        '<li>‚Ä¢ –≠—Ç–∏—á–µ—Å–∫–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞</li>' +
                        '<li>‚Ä¢ –ò–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω—ã–π –ø–æ–∏—Å–∫ –ø–æ –∞—Ä—Ö–∏–≤–∞–º</li>' +
                        '<li>‚Ä¢ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏—è</li>' +
                    '</ul>' +
                '</div>';
            
            container.appendChild(systemCard);
            
            // Statistics card
            if (this.integrationStats.semanticAnalyses > 0) {
                var statsCard = document.createElement('div');
                statsCard.className = 'bg-green-50 p-6 rounded-lg border border-green-200';
                statsCard.innerHTML = 
                    '<h4 class="font-semibold text-green-800 text-lg mb-4">üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∞–Ω–∞–ª–∏–∑–æ–≤</h4>' +
                    '<div class="grid grid-cols-3 gap-4 text-center">' +
                        '<div class="bg-white p-4 rounded-lg border border-green-100">' +
                            '<div class="text-2xl font-bold text-green-600">' + this.integrationStats.semanticAnalyses + '</div>' +
                            '<div class="text-sm text-green-700">–°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏—Ö –∞–Ω–∞–ª–∏–∑–æ–≤</div>' +
                        '</div>' +
                        '<div class="bg-white p-4 rounded-lg border border-green-100">' +
                            '<div class="text-2xl font-bold text-blue-600">' + this.integrationStats.ethicalChecks + '</div>' +
                            '<div class="text-sm text-blue-700">–≠—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫</div>' +
                        '</div>' +
                        '<div class="bg-white p-4 rounded-lg border border-green-100">' +
                            '<div class="text-2xl font-bold text-purple-600">' + this.integrationStats.archiveOperations + '</div>' +
                            '<div class="text-sm text-purple-700">–ê—Ä—Ö–∏–≤–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π</div>' +
                        '</div>' +
                    '</div>' +
                    '<div class="mt-4 text-sm text-green-700">' +
                        '<strong>–ü–æ—Å–ª–µ–¥–Ω—è—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å:</strong> ' + 
                        (this.integrationStats.lastActivity ? new Date(this.integrationStats.lastActivity).toLocaleString() : '–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö') +
                    '</div>';
                
                container.appendChild(statsCard);
            }
            
            // Interactive demo
            var demoCard = document.createElement('div');
            demoCard.className = 'bg-yellow-50 p-6 rounded-lg border border-yellow-200';
            demoCard.innerHTML = 
                '<h4 class="font-semibold text-yellow-800 text-lg mb-4">üß™ –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è</h4>' +
                '<div class="space-y-4">' +
                    '<div>' +
                        '<label class="block text-sm font-medium text-yellow-700 mb-2">–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞:</label>' +
                        '<textarea id="demoText" class="w-full p-3 border border-yellow-300 rounded-lg" rows="3" ' +
                        'placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ù—É–∂–Ω–æ –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∞—Ä—Ö–∏–≤ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –ø–æ –º–∞—à–∏–Ω–Ω–æ–º—É –æ–±—É—á–µ–Ω–∏—é..."></textarea>' +
                    '</div>' +
                    '<button class="fractal-button bg-gradient-to-r from-yellow-500 to-orange-500" onclick="terraSystem.performDemoAnalysis()">' +
                        'üî¨ –ó–∞–ø—É—Å—Ç–∏—Ç—å –∞–Ω–∞–ª–∏–∑' +
                    '</button>' +
                    '<div id="demoResults" class="hidden mt-4 p-4 bg-white border border-yellow-200 rounded-lg">' +
                        '<!-- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–Ω–∞–ª–∏–∑–∞ –±—É–¥—É—Ç –∑–¥–µ—Å—å -->' +
                    '</div>' +
                '</div>';
            
            container.appendChild(demoCard);
        };
        
        TerraSemanticIntegration.prototype.performDemoAnalysis = function() {
            var demoText = document.getElementById('demoText').value.trim();
            var resultsDiv = document.getElementById('demoResults');
            
            if (!demoText) {
                alert('‚ö†Ô∏è –í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞');
                return;
            }
            
            // Perform semantic analysis
            var analysis;
            if (this.currentLevel >= 1 && this.offlineAnalyzer) {
                analysis = this.offlineAnalyzer.analyzeText(demoText);
            } else if (this.l0Kernel) {
                analysis = {
                    keywords: this.l0Kernel.extractKeywords(demoText),
                    intent: this.l0Kernel.simpleIntentAnalysis(demoText),
                    level: 0,
                    summary: "–ê–Ω–∞–ª–∏–∑ –≤—ã–ø–æ–ª–Ω–µ–Ω –≤ L0 —Ä–µ–∂–∏–º–µ"
                };
            }
            
            // Perform ethical check
            var ethicalCheck = this.ethicalLayer.validateContent(demoText);
            
            // Display results
            var resultsHTML = '<h5 class="font-semibold text-green-800 mb-3">üî¨ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–Ω–∞–ª–∏–∑–∞:</h5>';
            
            // Intent and keywords
            resultsHTML += '<div class="mb-4">';
            resultsHTML += '<h6 class="font-medium text-gray-700 mb-2">üéØ –ù–∞–º–µ—Ä–µ–Ω–∏–µ –∏ –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞:</h6>';
            if (analysis.intent) {
                resultsHTML += '<p class="text-sm mb-2"><strong>–¢–∏–ø –∑–∞–ø—Ä–æ—Å–∞:</strong> ' + 
                             (analysis.intent.type || analysis.intent) + '</p>';
            }
            if (analysis.keywords && analysis.keywords.length > 0) {
                resultsHTML += '<div class="flex flex-wrap gap-2">';
                for (var i = 0; i < Math.min(analysis.keywords.length, 10); i++) {
                    var keyword = typeof analysis.keywords[i] === 'object' ? analysis.keywords[i].word : analysis.keywords[i];
                    resultsHTML += '<span class="semantic-tag bg-gradient-to-r from-blue-500 to-indigo-500">' + keyword + '</span>';
                }
                resultsHTML += '</div>';
            }
            resultsHTML += '</div>';
            
            // Concepts (if available)
            if (analysis.concepts && analysis.concepts.length > 0) {
                resultsHTML += '<div class="mb-4">';
                resultsHTML += '<h6 class="font-medium text-gray-700 mb-2">üß† –û–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏:</h6>';
                resultsHTML += '<div class="space-y-2">';
                for (var j = 0; j < Math.min(analysis.concepts.length, 5); j++) {
                    var concept = analysis.concepts[j];
                    resultsHTML += '<div class="bg-gray-50 p-2 rounded">';
                    resultsHTML += '<span class="font-medium">' + concept.concept + '</span>';
                    resultsHTML += '<span class="text-sm text-gray-600 ml-2">(—Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç—å: ' + concept.relevance + ')</span>';
                    if (concept.matches && concept.matches.length > 0) {
                        resultsHTML += '<div class="text-sm text-gray-600 mt-1">–°–æ–≤–ø–∞–¥–µ–Ω–∏—è: ' + concept.matches.join(', ') + '</div>';
                    }
                    resultsHTML += '</div>';
                }
                resultsHTML += '</div></div>';
            }
            
            // Domains (if available)
            if (analysis.domains && analysis.domains.length > 0) {
                resultsHTML += '<div class="mb-4">';
                resultsHTML += '<h6 class="font-medium text-gray-700 mb-2">üè∑Ô∏è –ü—Ä–µ–¥–º–µ—Ç–Ω—ã–µ –æ–±–ª–∞—Å—Ç–∏:</h6>';
                for (var k = 0; k < Math.min(analysis.domains.length, 3); k++) {
                    var domain = analysis.domains[k];
                    resultsHTML += '<div class="bg-purple-50 p-2 rounded mb-2">';
                    resultsHTML += '<span class="font-medium text-purple-700">' + domain.domain + '</span>';
                    resultsHTML += '<span class="text-sm text-purple-600 ml-2">(—É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å: ' + Math.round(domain.confidence * 100) + '%)</span>';
                    resultsHTML += '</div>';
                }
                resultsHTML += '</div>';
            }
            
            // Ethical check results
            resultsHTML += '<div class="mb-4">';
            resultsHTML += '<h6 class="font-medium text-gray-700 mb-2">‚öñÔ∏è –≠—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞:</h6>';
            resultsHTML += '<div class="' + (ethicalCheck.passed ? 'bg-green-50 border-green-200' : 'bg-red-50 border-red-200') + ' p-3 rounded border">';
            resultsHTML += '<div class="flex items-center mb-2">';
            resultsHTML += '<span class="' + (ethicalCheck.passed ? 'text-green-700' : 'text-red-700') + ' font-medium">';
            resultsHTML += ethicalCheck.passed ? '‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ–π–¥–µ–Ω–∞' : '‚ùå –û–±–Ω–∞—Ä—É–∂–µ–Ω—ã –Ω–∞—Ä—É—à–µ–Ω–∏—è';
            resultsHTML += '</span></div>';
            
            if (ethicalCheck.violations && ethicalCheck.violations.length > 0) {
                resultsHTML += '<div class="text-sm text-red-700 mb-2"><strong>–ù–∞—Ä—É—à–µ–Ω–∏—è:</strong></div>';
                for (var l = 0; l < ethicalCheck.violations.length; l++) {
                    resultsHTML += '<div class="text-sm text-red-600">‚Ä¢ ' + ethicalCheck.violations[l].message + '</div>';
                }
            }
            
            if (ethicalCheck.enhancements && ethicalCheck.enhancements.length > 0) {
                resultsHTML += '<div class="text-sm text-green-700 mb-2"><strong>–ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ –∞—Å–ø–µ–∫—Ç—ã:</strong></div>';
                for (var m = 0; m < ethicalCheck.enhancements.length; m++) {
                    resultsHTML += '<div class="text-sm text-green-600">‚Ä¢ ' + ethicalCheck.enhancements[m].message + '</div>';
                }
            }
            resultsHTML += '</div></div>';
            
            // Summary
            if (analysis.summary) {
                resultsHTML += '<div class="mb-4">';
                resultsHTML += '<h6 class="font-medium text-gray-700 mb-2">üìã –†–µ–∑—é–º–µ:</h6>';
                resultsHTML += '<div class="bg-blue-50 p-3 rounded border border-blue-200">';
                resultsHTML += '<p class="text-sm text-blue-800">' + analysis.summary + '</p>';
                resultsHTML += '</div></div>';
            }
            
            resultsDiv.innerHTML = resultsHTML;
            resultsDiv.classList.remove('hidden');
        };
        
        // Additional Terra functions
        window.exportUltimateArchive = function() {
            if (terraSystem && terraSystem.showSaveStatus) {
                terraSystem.showSaveStatus('saving');
            }
            
            var exportData = {
                metadata: {
                    systemName: "Terra Archive Manager 2.0 Ultimate",
                    version: terraSystem ? terraSystem.version : "fallback",
                    author: terraSystem ? terraSystem.author : "–ê–±–¥—É–∫–∞—Ä–∏–º–æ–≤ –ê–±–¥—É—Ä–∞—à–∏–¥ –ê–±–¥—É–ª—Ö–∞–º–∏—Ç–æ–≤–∏—á",
                    did: terraSystem ? terraSystem.did : "aiuz:did:aiuz:stakeholder:abdukarimov_aaahash1234567890",
                    exportDate: new Date().toISOString(),
                    level: terraSystem ? terraSystem.currentLevel : 0,
                    capabilities: terraSystem ? terraSystem.browserCapabilities : {}
                },
                data: {
                    archives: terraSystem && terraSystem.archiveManager ? terraSystem.archiveManager.archives : [],
                    thesaurus: terraSystem && terraSystem.archiveManager ? terraSystem.archiveManager.thesaurus : [],
                    encyclopedia: terraSystem && terraSystem.archiveManager ? terraSystem.archiveManager.encyclopedia : [],
                    statistics: terraSystem ? terraSystem.integrationStats : {}
                },
                systemInfo: terraSystem && terraSystem.getSystemInfo ? terraSystem.getSystemInfo() : {}
            };
            
            var dataStr = JSON.stringify(exportData, null, 2);
            var dataBlob = new Blob([dataStr], {type: 'application/json'});
            var url = URL.createObjectURL(dataBlob);
            
            var link = document.createElement('a');
            link.href = url;
            link.download = 'terra_ultimate_export_' + new Date().toISOString().slice(0, 10) + '.json';
            
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            URL.revokeObjectURL(url);
            if (terraSystem && terraSystem.showSaveStatus) {
                terraSystem.showSaveStatus('saved');
            }
            
            alert('‚úÖ Terra Ultimate –∞—Ä—Ö–∏–≤ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω!\n\n' +
                  '–≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ:\n' +
                  'üì¶ –ê—Ä—Ö–∏–≤—ã: ' + exportData.data.archives.length + '\n' +
                  'üìö –ó–∞–ø–∏—Å–∏ —Ç–µ–∑–∞—É—Ä—É—Å–∞: ' + exportData.data.thesaurus.length + '\n' +
                  'üî¨ –ó–∞–ø–∏—Å–∏ —ç–Ω—Ü–∏–∫–ª–æ–ø–µ–¥–∏–∏: ' + exportData.data.encyclopedia.length + '\n' +
                  'üß¨ –£—Ä–æ–≤–µ–Ω—å —Å–∏—Å—Ç–µ–º—ã: L' + (terraSystem ? terraSystem.currentLevel : 0));
        };
        
        window.importUltimateArchive = function() {
            var input = document.createElement('input');
            input.type = 'file';
            input.accept = '.json';
            
            input.onchange = function(e) {
                var file = e.target.files[0];
                if (!file) return;
                
                if (terraSystem && terraSystem.showSaveStatus) {
                    terraSystem.showSaveStatus('saving');
                }
                
                var reader = new FileReader();
                reader.onload = function(e) {
                    try {
                        var importData = JSON.parse(e.target.result);
                        
                        if (importData.metadata && importData.metadata.systemName && 
                            importData.metadata.systemName.includes('Terra')) {
                            
                            // Merge imported data
                            if (importData.data.archives && terraSystem && terraSystem.archiveManager) {
                                terraSystem.archiveManager.archives = terraSystem.archiveManager.archives.concat(importData.data.archives);
                            }
                            if (importData.data.thesaurus && terraSystem && terraSystem.archiveManager) {
                                terraSystem.archiveManager.thesaurus = terraSystem.archiveManager.thesaurus.concat(importData.data.thesaurus);
                            }
                            if (importData.data.encyclopedia && terraSystem && terraSystem.archiveManager) {
                                terraSystem.archiveManager.encyclopedia = terraSystem.archiveManager.encyclopedia.concat(importData.data.encyclopedia);
                            }
                            
                            if (terraSystem && terraSystem.saveAllData) {
                                terraSystem.saveAllData();
                            }
                            if (terraSystem && terraSystem.updateAllUI) {
                                terraSystem.updateAllUI();
                            }
                            if (terraSystem && terraSystem.showSaveStatus) {
                                terraSystem.showSaveStatus('saved');
                            }
                            
                            alert('‚úÖ Terra Ultimate –∞—Ä—Ö–∏–≤ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω!\n\n' +
                                  '–ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ:\n' +
                                  'üì¶ –ê—Ä—Ö–∏–≤—ã: ' + (importData.data.archives ? importData.data.archives.length : 0) + '\n' +
                                  'üìö –ó–∞–ø–∏—Å–∏ —Ç–µ–∑–∞—É—Ä—É—Å–∞: ' + (importData.data.thesaurus ? importData.data.thesaurus.length : 0) + '\n' +
                                  'üî¨ –ó–∞–ø–∏—Å–∏ —ç–Ω—Ü–∏–∫–ª–æ–ø–µ–¥–∏–∏: ' + (importData.data.encyclopedia ? importData.data.encyclopedia.length : 0) + '\n' +
                                  'üìÖ –î–∞—Ç–∞ —ç–∫—Å–ø–æ—Ä—Ç–∞: ' + new Date(importData.metadata.exportDate).toLocaleString());
                            
                        } else {
                            alert('‚ùå –§–∞–π–ª –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–º —ç–∫—Å–ø–æ—Ä—Ç–æ–º Terra Ultimate');
                            if (terraSystem && terraSystem.showSaveStatus) {
                                terraSystem.showSaveStatus('saved');
                            }
                        }
                        
                    } catch (error) {
                        alert('‚ùå –û—à–∏–±–∫–∞ –∏–º–ø–æ—Ä—Ç–∞: ' + error.message);
                        if (terraSystem && terraSystem.showSaveStatus) {
                            terraSystem.showSaveStatus('saved');
                        }
                    }
                };
                
                reader.readAsText(file);
            };
            
            input.click();
        };
        
        window.createQuantumBackup = function() {
            if (terraSystem && terraSystem.saveAllData) {
                terraSystem.saveAllData();
            }
            
            var backupData = {
                timestamp: new Date().toISOString(),
                systemLevel: terraSystem ? terraSystem.currentLevel : 0,
                archives: terraSystem && terraSystem.loadData ? terraSystem.loadData('terra_archives_ultimate') : [],
                thesaurus: terraSystem && terraSystem.loadData ? terraSystem.loadData('terra_thesaurus_ultimate') : [],
                encyclopedia: terraSystem && terraSystem.loadData ? terraSystem.loadData('terra_encyclopedia_ultimate') : [],
                stats: terraSystem && terraSystem.loadData ? terraSystem.loadData('terra_integration_stats') : {}
            };
            
            // Save to special backup key
            if (terraSystem && terraSystem.saveData) {
                terraSystem.saveData('terra_quantum_backup', backupData);
            }
            
            alert('‚úÖ –ö–≤–∞–Ω—Ç–æ–≤—ã–π –±—ç–∫–∞–ø —Å–æ–∑–¥–∞–Ω!\n\n' +
                  '–í—Ä–µ–º—è: ' + new Date().toLocaleString() + '\n' +
                  '–£—Ä–æ–≤–µ–Ω—å: L' + (terraSystem ? terraSystem.currentLevel : 0) + '\n' +
                  '–î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ –ª–æ–∫–∞–ª—å–Ω–æ–º —Ö—Ä–∞–Ω–∏–ª–∏—â–µ');
        };
        
        window.runCompatibilityCheck = function() {
            var info = terraSystem && terraSystem.getSystemInfo ? terraSystem.getSystemInfo() : { version: "fallback", currentLevel: 0, componentsLoaded: {}, statistics: {} };
            var caps = terraSystem && terraSystem.browserCapabilities ? terraSystem.browserCapabilities : {};
            
            var report = 'üîç –û–¢–ß–ï–¢ –°–û–í–ú–ï–°–¢–ò–ú–û–°–¢–ò TERRA ULTIMATE\n\n';
            
            report += 'üß¨ –°–ò–°–¢–ï–ú–ù–ê–Ø –ò–ù–§–û–†–ú–ê–¶–ò–Ø:\n';
            report += '–í–µ—Ä—Å–∏—è: ' + info.version + '\n';
            report += '–¢–µ–∫—É—â–∏–π —É—Ä–æ–≤–µ–Ω—å: L' + info.currentLevel + '\n';
            report += '–ê–≤—Ç–æ—Ä: ' + info.author + '\n\n';
            
            report += 'üåê –í–û–ó–ú–û–ñ–ù–û–°–¢–ò –ë–†–ê–£–ó–ï–†–ê:\n';
            report += 'ES3 –ø–æ–¥–¥–µ—Ä–∂–∫–∞: ' + (caps.es3Support ? '‚úÖ' : '‚ùå') + '\n';
            report += 'ES5 –ø–æ–¥–¥–µ—Ä–∂–∫–∞: ' + (caps.es5Support ? '‚úÖ' : '‚ùå') + '\n';
            report += 'ES6 –ø–æ–¥–¥–µ—Ä–∂–∫–∞: ' + (caps.es6Support ? '‚úÖ' : '‚ùå') + '\n';
            report += 'LocalStorage: ' + (caps.localStorageSupport ? '‚úÖ' : '‚ùå') + '\n';
            report += 'IndexedDB: ' + (caps.indexedDBSupport ? '‚úÖ' : '‚ùå') + '\n';
            report += 'Web Workers: ' + (caps.webWorkersSupport ? '‚úÖ' : '‚ùå') + '\n';
            report += '–°–µ–º–µ–π—Å—Ç–≤–æ –±—Ä–∞—É–∑–µ—Ä–∞: ' + caps.browserFamily + '\n';
            report += '–°—Ç–∞—Ä—ã–π –±—Ä–∞—É–∑–µ—Ä: ' + (caps.isOldBrowser ? '‚ö†Ô∏è –î–∞' : '‚úÖ –ù–µ—Ç') + '\n\n';
            
            report += '‚ö° –ü–†–û–ò–ó–í–û–î–ò–¢–ï–õ–¨–ù–û–°–¢–¨:\n';
            report += '–û—Ü–µ–Ω–æ—á–Ω–∞—è RAM: ' + caps.estimatedRAM + ' MB\n';
            report += '–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: ' + caps.processingPower + '\n';
            report += '–†–∞–∑—Ä–µ—à–µ–Ω–∏–µ —ç–∫—Ä–∞–Ω–∞: ' + caps.screenSize.width + 'x' + caps.screenSize.height + '\n\n';
            
            report += 'üîß –ö–û–ú–ü–û–ù–ï–ù–¢–´:\n';
            report += 'L0 Kernel: ' + (info.componentsLoaded.l0Kernel ? '‚úÖ' : '‚ùå') + '\n';
            report += 'Offline Analyzer: ' + (info.componentsLoaded.offlineAnalyzer ? '‚úÖ' : '‚ùå') + '\n';
            report += 'Ethical Layer: ' + (info.componentsLoaded.ethicalLayer ? '‚úÖ' : '‚ùå') + '\n';
            report += 'Archive Manager: ' + (info.componentsLoaded.archiveManager ? '‚úÖ' : '‚ùå') + '\n\n';
            
            report += 'üìä –°–¢–ê–¢–ò–°–¢–ò–ö–ê:\n';
            report += '–í—Å–µ–≥–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ: ' + info.statistics.totalProcessed + '\n';
            report += '–°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏—Ö –∞–Ω–∞–ª–∏–∑–æ–≤: ' + info.statistics.semanticAnalyses + '\n';
            report += '–≠—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫: ' + info.statistics.ethicalChecks + '\n';
            report += '–ê—Ä—Ö–∏–≤–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π: ' + info.statistics.archiveOperations + '\n';
            
            if (info.statistics.lastActivity) {
                report += '–ü–æ—Å–ª–µ–¥–Ω—è—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å: ' + new Date(info.statistics.lastActivity).toLocaleString() + '\n';
            }
            
            alert(report);
        };
        
        // Additional helper functions for UI
        window.generateSemanticMap = function() {
            alert('üß† –°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∞—è –∫–∞—Ä—Ç–∞\n\n–§—É–Ω–∫—Ü–∏—è –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ...\n–ë—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–∞ –≤ —Å–ª–µ–¥—É—é—â–µ–π –≤–µ—Ä—Å–∏–∏ Terra Ultimate.');
        };
        
        window.buildIntegratedThesaurus = function() {
            alert('üìö –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ —Ç–µ–∑–∞—É—Ä—É—Å–∞\n\n–§—É–Ω–∫—Ü–∏—è –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ...\n–ë—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–∞ –≤ —Å–ª–µ–¥—É—é—â–µ–π –≤–µ—Ä—Å–∏–∏ Terra Ultimate.');
        };
        
        window.extractConcepts = function() {
            alert('üî¨ –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–π\n\n–§—É–Ω–∫—Ü–∏—è –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ...\n–ë—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–∞ –≤ —Å–ª–µ–¥—É—é—â–µ–π –≤–µ—Ä—Å–∏–∏ Terra Ultimate.');
        };
        
        window.analyzeCorpusWithAI = function() {
            alert('üìñ –ò–ò-–∞–Ω–∞–ª–∏–∑ –∫–æ—Ä–ø—É—Å–∞\n\n–§—É–Ω–∫—Ü–∏—è –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ...\n–ë—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–∞ –≤ —Å–ª–µ–¥—É—é—â–µ–π –≤–µ—Ä—Å–∏–∏ Terra Ultimate.');
        };
        
        window.generateEncyclopedia = function() {
            alert('üåê –°–æ–∑–¥–∞–Ω–∏–µ —ç–Ω—Ü–∏–∫–ª–æ–ø–µ–¥–∏–∏\n\n–§—É–Ω–∫—Ü–∏—è –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ...\n–ë—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–∞ –≤ —Å–ª–µ–¥—É—é—â–µ–π –≤–µ—Ä—Å–∏–∏ Terra Ultimate.');
        };
        
        window.performEthicalAudit = function() {
            var ethicalReport = terraSystem && terraSystem.ethicalLayer && terraSystem.ethicalLayer.generateEthicalReport ? 
                terraSystem.ethicalLayer.generateEthicalReport() : 
                { statistics: { totalChecks: 0, blockedContent: 0, warningsIssued: 0, enhancedContent: 0 }, 
                  filtersActive: { childSafety: 0, detoxification: 0 }, 
                  coreValues: {} };
            var reportText = '‚öñÔ∏è –≠–¢–ò–ß–ï–°–ö–ò–ô –ê–£–î–ò–¢ TERRA ULTIMATE\n\n';
            
            reportText += 'üìä –°–¢–ê–¢–ò–°–¢–ò–ö–ê –î–ï–¢–û–ö–°–ò–ö–ê–¶–ò–ò:\n';
            reportText += '–í—Å–µ–≥–æ –ø—Ä–æ–≤–µ—Ä–æ–∫: ' + ethicalReport.statistics.totalChecks + '\n';
            reportText += '–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞: ' + ethicalReport.statistics.blockedContent + '\n';
            reportText += '–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π –≤—ã–¥–∞–Ω–æ: ' + ethicalReport.statistics.warningsIssued + '\n';
            reportText += '–£–ª—É—á—à–µ–Ω–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞: ' + ethicalReport.statistics.enhancedContent + '\n\n';
            
            reportText += 'üõ°Ô∏è –ê–ö–¢–ò–í–ù–´–ï –§–ò–õ–¨–¢–†–´:\n';
            reportText += '–î–µ—Ç—Å–∫–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å: ' + ethicalReport.filtersActive.childSafety + ' —Ñ–∏–ª—å—Ç—Ä–æ–≤\n';
            reportText += '–î–µ—Ç–æ–∫—Å–∏–∫–∞—Ü–∏—è: ' + ethicalReport.filtersActive.detoxification + ' —Ñ–∏–ª—å—Ç—Ä–æ–≤\n\n';
            
            reportText += 'üåü –û–°–ù–û–í–ù–´–ï –¶–ï–ù–ù–û–°–¢–ò:\n';
            for (var value in ethicalReport.coreValues) {
                var valueData = ethicalReport.coreValues[value];
                reportText += '‚Ä¢ ' + value + ' (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç ' + valueData.priority + '): ' + valueData.description + '\n';
            }
            
            alert(reportText);
        };
        
        window.interpretUserQuery = function() {
            var query = prompt('üß† –í–≤–µ–¥–∏—Ç–µ –∑–∞–ø—Ä–æ—Å –¥–ª—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏ Terra –ò–ò:');
            if (!query) return;
            
            var result = "–°–∏—Å—Ç–µ–º–∞ –Ω–µ –≥–æ—Ç–æ–≤–∞";
            if (terraSystem && terraSystem.l0Kernel && terraSystem.l0Kernel.processRequest) {
                result = terraSystem.l0Kernel.processRequest(query, terraSystem.did);
            }
            alert('ü§ñ –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è Terra –ò–ò:\n\n' + result);
        };
        
        window.suggestRelatedConcepts = function() {
            alert('üîó –°–≤—è–∑–∞–Ω–Ω—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏\n\n–§—É–Ω–∫—Ü–∏—è –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ...\n–ë—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–∞ –≤ —Å–ª–µ–¥—É—é—â–µ–π –≤–µ—Ä—Å–∏–∏ Terra Ultimate.');
        };
        
        window.explainInSimpleTerms = function() {
            alert('üë∂ –ü—Ä–æ—Å—Ç–æ–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ\n\n–§—É–Ω–∫—Ü–∏—è –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ...\n–ë—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–∞ –≤ —Å–ª–µ–¥—É—é—â–µ–π –≤–µ—Ä—Å–∏–∏ Terra Ultimate.');
        };
        
        window.generateSummary = function() {
            alert('üìù –°–æ–∑–¥–∞–Ω–∏–µ —Ä–µ–∑—é–º–µ\n\n–§—É–Ω–∫—Ü–∏—è –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ...\n–ë—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–∞ –≤ —Å–ª–µ–¥—É—é—â–µ–π –≤–µ—Ä—Å–∏–∏ Terra Ultimate.');
        };
        
        window.detectLanguageAndTranslate = function() {
            alert('üåê –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —è–∑—ã–∫–∞\n\n–§—É–Ω–∫—Ü–∏—è –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ...\n–ë—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–∞ –≤ —Å–ª–µ–¥—É—é—â–µ–π –≤–µ—Ä—Å–∏–∏ Terra Ultimate.');
        };
        
        window.organizeAll = function() {
            if (terraSystem && terraSystem.saveAllData) {
                terraSystem.saveAllData();
            }
            if (terraSystem && terraSystem.updateAllUI) {
                terraSystem.updateAllUI();
            }
            alert('üìÅ –í—Å–µ –¥–∞–Ω–Ω—ã–µ –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω—ã –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã!\n\n–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:\n' +
                  'üì¶ –ê—Ä—Ö–∏–≤—ã: ' + (terraSystem && terraSystem.archiveManager ? terraSystem.archiveManager.archives.length : 0) + '\n' +
                  'üß¨ –£—Ä–æ–≤–µ–Ω—å: L' + (terraSystem ? terraSystem.currentLevel : 0));
        };
        
        window.generateUltimateReport = function() {
            var report = 'üìä TERRA ULTIMATE - –ü–û–õ–ù–´–ô –û–¢–ß–ï–¢\n\n';
            report += '‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n\n';
            
            var info = terraSystem && terraSystem.getSystemInfo ? terraSystem.getSystemInfo() : { 
                version: "fallback", 
                author: "–ê–±–¥—É–∫–∞—Ä–∏–º–æ–≤ –ê–±–¥—É—Ä–∞—à–∏–¥ –ê–±–¥—É–ª—Ö–∞–º–∏—Ç–æ–≤–∏—á", 
                did: "aiuz:did:aiuz:stakeholder:abdukarimov_aaahash1234567890",
                currentLevel: 0,
                browserCapabilities: {},
                componentsLoaded: {},
                statistics: {}
            };
            
            report += 'üß¨ –°–ò–°–¢–ï–ú–ù–ê–Ø –ò–ù–§–û–†–ú–ê–¶–ò–Ø:\n';
            report += '–ù–∞–∑–≤–∞–Ω–∏–µ: Terra Archive Manager 2.0 Ultimate\n';
            report += '–í–µ—Ä—Å–∏—è: ' + info.version + '\n';
            report += '–ê–≤—Ç–æ—Ä: ' + info.author + '\n';
            report += 'DID: ' + info.did + '\n';
            report += '–î–∞—Ç–∞/–≤—Ä–µ–º—è: ' + new Date().toLocaleString() + '\n';
            report += '–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å: L' + info.currentLevel + '\n\n';
            
            report += '‚ö° –í–û–ó–ú–û–ñ–ù–û–°–¢–ò –ò –ü–†–û–ò–ó–í–û–î–ò–¢–ï–õ–¨–ù–û–°–¢–¨:\n';
            var caps = info.browserCapabilities;
            report += '–ë—Ä–∞—É–∑–µ—Ä: ' + caps.browserFamily + (caps.isOldBrowser ? ' (legacy)' : ' (modern)') + '\n';
            report += 'RAM: ' + caps.estimatedRAM + ' MB\n';
            report += '–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: ' + caps.processingPower + '\n';
            report += '–≠–∫—Ä–∞–Ω: ' + caps.screenSize.width + 'x' + caps.screenSize.height + '\n\n';
            
            report += 'üîß –ö–û–ú–ü–û–ù–ï–ù–¢–´ –ò –ò–ù–¢–ï–ì–†–ê–¶–ò–Ø:\n';
            report += 'L0 SemanticKernel: ' + (info.componentsLoaded.l0Kernel ? '–ê–∫—Ç–∏–≤–µ–Ω' : '–ù–µ–∞–∫—Ç–∏–≤–µ–Ω') + '\n';
            report += 'Offline Analyzer: ' + (info.componentsLoaded.offlineAnalyzer ? '–ê–∫—Ç–∏–≤–µ–Ω' : '–ù–µ–∞–∫—Ç–∏–≤–µ–Ω') + '\n';
            report += 'Ethical Layer: ' + (info.componentsLoaded.ethicalLayer ? '–ê–∫—Ç–∏–≤–µ–Ω' : '–ù–µ–∞–∫—Ç–∏–≤–µ–Ω') + '\n';
            report += 'Archive Manager: ' + (info.componentsLoaded.archiveManager ? '–ê–∫—Ç–∏–≤–µ–Ω' : '–ù–µ–∞–∫—Ç–∏–≤–µ–Ω') + '\n\n';
            
            report += 'üìä –°–¢–ê–¢–ò–°–¢–ò–ö–ê –û–ü–ï–†–ê–¶–ò–ô:\n';
            report += '–í—Å–µ–≥–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ: ' + info.statistics.totalProcessed + '\n';
            report += '–°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏—Ö –∞–Ω–∞–ª–∏–∑–æ–≤: ' + info.statistics.semanticAnalyses + '\n';
            report += '–≠—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫: ' + info.statistics.ethicalChecks + '\n';
            report += '–ê—Ä—Ö–∏–≤–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π: ' + info.statistics.archiveOperations + '\n';
            
            if (terraSystem && terraSystem.archiveManager) {
                report += '\nüì¶ –î–ê–ù–ù–´–ï –í –ê–†–•–ò–í–ï:\n';
                report += '–ê—Ä—Ö–∏–≤–æ–≤: ' + terraSystem.archiveManager.archives.length + '\n';
                report += '–ó–∞–ø–∏—Å–µ–π —Ç–µ–∑–∞—É—Ä—É—Å–∞: ' + (terraSystem.archiveManager.thesaurus ? terraSystem.archiveManager.thesaurus.length : 0) + '\n';
                report += '–ó–∞–ø–∏—Å–µ–π —ç–Ω—Ü–∏–∫–ª–æ–ø–µ–¥–∏–∏: ' + (terraSystem.archiveManager.encyclopedia ? terraSystem.archiveManager.encyclopedia.length : 0) + '\n';
                
                var totalSize = terraSystem.archiveManager.archives.reduce(function(sum, item) { 
                    return sum + (item.size || 0); 
                }, 0);
                report += '–û–±—â–∏–π —Ä–∞–∑–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö: ' + (terraSystem.formatFileSize ? terraSystem.formatFileSize(totalSize) : totalSize + ' B') + '\n';
            }
            
            if (info.statistics.lastActivity) {
                report += '\n‚è∞ –ü–û–°–õ–ï–î–ù–Ø–Ø –ê–ö–¢–ò–í–ù–û–°–¢–¨:\n';
                report += new Date(info.statistics.lastActivity).toLocaleString() + '\n';
            }
            
            report += '\n‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n';
            report += 'üåç TERRA ULTIMATE - –§–†–ê–ö–¢–ê–õ–¨–ù–ê–Ø –ú–ï–¢–ê–ù–ê–£–ö–ê L0-L7\n';
            report += 'üéØ –£–ù–ò–í–ï–†–°–ê–õ–¨–ù–´–ô –î–û–°–¢–£–ü –ö –ó–ù–ê–ù–ò–Ø–ú –î–õ–Ø –í–°–ï–•\n';
            report += '‚öñÔ∏è 100% VENDOR INDEPENDENCE\n';
            report += 'üõ°Ô∏è –î–ï–¢–û–¶–ï–ù–¢–†–ò–†–û–í–ê–ù–ù–ê–Ø –≠–¢–ò–ö–ê\n';
            report += 'üß¨ –ü–û–õ–ù–ê–Ø –ê–í–¢–û–ù–û–ú–ù–û–°–¢–¨ –ò –û–§–§–õ–ê–ô–ù –ì–û–¢–û–í–ù–û–°–¢–¨\n';
            
            alert(report);
        };
        
        window.optimizeForCurrentLevel = function() {
            alert('üóúÔ∏è –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è L' + (terraSystem ? terraSystem.currentLevel : 0) + '\n\n–§—É–Ω–∫—Ü–∏—è –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ...\n–ë—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–∞ –≤ —Å–ª–µ–¥—É—é—â–µ–π –≤–µ—Ä—Å–∏–∏ Terra Ultimate.');
        };
        
        window.upgradeSystemLevel = function() {
            var currentLevel = terraSystem ? terraSystem.currentLevel : 0;
            var maxPossibleLevel = 3;
            
            // Check if upgrade is possible
            var caps = terraSystem && terraSystem.browserCapabilities ? terraSystem.browserCapabilities : {};
            var possibleLevel = 0;
            
            if (caps.es5Support && caps.localStorageSupport && caps.estimatedRAM >= 512) {
                possibleLevel = 1;
                if (caps.es6Support && caps.indexedDBSupport && caps.estimatedRAM >= 2048) {
                    possibleLevel = 2;
                    if (caps.webWorkersSupport && caps.processingPower === 'fast' && caps.estimatedRAM >= 4096) {
                        possibleLevel = 3;
                    }
                }
            }
            
            if (currentLevel >= possibleLevel) {
                alert('‚ö†Ô∏è –ü–æ–≤—ã—à–µ–Ω–∏–µ —É—Ä–æ–≤–Ω—è –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ\n\n' +
                      '–¢–µ–∫—É—â–∏–π —É—Ä–æ–≤–µ–Ω—å: L' + currentLevel + '\n' +
                      '–ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –≤–æ–∑–º–æ–∂–Ω—ã–π: L' + possibleLevel + '\n\n' +
                      '–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –±—Ä–∞—É–∑–µ—Ä–∞ –∏–ª–∏ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è –Ω–µ –ø–æ–∑–≤–æ–ª—è—é—Ç –ø–æ–≤—ã—Å–∏—Ç—å —É—Ä–æ–≤–µ–Ω—å.');
                return;
            }
            
            var confirm = window.confirm('‚¨ÜÔ∏è –ü–æ–≤—ã—à–µ–Ω–∏–µ —É—Ä–æ–≤–Ω—è Terra\n\n' +
                                       '–¢–µ–∫—É—â–∏–π: L' + currentLevel + '\n' +
                                       '–ù–æ–≤—ã–π: L' + possibleLevel + '\n\n' +
                                       '–≠—Ç–æ –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏.\n–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å?');
            
            if (confirm && terraSystem) {
                terraSystem.currentLevel = possibleLevel;
                if (terraSystem.initializeComponents) {
                    terraSystem.initializeComponents();
                }
                if (terraSystem.updateUI) {
                    terraSystem.updateUI();
                }
                
                alert('‚úÖ –£—Ä–æ–≤–µ–Ω—å –ø–æ–≤—ã—à–µ–Ω –¥–æ L' + possibleLevel + '!\n\n' +
                      '–ù–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:\n' +
                      (possibleLevel >= 1 ? '‚Ä¢ –°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä\n' : '') +
                      (possibleLevel >= 2 ? '‚Ä¢ –†–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ\n' : '') +
                      (possibleLevel >= 3 ? '‚Ä¢ –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞\n' : ''));
            }
        };
        
        window.resetToL0 = function() {
            var confirm = window.confirm('üîÑ –°–±—Ä–æ—Å –∫ –±–∞–∑–æ–≤–æ–º—É —É—Ä–æ–≤–Ω—é L0\n\n' +
                                       '–≠—Ç–æ –æ—Ç–∫–ª—é—á–∏—Ç –≤—Å–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏\n' +
                                       '–∏ –ø–µ—Ä–µ–≤–µ–¥–µ—Ç —Å–∏—Å—Ç–µ–º—É –≤ —Ä–µ–∂–∏–º –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏.\n\n' +
                                       '–î–∞–Ω–Ω—ã–µ –Ω–µ –±—É–¥—É—Ç –ø–æ—Ç–µ—Ä—è–Ω—ã.\n–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å?');
            
            if (confirm && terraSystem) {
                terraSystem.currentLevel = 0;
                if (terraSystem.initializeComponents) {
                    terraSystem.initializeComponents();
                }
                if (terraSystem.updateUI) {
                    terraSystem.updateUI();
                }
                
                alert('‚úÖ –°–∏—Å—Ç–µ–º–∞ —Å–±—Ä–æ—à–µ–Ω–∞ –∫ L0!\n\n' +
                      '–ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω—ã:\n' +
                      '‚Ä¢ –ë–∞–∑–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–∏—è\n' +
                      '‚Ä¢ –ü—Ä–æ—Å—Ç–æ–π —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑\n' +
                      '‚Ä¢ –≠—Ç–∏—á–µ—Å–∫–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è\n' +
                      '‚Ä¢ –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å');
            }
        };
        
        window.filterContent = function() {
            // Implementation for filtering - to be developed
            console.log('Filtering content...');
        };
        
        window.sortContent = function(method) {
            // Implementation for sorting - to be developed
            console.log('Sorting by:', method);
        };
        
        // Initialize the system when DOM is ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', function() {
                loadSavedLanguage();
                loadAccessibilitySettings();
                console.log('üöÄ Terra Ultimate DOM –≥–æ—Ç–æ–≤, —Å–∏—Å—Ç–µ–º–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞');
                console.log('üåê –ú–Ω–æ–≥–æ—è–∑—ã—á–Ω–æ—Å—Ç—å: O\'zbek, –†—É—Å—Å–∫–∏–π, English, Deutsch');
                console.log('‚ôø –î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å: –ò–Ω–∫–ª—é–∑–∏–≤–Ω—ã–π –¥–∏–∑–∞–π–Ω –¥–ª—è –≤—Å–µ—Ö –ª—é–¥–µ–π');
            });
        } else {
            loadSavedLanguage();
            loadAccessibilitySettings();
            console.log('üöÄ Terra Ultimate —Å–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ —Ä–∞–±–æ—Ç–µ');
        }
        
        // Final system status
        console.log('üåç Terra Archive Manager 2.0 Ultimate - –§—Ä–∞–∫—Ç–∞–ª—å–Ω–∞—è –°–∏—Å—Ç–µ–º–∞ L0-L7 –∑–∞–≥—Ä—É–∂–µ–Ω–∞!');
        console.log('üë§ –ê–≤—Ç–æ—Ä: –ê–±–¥—É–∫–∞—Ä–∏–º–æ–≤ –ê–±–¥—É—Ä–∞—à–∏–¥ –ê–±–¥—É–ª—Ö–∞–º–∏—Ç–æ–≤–∏—á');
        console.log('üîó DID: aiuz:did:aiuz:stakeholder:abdukarimov_aaahash1234567890');
        console.log('‚ö° –¢–µ–∫—É—â–∏–π —É—Ä–æ–≤–µ–Ω—å: L' + (terraSystem ? terraSystem.currentLevel : 0));
        console.log('üéØ –ì–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ –≤ –ª—é–±—ã—Ö —É—Å–ª–æ–≤–∏—è—Ö - –æ—Ç Pentium I –¥–æ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º!');
        console.log('üõ°Ô∏è –°–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –∑–∞—â–∏—â–µ–Ω–Ω–æ–º —Ä–µ–∂–∏–º–µ —Å fallback –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π');
        
    </script>
</body>
</html>